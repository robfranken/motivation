<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Latent Profile Transition Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Motivation</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="lpa1.html">Exploring LPA</a>
</li>
<li>
  <a href="lpa2.html">CFA input</a>
</li>
<li>
  <a href="lpa3.html">Weighted sum scores</a>
</li>
<li>
  <a href="lpta.html">LPTA</a>
</li>
<li>
  <a href="site.html">Sources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Latent Profile Transition Analysis</h1>

</div>


<p><br></p>
<p><em>Last edited: January 25, 2021</em></p>
<p><br></p>
<p>In the following, we will explore motivational profiles in the context of longitudinal data, using SDT as a theoretical framework. We will explore movement between motivational profiles over time.</p>
<p><br></p>
<div id="approach" class="section level2">
<h2>Approach</h2>
<p>First, we obtain weighted factor-scores for each SMS-subscale with CFA using MLE, as input for our subsequent LPA. Then, we use a three-step approach (see <a href="https://www.tandfonline.com/doi/pdf/10.1080/10705511.2014.915181">this article</a>; or the paper by <a href="https://www.sciencedirect.com/science/article/pii/S1469029219303851">Emm-Collison and colleagues</a> who used the same procedure).</p>
<hr />
</div>
<div id="preliminary-steps" class="section level1">
<h1>Preliminary steps</h1>
<div id="data" class="section level2">
<h2>1. Data</h2>
<p>Let’s get our ‘cleaned’ SMS-data, for each wave.</p>
<pre class="r"><code>library(sjlabelled)
library(dplyr)
library(tidyverse)
library(careless)
library(psych)

load(&quot;data_abs_public_v2.RData&quot;) # load data
data_abs_public &lt;- unlabel(data_abs_public, verbose=F) # unlabel

data_abs_public$id &lt;- 1:nrow(data_abs_public) # add identifier for subsequent LPTA

# subset sms data in each wave
sms_w1 &lt;- data_abs_public %&gt;% select(W1_M1_1, W1_M1_2, W1_M1_3, W1_M1_4, W1_M1_5, W1_M1_6, W1_M1_7, W1_M1_8, W1_M2_1, W1_M2_2, W1_M2_3, W1_M2_4, W1_M2_5, W1_M2_6, W1_M2_7, W1_M2_8, W1_M3_1, W1_M3_2, W1_M3_3, W1_M3_4, W1_M3_5, W1_M3_6, W1_M3_7, W1_M3_8, id)

sms_w2 &lt;- data_abs_public %&gt;% select(W2_M1_1, W2_M1_2, W2_M1_3, W2_M1_4, W2_M1_5, W2_M1_6, W2_M1_7, W2_M1_8, W2_M2_1, W2_M2_2, W2_M2_3, W2_M2_4, W2_M2_5, W2_M2_6, W2_M2_7, W2_M2_8, W2_M3_1, W2_M3_2, W2_M3_3, W2_M3_4, W2_M3_5, W2_M3_6, W2_M3_7, W2_M3_8, id) 

sms_w3 &lt;- data_abs_public %&gt;% select(W3_M1_1, W3_M1_2, W3_M1_3, W3_M1_4, W3_M1_5, W3_M1_6, W3_M1_7, W3_M1_8, W3_M2_1, W3_M2_2, W3_M2_3, W3_M2_4, W3_M2_5, W3_M2_6, W3_M2_7, W3_M2_8, W3_M3_1, W3_M3_2, W3_M3_3, W3_M3_4, W3_M3_5, W3_M3_6, W3_M3_7, W3_M3_8, id)

# make a &#39;string&#39; variable 
sms_w1 &lt;- sms_w1 %&gt;%
  mutate(string_w1 = longstring(.)) %&gt;%
  mutate(md_w1 = outlier(., plot = FALSE))

sms_w2 &lt;- sms_w2 %&gt;%
  mutate(string_w2 = longstring(.)) %&gt;%
  mutate(md_w2 = outlier(., plot = FALSE)) 

sms_w3 &lt;- sms_w3 %&gt;%
  mutate(string_w3 = longstring(.)) %&gt;%
  mutate(md_w3 = outlier(., plot = FALSE)) 

# cap string responding and use MD
cutoff_w1 &lt;- (qchisq(p = 1 - .001, df = (ncol(sms_w1) - 1)))
sms_w1 &lt;- sms_w1 %&gt;%
  filter(string_w1 &lt;= 10,
         md_w1 &lt; cutoff_w1) %&gt;%
  select(-string_w1, -md_w1)

  cutoff_w2 &lt;- (qchisq(p = 1 - .001, df = (ncol(sms_w2) - 1)))
sms_w2 &lt;- sms_w2 %&gt;%
  filter(string_w2 &lt;= 10,
         md_w2 &lt; cutoff_w2) %&gt;%
  select(-string_w2, -md_w2)

cutoff_w3 &lt;- (qchisq(p = 1 - .001, df = (ncol(sms_w3) - 1)))
sms_w3 &lt;- sms_w3 %&gt;%
  filter(string_w3 &lt;= 10,
         md_w3 &lt; cutoff_w3) %&gt;%
  select(-string_w3, -md_w3)</code></pre>
<p>Next, we are going to make a long file of the SMS data.</p>
<pre class="r"><code># first, make a wide format
sms_wide &lt;- merge(sms_w1, sms_w2, by = &quot;id&quot;) # first wave 1 and 2
sms_wide &lt;- merge(sms_wide, sms_w3, by = &quot;id&quot;) # add wave 3

# then transform into long shape
library(reshape2)
sms_long &lt;- reshape(sms_wide,
                    direction = &quot;long&quot;,
                    varying = c(list(names(sms_wide)[c(2, 26, 50)]),
                                     list(names(sms_wide)[c(3, 27, 51)]),
                                     list(names(sms_wide)[c(4, 28, 52)]),
                                     list(names(sms_wide)[c(5, 29, 53)]),
                                     list(names(sms_wide)[c(6, 30, 54)]),
                                     list(names(sms_wide)[c(7, 31, 55)]),
                                     list(names(sms_wide)[c(8, 32, 56)]),
                                     list(names(sms_wide)[c(9, 33, 57)]),
                                     list(names(sms_wide)[c(10, 34, 58)]),
                                     list(names(sms_wide)[c(11, 35, 59)]),
                                     list(names(sms_wide)[c(12, 36, 60)]),
                                     list(names(sms_wide)[c(13, 37, 61)]),
                                     list(names(sms_wide)[c(14, 38, 62)]),
                                     list(names(sms_wide)[c(15, 39, 63)]),
                                     list(names(sms_wide)[c(16, 40, 64)]),
                                     list(names(sms_wide)[c(17, 41, 65)]),
                                     list(names(sms_wide)[c(18, 42, 66)]),
                                     list(names(sms_wide)[c(19, 43, 67)]),
                                     list(names(sms_wide)[c(20, 44, 68)]),
                                     list(names(sms_wide)[c(21, 45, 69)]),
                                     list(names(sms_wide)[c(22, 46, 70)]),
                                     list(names(sms_wide)[c(23, 47, 71)]),
                                     list(names(sms_wide)[c(24, 48, 72)]),
                                     list(names(sms_wide)[c(25, 49, 73)])),
                    v.names = c(&quot;M1_1&quot;, &quot;M1_2&quot;, &quot;M1_3&quot;,&quot;M1_4&quot;, &quot;M1_5&quot;, &quot;M1_6&quot;, &quot;M1_7&quot;, &quot;M1_8&quot;, &quot;M2_1&quot;, &quot;M2_2&quot;, &quot;M2_3&quot;,&quot;M2_4&quot;, &quot;M2_5&quot;, &quot;M2_6&quot;, &quot;M2_7&quot;, &quot;M2_8&quot;, &quot;M3_1&quot;, &quot;M3_2&quot;, &quot;M3_3&quot;,&quot;M3_4&quot;, &quot;M3_5&quot;, &quot;M3_6&quot;, &quot;M3_7&quot;, &quot;M3_8&quot;),
                    idvar = &quot;id&quot;,
                    timevar = &quot;Timepoint&quot;,
                    times = 1:3)
# Reorder
sms_long  &lt;- sms_long [(order(sms_long$id)), ]
# fix(sms_long) to check data structure

sms_long_nm &lt;- sms_long %&gt;%
  na.omit() # listwise deletion</code></pre>
<p><br></p>
<hr />
</div>
<div id="cfa" class="section level2">
<h2>2. CFA</h2>
<p>First, confirmatory factor analysis using maximum likelihood estimation was conducted to obtain weighted factor scores for each SMS subscale. We first conduct CFA on the stacked data (hence assuming observations to be independent of each other). We will assess model fit using multiple indices. Afterwards, we will assess longitudinal invariance of the measurement model via a series of increasingly constraining models, indicating invariance by a change of CFI of ≤0.01.</p>
<div id="lavaan" class="section level3">
<h3>Lavaan</h3>
<p>Tell Lavaan the confirmatory structure.</p>
<pre class="r"><code>library(lavaan)

motivation_model &lt;- &quot;
amotivation =~ M1_5 + M2_4 + M3_1 + M3_6
external    =~ M1_4 + M2_3 + M3_3 + M3_8
introjected =~ M1_7 + M2_2 + M2_8 + M3_7
identified  =~ M1_3 + M1_8 + M2_7 + M3_4
integrated  =~ M1_2 + M2_1 + M2_5 + M3_5
intrinsic   =~ M1_1 + M1_6 + M2_6 + M3_2
&quot;</code></pre>
<p>Now let’s inspect the model. We will get the fit of the model, the (standardized) factor loadings, item averages (intercepts), error variances, and R-square scores. We will also make a table of the various fit indices.</p>
<pre class="r"><code># examine overall fit
overall.fit &lt;- cfa(model = motivation_model, data = sms_long_nm,
           meanstructure = TRUE,  # gives us the means
           std.lv = TRUE) 

summary(overall.fit, standardized = TRUE, rsquare = TRUE, fit.measure = TRUE)</code></pre>
<pre><code>## lavaan 0.6-7 ended normally after 35 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         87
##                                                       
##   Number of observations                          1613
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                              2288.748
##   Degrees of freedom                               237
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                             15893.932
##   Degrees of freedom                               276
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.869
##   Tucker-Lewis Index (TLI)                       0.847
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -61124.030
##   Loglikelihood unrestricted model (H1)     -59979.656
##                                                       
##   Akaike (AIC)                              122422.060
##   Bayesian (BIC)                            122890.629
##   Sample-size adjusted Bayesian (BIC)       122614.246
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.073
##   90 Percent confidence interval - lower         0.071
##   90 Percent confidence interval - upper         0.076
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.052
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   amotivation =~                                                        
##     M1_5              0.350    0.013   26.464    0.000    0.350    0.693
##     M2_4              0.518    0.021   24.459    0.000    0.518    0.644
##     M3_1              0.332    0.013   25.136    0.000    0.332    0.661
##     M3_6              0.561    0.028   20.035    0.000    0.561    0.539
##   external =~                                                           
##     M1_4              1.038    0.034   30.211    0.000    1.038    0.711
##     M2_3              1.047    0.032   32.358    0.000    1.047    0.749
##     M3_3              0.982    0.040   24.700    0.000    0.982    0.606
##     M3_8              1.008    0.031   32.608    0.000    1.008    0.754
##   introjected =~                                                        
##     M1_7              0.890    0.032   27.633    0.000    0.890    0.659
##     M2_2              1.233    0.039   31.526    0.000    1.233    0.730
##     M2_8              1.195    0.036   33.425    0.000    1.195    0.762
##     M3_7              1.201    0.039   30.451    0.000    1.201    0.711
##   identified =~                                                         
##     M1_3              1.064    0.042   25.577    0.000    1.064    0.615
##     M1_8              1.132    0.041   27.594    0.000    1.132    0.655
##     M2_7              0.805    0.040   20.039    0.000    0.805    0.499
##     M3_4              1.005    0.039   25.644    0.000    1.005    0.617
##   integrated =~                                                         
##     M1_2              0.977    0.034   29.105    0.000    0.977    0.677
##     M2_1              1.256    0.039   31.990    0.000    1.256    0.726
##     M2_5              1.281    0.042   30.390    0.000    1.281    0.699
##     M3_5              1.353    0.036   37.316    0.000    1.353    0.811
##   intrinsic =~                                                          
##     M1_1              0.957    0.043   22.362    0.000    0.957    0.551
##     M1_6              1.242    0.041   30.076    0.000    1.242    0.699
##     M2_6              1.372    0.039   35.359    0.000    1.372    0.787
##     M3_2              1.301    0.039   33.388    0.000    1.301    0.755
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   amotivation ~~                                                        
##     external          0.177    0.032    5.626    0.000    0.177    0.177
##     introjected       0.041    0.032    1.263    0.207    0.041    0.041
##     identified        0.020    0.035    0.576    0.564    0.020    0.020
##     integrated       -0.144    0.031   -4.582    0.000   -0.144   -0.144
##     intrinsic        -0.108    0.032   -3.398    0.001   -0.108   -0.108
##   external ~~                                                           
##     introjected       0.429    0.026   16.280    0.000    0.429    0.429
##     identified        0.746    0.021   36.077    0.000    0.746    0.746
##     integrated        0.511    0.024   21.147    0.000    0.511    0.511
##     intrinsic         0.595    0.022   26.691    0.000    0.595    0.595
##   introjected ~~                                                        
##     identified        0.626    0.024   25.966    0.000    0.626    0.626
##     integrated        0.766    0.017   46.429    0.000    0.766    0.766
##     intrinsic         0.508    0.024   20.749    0.000    0.508    0.508
##   identified ~~                                                         
##     integrated        0.788    0.019   41.754    0.000    0.788    0.788
##     intrinsic         0.898    0.016   56.925    0.000    0.898    0.898
##   integrated ~~                                                         
##     intrinsic         0.668    0.020   33.928    0.000    0.668    0.668
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .M1_5              1.153    0.013   91.727    0.000    1.153    2.284
##    .M2_4              1.353    0.020   67.608    0.000    1.353    1.683
##    .M3_1              1.162    0.013   92.890    0.000    1.162    2.313
##    .M3_6              1.464    0.026   56.517    0.000    1.464    1.407
##    .M1_4              2.382    0.036   65.537    0.000    2.382    1.632
##    .M2_3              2.033    0.035   58.449    0.000    2.033    1.455
##    .M3_3              2.569    0.040   63.703    0.000    2.569    1.586
##    .M3_8              2.049    0.033   61.509    0.000    2.049    1.532
##    .M1_7              5.399    0.034  160.581    0.000    5.399    3.998
##    .M2_2              4.623    0.042  109.890    0.000    4.623    2.736
##    .M2_8              5.270    0.039  134.943    0.000    5.270    3.360
##    .M3_7              4.806    0.042  114.194    0.000    4.806    2.843
##    .M1_3              3.098    0.043   71.912    0.000    3.098    1.791
##    .M1_8              3.565    0.043   82.885    0.000    3.565    2.064
##    .M2_7              2.466    0.040   61.357    0.000    2.466    1.528
##    .M3_4              4.467    0.041  110.087    0.000    4.467    2.741
##    .M1_2              5.154    0.036  143.373    0.000    5.154    3.570
##    .M2_1              4.333    0.043  100.582    0.000    4.333    2.504
##    .M2_5              3.272    0.046   71.684    0.000    3.272    1.785
##    .M3_5              4.975    0.042  119.695    0.000    4.975    2.980
##    .M1_1              3.996    0.043   92.388    0.000    3.996    2.300
##    .M1_6              3.805    0.044   85.993    0.000    3.805    2.141
##    .M2_6              4.084    0.043   94.103    0.000    4.084    2.343
##    .M3_2              3.493    0.043   81.460    0.000    3.493    2.028
##     amotivation       0.000                               0.000    0.000
##     external          0.000                               0.000    0.000
##     introjected       0.000                               0.000    0.000
##     identified        0.000                               0.000    0.000
##     integrated        0.000                               0.000    0.000
##     intrinsic         0.000                               0.000    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .M1_5              0.132    0.007   19.008    0.000    0.132    0.520
##    .M2_4              0.378    0.018   21.206    0.000    0.378    0.585
##    .M3_1              0.142    0.007   20.527    0.000    0.142    0.564
##    .M3_6              0.767    0.032   24.329    0.000    0.767    0.709
##    .M1_4              1.054    0.047   22.430    0.000    1.054    0.495
##    .M2_3              0.856    0.041   20.893    0.000    0.856    0.439
##    .M3_3              1.659    0.066   25.051    0.000    1.659    0.633
##    .M3_8              0.773    0.037   20.689    0.000    0.773    0.432
##    .M1_7              1.030    0.042   24.252    0.000    1.030    0.565
##    .M2_2              1.335    0.060   22.209    0.000    1.335    0.468
##    .M2_8              1.031    0.049   20.844    0.000    1.031    0.419
##    .M3_7              1.413    0.062   22.861    0.000    1.413    0.495
##    .M1_3              1.860    0.073   25.501    0.000    1.860    0.621
##    .M1_8              1.703    0.069   24.647    0.000    1.703    0.571
##    .M2_7              1.958    0.073   26.966    0.000    1.958    0.751
##    .M3_4              1.646    0.065   25.476    0.000    1.646    0.620
##    .M1_2              1.130    0.046   24.794    0.000    1.130    0.542
##    .M2_1              1.415    0.060   23.596    0.000    1.415    0.473
##    .M2_5              1.718    0.071   24.304    0.000    1.718    0.511
##    .M3_5              0.954    0.048   20.023    0.000    0.954    0.343
##    .M1_1              2.101    0.080   26.314    0.000    2.101    0.696
##    .M1_6              1.616    0.068   23.768    0.000    1.616    0.512
##    .M2_6              1.154    0.057   20.357    0.000    1.154    0.380
##    .M3_2              1.274    0.058   21.886    0.000    1.274    0.430
##     amotivation       1.000                               1.000    1.000
##     external          1.000                               1.000    1.000
##     introjected       1.000                               1.000    1.000
##     identified        1.000                               1.000    1.000
##     integrated        1.000                               1.000    1.000
##     intrinsic         1.000                               1.000    1.000
## 
## R-Square:
##                    Estimate
##     M1_5              0.480
##     M2_4              0.415
##     M3_1              0.436
##     M3_6              0.291
##     M1_4              0.505
##     M2_3              0.561
##     M3_3              0.367
##     M3_8              0.568
##     M1_7              0.435
##     M2_2              0.532
##     M2_8              0.581
##     M3_7              0.505
##     M1_3              0.379
##     M1_8              0.429
##     M2_7              0.249
##     M3_4              0.380
##     M1_2              0.458
##     M2_1              0.527
##     M2_5              0.489
##     M3_5              0.657
##     M1_1              0.304
##     M1_6              0.488
##     M2_6              0.620
##     M3_2              0.570</code></pre>
<pre class="r"><code># make table of fit indices
table_fit &lt;- matrix(NA, nrow = 11, ncol = 6)
colnames(table_fit) &lt;- c(&quot;Model&quot;, &quot;X2&quot;, &quot;df&quot;, &quot;CFI&quot;, &quot;RMSEA&quot;, &quot;SRMR&quot;)
table_fit[1, ] &lt;- c(&quot;Overall Model&quot;, round(fitmeasures(overall.fit, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))</code></pre>
<p><br></p>
<p>To check the confirmatory structure of our model, we will also create a picture of the standardized solution (quick and dirty; it can be edited…). The triangles depict the (standardized) intercepts, the arrows depic the variance (i.e. the loops) and (standardized) factor loadings.</p>
<pre class="r"><code>library(semPlot)
semPaths(overall.fit, whatLabels = &quot;std&quot;, layout = &quot;tree&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="longitudinal-invariance" class="section level3 tabset tabset-fade">
<h3>Longitudinal invariance</h3>
<p>Since we are dealing with panel data, and we want to explore movement over time in motivations, we should investigate to what extent our CFA solution is invariant over time (because we don’t want to compare apples with oranges). We will compare the SMS data of W1-W3 and compare them in CFA for configural, metric, scalar, and strict residual invariance (see e.g., <a href="https://www.tandfonline.com/doi/pdf/10.1207/S15328007SEM0902_5?casa_token=scyVPZRkncQAAAAA:PDDawXxC0BMvLu-kjcvtaFcHseZnO3rkwX4nJGtd8OrK-nuTq4B1Mk571ajpjaq3JQhasVHnyXtofdg">Cheung &amp; Rensvold 2002</a>).</p>
<p>We will use a new package for this. Apparently, this package only allows for multi-group equivalence testing for two groups (in Lavaan multiple groups can be compared); therefore, I will run the same procedure for each pair (i.e., W1 vs. W2, W2 vs. W3, and W1 vs. W3).</p>
<p>First, we will subset dataframes that only include two groups (i.e. waves) for comparison, for subsequent equivalence tests.</p>
<pre class="r"><code>W1_2 &lt;- ifelse(sms_long_nm$Timepoint == 1, 0, ifelse(sms_long_nm$Timepoint == 2, 1, NA))
sms12 &lt;- sms_long_nm[!is.na(W1_2), ] # compare w1 and w2

W2_3 &lt;- ifelse(sms_long_nm$Timepoint == 2, 0, ifelse(sms_long_nm$Timepoint == 3, 1, NA))
sms23 &lt;- sms_long_nm[!is.na(W2_3), ] # compare w2 and w3

W1_3 &lt;- ifelse(sms_long_nm$Timepoint == 1, 0, ifelse(sms_long_nm$Timepoint == 3, 1, NA))
sms13 &lt;- sms_long_nm[!is.na(W1_3), ] # compare w1 and w3</code></pre>
<p><br></p>
<div id="comparing-wave-1-and-wave-2" class="section level4">
<h4>Comparing Wave 1 and Wave 2</h4>
<pre class="r"><code>library(equaltestMI) #install package

# estimate the multi-group model
MG.model &lt;- eqMI.main(model = motivation_model, 
                      data = sms12, 
                      group = &quot;Timepoint&quot;, #comparing wave 1 and wave 2
                      meanstructure = TRUE, #include the means
                      output = &quot;both&quot;, #means, covariance, both
                      equivalence.test = FALSE, 
                      adjRMSEA = TRUE,
                      projection = TRUE, #test equality of latent factor means (even when equality of intercepts does not hold)
                      bootstrap = FALSE,
                      quiet = TRUE)</code></pre>
<p>Now we will summarize the results of the multi-group model, and add them to our previously made kable-table.</p>
<pre class="r"><code>table_fit[2, ] &lt;- c(&quot;W1 Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.configural.g1, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3)) # group 1: Wave 1
table_fit[3, ] &lt;- c(&quot;W2 Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.configural.g2, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3)) # group 2: Wave 2</code></pre>
<p>And to test for configural invariance - is the ‘picture’/structure of the model the same for both groups (i.e. waves), we stack the groups together.</p>
<pre class="r"><code>library(knitr)
library(kableExtra)
library(dplyr)
library(tidyr)

table_fit[4, ] &lt;- c(&quot;Configural Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.combine.groups, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:4, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1970.471
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.86
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.056
</td>
</tr>
</tbody>
</table>
<p>This is the model against which we will test the next model. So, we will conduct a sequential testing analysis. Next, we will assess metric invariance, by constraining the factor loadings to be equal across the waves. In the configural model, factor loadings were “freely” estimated in both waves; now, only 1 loading gets estimated for both groups. Let’s see what happens to the model.</p>
<pre class="r"><code>table_fit[5, ] &lt;- c(&quot;Metric Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.metric, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:5, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1970.471
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.86
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.056
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
2000.526
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
</tbody>
</table>
<p>The metric model seems to be invariant in comparison to the configural model: the CFI difference is smaller than .01, hence assuming invariance (same holds for RMSEA/SRMR). Conclusion: the metric model holds: the loadings are equal (or close enough).</p>
<p><br></p>
<p>We have constrained our model to contain the same structure, the same loadings; now let’s test for scalar invariance, to see if the intercepts are the same across waves.</p>
<pre class="r"><code>table_fit[6, ] &lt;- c(&quot;Scalar Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.scalar, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:6, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1970.471
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.86
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.056
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
2000.526
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
2058.927
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
</tbody>
</table>
<p>The intercepts are equal on the scale between the waves.</p>
<p><br></p>
<p>Last, we constrain the model to the strict model, to check for strict residual invariance. It will inform whether the variance around items is the same across time.</p>
<pre class="r"><code>table_fit[7, ] &lt;- c(&quot;Strict Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:7, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1970.471
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.86
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.056
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
2000.526
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
2058.927
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
2244.226
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.84
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
</tbody>
</table>
<p>From here it goes downwards… CFI dropped more than 0.01, suggesting that the residuals vary between the waves. We could estimate partial invariance, to investigate where the problem is and subsequently update the model to fix it. We are going to do so by freeing the variances of item residuals, one at a time, to figure out which equality constaint(s) is/are causing the problem. We will use the following loop for this.</p>
<pre class="r"><code># write out partial codes
partial_syntax &lt;- paste(colnames(sms12)[3:26], #all sms columns
                        &quot;~~&quot;, #residuals
                        colnames(sms12)[3:26]) #all columns again

CFI_list &lt;- 1:length(partial_syntax)
names(CFI_list) &lt;- partial_syntax 

for (i in 1:length(partial_syntax)){
  
  temp &lt;- cfa(model = motivation_model,
              data = sms12,
              meanstructure = TRUE,
              group = &quot;Timepoint&quot;,
              group.equal = c(&quot;loadings&quot;, &quot;intercepts&quot;, &quot;residuals&quot;),
              group.partial = partial_syntax[i])
  
  CFI_list[i] &lt;- fitmeasures(temp, &quot;cfi&quot;)
}


# now figure out which parameters to &quot;free&quot;
options(scipen = 999)
sort(CFI_list - fitmeasures(MG.model$convention.sem$LavaanOut$fit.strict.residuals, &quot;cfi&quot;, decreasing = T))</code></pre>
<pre><code>##    M3_6 ~~ M3_6    M2_7 ~~ M2_7    M2_5 ~~ M2_5    M1_4 ~~ M1_4    M2_3 ~~ M2_3 
## -0.000082290662 -0.000058960801 -0.000032832743 -0.000032541893 -0.000005183615 
##    M2_2 ~~ M2_2    M1_3 ~~ M1_3    M3_3 ~~ M3_3    M1_2 ~~ M1_2    M3_7 ~~ M3_7 
##  0.000059935949  0.000097552492  0.000169704013  0.000197347141  0.000403961976 
##    M3_8 ~~ M3_8    M2_8 ~~ M2_8    M3_2 ~~ M3_2    M1_1 ~~ M1_1    M3_1 ~~ M3_1 
##  0.000470764870  0.000494901161  0.000508918212  0.000528129682  0.000583019923 
##    M3_4 ~~ M3_4    M2_6 ~~ M2_6    M1_8 ~~ M1_8    M1_5 ~~ M1_5    M3_5 ~~ M3_5 
##  0.000758607698  0.000785984138  0.000820321729  0.000832645274  0.001110952309 
##    M2_1 ~~ M2_1    M2_4 ~~ M2_4    M1_7 ~~ M1_7    M1_6 ~~ M1_6 
##  0.001114316894  0.001721097109  0.001819401556  0.003353923608</code></pre>
<p>Let’s free up those parameters. Starting with the one that increases CFI to the greatest extent. We will re-run the whole model for this</p>
<pre class="r"><code>MG.model_2 &lt;- eqMI.main(model = motivation_model, 
                      data = sms12, 
                      group = &quot;Timepoint&quot;, #comparing wave 1 and wave 2
                      meanstructure = TRUE,
                      group.partial = c(&quot;M1_6~~M1_6&quot;), #free this parameter
                      output = &quot;both&quot;, #mean, covariance, both
                      equivalence.test = FALSE, 
                      adjRMSEA = TRUE,
                      projection = TRUE, 
                      bootstrap = FALSE,
                      quiet = TRUE)

# check summary to see if the equality constraint is gone.
# summary(MG.model_2$convention.sem$LavaanOut$fit.strict.residuals,
#        standardized = TRUE, rsquare = TRUE, fit.measure = TRUE)


table_fit[8, ] &lt;- c(&quot;Strict Model M1_6&quot;, round(fitmeasures(MG.model_2$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:8, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1970.471
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.86
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.056
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
2000.526
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
2058.927
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
2244.226
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.84
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_6
</td>
<td style="text-align:left;">
2207.4
</td>
<td style="text-align:left;">
533
</td>
<td style="text-align:left;">
0.843
</td>
<td style="text-align:left;">
0.075
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
</tbody>
</table>
<p>CFI improved, but the difference with the baseline scalar model is still greater than .01. Thus, we still need to free (at least) one more, to achieve “partial” invariance.</p>
<pre class="r"><code>MG.model_3 &lt;- eqMI.main(model = motivation_model, 
                        data = sms12, 
                        group = &quot;Timepoint&quot;, #comparing wave 1 and wave 2
                        meanstructure = TRUE,
                        group.partial = c(&quot;M1_6~~M1_6&quot;, &quot;M1_7~~M1_7&quot;), #free these parameters
                        output = &quot;both&quot;, #mean, covariance, both
                        equivalence.test = FALSE, 
                        adjRMSEA = TRUE,
                        projection = TRUE, 
                        bootstrap = FALSE,
                        quiet = TRUE)

table_fit[9, ] &lt;- c(&quot;Strict Model M1_6 + M1_7&quot;, round(fitmeasures(MG.model_3$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:9, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1970.471
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.86
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.056
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
2000.526
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
2058.927
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
2244.226
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.84
</td>
<td style="text-align:left;">
0.076
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_6
</td>
<td style="text-align:left;">
2207.4
</td>
<td style="text-align:left;">
533
</td>
<td style="text-align:left;">
0.843
</td>
<td style="text-align:left;">
0.075
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_6 + M1_7
</td>
<td style="text-align:left;">
2186.956
</td>
<td style="text-align:left;">
532
</td>
<td style="text-align:left;">
0.845
</td>
<td style="text-align:left;">
0.075
</td>
<td style="text-align:left;">
0.06
</td>
</tr>
</tbody>
</table>
</div>
<div id="comparing-wave-2-and-wave-3" class="section level4">
<h4>Comparing Wave 2 and Wave 3</h4>
<pre class="r"><code>library(equaltestMI) #install package

# estimate the multi-group model
MG.model &lt;- eqMI.main(model = motivation_model, 
                      data = sms23, 
                      group = &quot;Timepoint&quot;, #comparing wave 2 and wave 3
                      meanstructure = TRUE, #include the means
                      output = &quot;both&quot;, #means, covariance, both
                      equivalence.test = FALSE, 
                      adjRMSEA = TRUE,
                      projection = TRUE, #test equality of latent factor means (even when equality of intercepts does not hold)
                      bootstrap = FALSE,
                      quiet = TRUE)</code></pre>
<p>Now we will summarize the results of the multi-group model, and add them to our previously made kable-table.</p>
<pre class="r"><code>table_fit[2, ] &lt;- c(&quot;W2 Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.configural.g1, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3)) # group 1: Wave 2
table_fit[3, ] &lt;- c(&quot;W3 Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.configural.g2, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3)) # group 2: Wave 3</code></pre>
<p>And to test for configural invariance - is the ‘picture’/structure of the model the same for both groups (i.e. waves), we stack the groups together.</p>
<pre class="r"><code>library(knitr)
library(kableExtra)
library(dplyr)
library(tidyr)

table_fit[4, ] &lt;- c(&quot;Configural Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.combine.groups, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:4, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1758.323
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.876
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
</tbody>
</table>
<p>This is the model against which we will test the next model. So, we will conduct a sequential testing analysis. Next, we will assess metric invariance, by constraining the factor loadings to be equal across the waves. In the configural model, factor loadings were “freely” estimated in both waves; now, only 1 loading gets estimated for both groups. Let’s see what happens to the model.</p>
<pre class="r"><code>table_fit[5, ] &lt;- c(&quot;Metric Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.metric, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:5, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1758.323
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.876
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1849.122
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.075
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
</tbody>
</table>
<p>The metric model seems to be invariant in comparison to the configural model: the CFI difference is smaller than .01, hence assuming invariance (same holds for RMSEA/SRMR). Conclusion: the metric model holds: the loadings are equal (or close enough).</p>
<p><br></p>
<p>We have constrained our model to contain the same structure, the same loadings; now let’s test for scalar invariance, to see if the intercepts are the same across waves.</p>
<pre class="r"><code>table_fit[6, ] &lt;- c(&quot;Scalar Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.scalar, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:6, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1758.323
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.876
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1849.122
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.075
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
1877.602
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.868
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.062
</td>
</tr>
</tbody>
</table>
<p>The intercepts are equal on the scale between the waves.</p>
<p><br></p>
<p>Last, we constrain the model to the strict model, to check for strict residual invariance. It will inform whether the variance around items is the same across time.</p>
<pre class="r"><code>table_fit[7, ] &lt;- c(&quot;Strict Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:7, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W2 Model
</td>
<td style="text-align:left;">
942.671
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.87
</td>
<td style="text-align:left;">
0.078
</td>
<td style="text-align:left;">
0.058
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1758.323
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.876
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1849.122
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.075
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
1877.602
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.868
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.062
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
1962.388
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.863
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.064
</td>
</tr>
</tbody>
</table>
</div>
<div id="comparing-wave-1-and-wave-3" class="section level4">
<h4>Comparing Wave 1 and Wave 3</h4>
<pre class="r"><code>library(equaltestMI) #install package

# estimate the multi-group model
MG.model &lt;- eqMI.main(model = motivation_model, 
                      data = sms13, 
                      group = &quot;Timepoint&quot;, #comparing wave 1 and wave 3
                      meanstructure = TRUE, #include the means
                      output = &quot;both&quot;, #means, covariance, both
                      equivalence.test = FALSE, 
                      adjRMSEA = TRUE,
                      projection = TRUE, #test equality of latent factor means (even when equality of intercepts does not hold)
                      bootstrap = FALSE,
                      quiet = TRUE)</code></pre>
<p>Now we will summarize the results of the multi-group model, and add them to our previously made kable-table.</p>
<pre class="r"><code>table_fit[2, ] &lt;- c(&quot;W1 Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.configural.g1, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3)) # group 1: Wave 1
table_fit[3, ] &lt;- c(&quot;W3 Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.configural.g2, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3)) # group 2: Wave 3</code></pre>
<p>And to test for configural invariance - is the ‘picture’/structure of the model the same for both groups (i.e. waves), we stack the groups together.</p>
<pre class="r"><code>library(knitr)
library(kableExtra)
library(dplyr)
library(tidyr)

table_fit[4, ] &lt;- c(&quot;Configural Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.combine.groups, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:4, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1843.45
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.866
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.057
</td>
</tr>
</tbody>
</table>
<p>This is the model against which we will test the next model. So, we will conduct a sequential testing analysis. Next, we will assess metric invariance, by constraining the factor loadings to be equal across the waves. In the configural model, factor loadings were “freely” estimated in both waves; now, only 1 loading gets estimated for both groups. Let’s see what happens to the model.</p>
<pre class="r"><code>table_fit[5, ] &lt;- c(&quot;Metric Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.metric, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:5, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1843.45
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.866
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1928.678
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
</tbody>
</table>
<p>The metric model seems to be invariant in comparison to the configural model: the CFI difference is smaller than .01, hence assuming invariance (same holds for RMSEA/SRMR). Conclusion: the metric model holds: the loadings are equal (or close enough).</p>
<p><br></p>
<p>We have constrained our model to contain the same structure, the same loadings; now let’s test for scalar invariance, to see if the intercepts are the same across waves.</p>
<pre class="r"><code>table_fit[6, ] &lt;- c(&quot;Scalar Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.scalar, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:6, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1843.45
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.866
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1928.678
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
1992.647
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.06
</td>
</tr>
</tbody>
</table>
<p>The intercepts are equal on the scale between the waves.</p>
<p><br></p>
<p>Last, we constrain the model to the strict model, to check for strict residual invariance. It will inform whether the variance around items is the same across time.</p>
<pre class="r"><code>table_fit[7, ] &lt;- c(&quot;Strict Model&quot;, round(fitmeasures(MG.model$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:7, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1843.45
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.866
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1928.678
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
1992.647
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
2192.247
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.838
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.063
</td>
</tr>
</tbody>
</table>
<p>From here it goes downwards… CFI dropped more than 0.01, suggesting that the residuals vary between the waves. We could estimate partial invariance, to investigate where the problem is and subsequently update the model to fix it. We are going to do so by freeing the variances of item residuals, one at a time, to figure out which equality constaint(s) is/are causing the problem. We will use the following loop for this.</p>
<pre class="r"><code># write out partial codes
partial_syntax &lt;- paste(colnames(sms12)[3:26], #all sms columns
                        &quot;~~&quot;, #residuals
                        colnames(sms12)[3:26]) #all columns again

CFI_list &lt;- 1:length(partial_syntax)
names(CFI_list) &lt;- partial_syntax 

for (i in 1:length(partial_syntax)){
  
  temp &lt;- cfa(model = motivation_model,
              data = sms13,
              meanstructure = TRUE,
              group = &quot;Timepoint&quot;,
              group.equal = c(&quot;loadings&quot;, &quot;intercepts&quot;, &quot;residuals&quot;),
              group.partial = partial_syntax[i])
  
  CFI_list[i] &lt;- fitmeasures(temp, &quot;cfi&quot;)
}


# now figure out which parameters to &quot;free&quot;
options(scipen = 999)
sort(CFI_list - fitmeasures(MG.model$convention.sem$LavaanOut$fit.strict.residuals, &quot;cfi&quot;, decreasing = T))</code></pre>
<pre><code>##   M2_5 ~~ M2_5   M3_3 ~~ M3_3   M3_6 ~~ M3_6   M1_4 ~~ M1_4   M3_1 ~~ M3_1 
## -0.00008888957 -0.00006838485  0.00005127295  0.00006502869  0.00008372676 
##   M2_2 ~~ M2_2   M1_3 ~~ M1_3   M3_2 ~~ M3_2   M2_6 ~~ M2_6   M3_4 ~~ M3_4 
##  0.00013271294  0.00013945684  0.00014934295  0.00015002670  0.00018039173 
##   M2_7 ~~ M2_7   M2_3 ~~ M2_3   M3_8 ~~ M3_8   M1_1 ~~ M1_1   M3_7 ~~ M3_7 
##  0.00020506906  0.00020557911  0.00047290405  0.00057689755  0.00071190877 
##   M2_4 ~~ M2_4   M1_6 ~~ M1_6   M1_8 ~~ M1_8   M2_8 ~~ M2_8   M2_1 ~~ M2_1 
##  0.00082523798  0.00089462803  0.00092105420  0.00112432933  0.00122973447 
##   M1_2 ~~ M1_2   M1_5 ~~ M1_5   M3_5 ~~ M3_5   M1_7 ~~ M1_7 
##  0.00124553362  0.00183641423  0.00269219514  0.00393475648</code></pre>
<p>Let’s free up those parameters. Starting with the one that increases CFI to the greatest extent. We will re-run the whole model for this</p>
<pre class="r"><code>MG.model_2 &lt;- eqMI.main(model = motivation_model, 
                      data = sms13, 
                      group = &quot;Timepoint&quot;, #comparing wave 1 and wave 3
                      meanstructure = TRUE,
                      group.partial = c(&quot;M1_7~~M1_7&quot;), #free this parameter
                      output = &quot;both&quot;, #mean, covariance, both
                      equivalence.test = FALSE, 
                      adjRMSEA = TRUE,
                      projection = TRUE, 
                      bootstrap = FALSE,
                      quiet = TRUE)

# check summary to see if the equality constraint is gone.
# summary(MG.model_2$convention.sem$LavaanOut$fit.strict.residuals,
#        standardized = TRUE, rsquare = TRUE, fit.measure = TRUE)


table_fit[8, ] &lt;- c(&quot;Strict Model M1_7&quot;, round(fitmeasures(MG.model_2$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit[1:8, ] 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1843.45
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.866
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1928.678
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
1992.647
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
2192.247
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.838
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.063
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_7
</td>
<td style="text-align:left;">
2151.056
</td>
<td style="text-align:left;">
533
</td>
<td style="text-align:left;">
0.842
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.062
</td>
</tr>
</tbody>
</table>
<p>CFI improved, but the difference with the baseline scalar model is still greater than .01. Thus, we still need to free (at least) one more, to achieve “partial” invariance.</p>
<pre class="r"><code>MG.model_3 &lt;- eqMI.main(model = motivation_model, 
                        data = sms13, 
                        group = &quot;Timepoint&quot;, #comparing wave 1 and wave 3
                        meanstructure = TRUE,
                        group.partial = c(&quot;M1_7~~M1_7&quot;, &quot;M3_5~~M3_5&quot;), #free these parameters
                        output = &quot;both&quot;, #mean, covariance, both
                        equivalence.test = FALSE, 
                        adjRMSEA = TRUE,
                        projection = TRUE, 
                        bootstrap = FALSE,
                        quiet = TRUE)

table_fit[9, ] &lt;- c(&quot;Strict Model M1_7 + M3_5&quot;, round(fitmeasures(MG.model_3$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1843.45
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.866
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1928.678
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
1992.647
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
2192.247
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.838
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.063
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_7
</td>
<td style="text-align:left;">
2151.056
</td>
<td style="text-align:left;">
533
</td>
<td style="text-align:left;">
0.842
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.062
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_7 + M3_5
</td>
<td style="text-align:left;">
2122.571
</td>
<td style="text-align:left;">
532
</td>
<td style="text-align:left;">
0.844
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.062
</td>
</tr>
</tbody>
</table>
<p>Ditto</p>
<pre class="r"><code>MG.model_4 &lt;- eqMI.main(model = motivation_model, 
                        data = sms13, 
                        group = &quot;Timepoint&quot;, #comparing wave 1 and wave 3
                        meanstructure = TRUE,
                        group.partial = c(&quot;M1_7~~M1_7&quot;, &quot;M3_5~~M3_5&quot;, &quot;M1_5~~M1_5&quot;), #free these parameters
                        output = &quot;both&quot;, #mean, covariance, both
                        equivalence.test = FALSE, 
                        adjRMSEA = TRUE,
                        projection = TRUE, 
                        bootstrap = FALSE,
                        quiet = TRUE)

table_fit[9, ] &lt;- c(&quot;Strict Model M1_7 + M3_5 + M1_5&quot;, round(fitmeasures(MG.model_4$convention.sem$LavaanOut$fit.strict.residuals, c(&quot;chisq&quot;, &quot;df&quot;, &quot;cfi&quot;, &quot;rmsea&quot;, &quot;srmr&quot;)),3))

input &lt;- table_fit 
knitr::kable(input, digits=2, &quot;html&quot;, caption=&quot;&quot;) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
X2
</th>
<th style="text-align:left;">
df
</th>
<th style="text-align:left;">
CFI
</th>
<th style="text-align:left;">
RMSEA
</th>
<th style="text-align:left;">
SRMR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Overall Model
</td>
<td style="text-align:left;">
2288.748
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.869
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.052
</td>
</tr>
<tr>
<td style="text-align:left;">
W1 Model
</td>
<td style="text-align:left;">
1027.799
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.849
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.055
</td>
</tr>
<tr>
<td style="text-align:left;">
W3 Model
</td>
<td style="text-align:left;">
815.651
</td>
<td style="text-align:left;">
237
</td>
<td style="text-align:left;">
0.883
</td>
<td style="text-align:left;">
0.069
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Configural Model
</td>
<td style="text-align:left;">
1843.45
</td>
<td style="text-align:left;">
474
</td>
<td style="text-align:left;">
0.866
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.057
</td>
</tr>
<tr>
<td style="text-align:left;">
Metric Model
</td>
<td style="text-align:left;">
1928.678
</td>
<td style="text-align:left;">
492
</td>
<td style="text-align:left;">
0.859
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.059
</td>
</tr>
<tr>
<td style="text-align:left;">
Scalar Model
</td>
<td style="text-align:left;">
1992.647
</td>
<td style="text-align:left;">
510
</td>
<td style="text-align:left;">
0.855
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model
</td>
<td style="text-align:left;">
2192.247
</td>
<td style="text-align:left;">
534
</td>
<td style="text-align:left;">
0.838
</td>
<td style="text-align:left;">
0.074
</td>
<td style="text-align:left;">
0.063
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_7
</td>
<td style="text-align:left;">
2151.056
</td>
<td style="text-align:left;">
533
</td>
<td style="text-align:left;">
0.842
</td>
<td style="text-align:left;">
0.073
</td>
<td style="text-align:left;">
0.062
</td>
</tr>
<tr>
<td style="text-align:left;">
Strict Model M1_7 + M3_5 + M1_5
</td>
<td style="text-align:left;">
2102.913
</td>
<td style="text-align:left;">
531
</td>
<td style="text-align:left;">
0.846
</td>
<td style="text-align:left;">
0.072
</td>
<td style="text-align:left;">
0.061
</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>We can conclude that the SMS is mostly invariant - the structure, factor loadings, intercepts, and most of the error variances were equal across time.</p>
<p><br></p>
</div>
<div id="weighted-factor-scores" class="section level3">
<h3>Weighted factor-scores</h3>
<p>Now we use the invariant measurement model to generate (weighted) factor scores as input variables for the subsequent LPA. Weighted factor scores are computed by multiplying the factor loading of each item to the scaled score for each item before summing (see <a href="https://scholarworks.umass.edu/cgi/viewcontent.cgi?article=1226&amp;context=pare">DiStefano et al. (2009)</a>).</p>
<p>We will first fit the CFA, fixing the loading of the first variable of each variable to 1. Then we will extract the loadings, and calculate the weighted sum scores.</p>
<p><strong>Note</strong>: we now assumed strict measurement invariance (instead of strong), so we may want to free some parameters…</p>
<pre class="r"><code>fit &lt;- cfa(model = motivation_model, data = sms_long_nm,
           std.lv = FALSE) # default: not standardized but fixing the first loading on each latent variable to 1.
 
loading &lt;- parameterEstimates(fit)$est[1:24] # extract factor loadings

# calculate weighted sum scores
sms_long_nm$amotivation &lt;- rowMeans(cbind((sms_long_nm$M1_5*loading[1]), (sms_long_nm$M2_4*loading[2]), (sms_long_nm$M3_1*loading[3]), (sms_long_nm$M3_6*loading[4])))

sms_long_nm$external &lt;- rowMeans(cbind((sms_long_nm$M1_4*loading[5]), (sms_long_nm$M2_3*loading[6]), (sms_long_nm$M3_3*loading[7]),   (sms_long_nm$M3_8*loading[8])))

sms_long_nm$introjected &lt;- rowMeans(cbind((sms_long_nm$M1_7*loading[9]), (sms_long_nm$M2_2*loading[10]), (sms_long_nm$M2_8*loading[11]), (sms_long_nm$M3_7*loading[12])))

sms_long_nm$identified &lt;- rowMeans(cbind((sms_long_nm$M1_3*loading[13]), (sms_long_nm$M1_8*loading[14]), (sms_long_nm$M2_7*loading[15]), (sms_long_nm$M3_4*loading[16])))

sms_long_nm$integrated &lt;- rowMeans(cbind((sms_long_nm$M1_2*loading[17]), (sms_long_nm$M2_1*loading[18]), (sms_long_nm$M2_5*loading[19]), (sms_long_nm$M3_5*loading[20])))

sms_long_nm$intrinsic &lt;- rowMeans(cbind((sms_long_nm$M1_1*loading[21]), (sms_long_nm$M1_6*loading[22]), (sms_long_nm$M2_6*loading[23]), (sms_long_nm$M3_2*loading[24])))</code></pre>
<p><br></p>
<hr />
</div>
</div>
<div id="descriptives" class="section level2">
<h2>3. Descriptives</h2>
<p>Let’s describe our weighted factor scores over time.</p>
<pre class="r"><code>library(crosstable)

input &lt;- sms_long_nm %&gt;% #get factor scores and timepoint as grouping variable
  select(27:32, 2)

crosstable(input, by=Timepoint,
           funs=c(&quot;Mean&quot; = mean, &quot;Std. dev.&quot; = sd, &quot;Min&quot; = min, &quot;Max&quot; = max), funs_arg=list(digits=3)) %&gt;%
  as_flextable(by_header = &quot;Wave&quot;)</code></pre>
<template id="72d6d466-5b5c-4946-8e0a-d07bfc458b15"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-6b9b9f18{border-collapse:collapse;}.cl-6b8713ae{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6b8713af{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6b873ab4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6b873ab5{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6b87fdd2{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdd3{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdd4{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdd5{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdd6{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdd7{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdd8{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdd9{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fdda{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fddb{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b87fddc{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824ce{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824cf{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d0{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d1{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d2{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d3{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d4{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d5{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d6{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d7{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8824d8{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849ea{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849eb{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849ec{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849ed{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849ee{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849ef{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849f0{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849f1{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849f2{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849f3{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8849f4{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872da{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872db{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872dc{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872dd{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872de{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872df{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872e0{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872e1{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872e2{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872e3{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b8872e4{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b88994a{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b88994b{width:63.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b88994c{width:49.3pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6b88994d{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}caption {color: #777;margin-top: 10px;margin-bottom: 10px;text-align: center;}</style><table class='cl-6b9b9f18'><thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-6b8872e3"><p class="cl-6b873ab4"><span class="cl-6b8713ae">label</span></p></td><td  rowspan="2"class="cl-6b8872e1"><p class="cl-6b873ab4"><span class="cl-6b8713ae">variable</span></p></td><td  colspan="3"class="cl-6b8872e4"><p class="cl-6b873ab4"><span class="cl-6b8713ae">Wave</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b88994c"><p class="cl-6b873ab5"><span class="cl-6b8713ae">1</span></p></td><td class="cl-6b88994a"><p class="cl-6b873ab5"><span class="cl-6b8713ae">2</span></p></td><td class="cl-6b88994a"><p class="cl-6b873ab5"><span class="cl-6b8713ae">3</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  rowspan="4"class="cl-6b87fdd3"><p class="cl-6b873ab5"><span class="cl-6b8713af">amotivation</span></p></td><td class="cl-6b87fdd4"><p class="cl-6b873ab5"><span class="cl-6b8713af">Mean</span></p></td><td class="cl-6b87fdd5"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.584</span></p></td><td class="cl-6b87fdd2"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.655</span></p></td><td class="cl-6b87fdd2"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.730</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdd8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Std. dev.</span></p></td><td class="cl-6b87fdd7"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.657</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.736</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.808</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdda"><p class="cl-6b873ab5"><span class="cl-6b8713af">Min</span></p></td><td class="cl-6b8824ce"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.258</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.258</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.258</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b8872dd"><p class="cl-6b873ab5"><span class="cl-6b8713af">Max</span></p></td><td class="cl-6b8872df"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.833</span></p></td><td class="cl-6b8872de"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.346</span></p></td><td class="cl-6b8872de"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.609</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="4"class="cl-6b8872e0"><p class="cl-6b873ab5"><span class="cl-6b8713af">external</span></p></td><td class="cl-6b8849ed"><p class="cl-6b873ab5"><span class="cl-6b8713af">Mean</span></p></td><td class="cl-6b8849ef"><p class="cl-6b873ab5"><span class="cl-6b8713af">2.058</span></p></td><td class="cl-6b8849ec"><p class="cl-6b873ab5"><span class="cl-6b8713af">2.291</span></p></td><td class="cl-6b8849ec"><p class="cl-6b873ab5"><span class="cl-6b8713af">2.328</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdd8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Std. dev.</span></p></td><td class="cl-6b87fdd7"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.029</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.147</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.166</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdda"><p class="cl-6b873ab5"><span class="cl-6b8713af">Min</span></p></td><td class="cl-6b8824ce"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.981</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.981</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.981</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b8872dd"><p class="cl-6b873ab5"><span class="cl-6b8713af">Max</span></p></td><td class="cl-6b8872df"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.646</span></p></td><td class="cl-6b8872de"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.889</span></p></td><td class="cl-6b8872de"><p class="cl-6b873ab5"><span class="cl-6b8713af">6.132</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="4"class="cl-6b8849eb"><p class="cl-6b873ab5"><span class="cl-6b8713af">introjected</span></p></td><td class="cl-6b8824d8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Mean</span></p></td><td class="cl-6b8849ea"><p class="cl-6b873ab5"><span class="cl-6b8713af">6.109</span></p></td><td class="cl-6b8824d7"><p class="cl-6b873ab5"><span class="cl-6b8713af">6.329</span></p></td><td class="cl-6b8824d7"><p class="cl-6b873ab5"><span class="cl-6b8713af">6.633</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdd8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Std. dev.</span></p></td><td class="cl-6b87fdd7"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.693</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.633</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.468</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdda"><p class="cl-6b873ab5"><span class="cl-6b8713af">Min</span></p></td><td class="cl-6b8824ce"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.519</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.519</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.519</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b8824d0"><p class="cl-6b873ab5"><span class="cl-6b8713af">Max</span></p></td><td class="cl-6b8824d1"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.884</span></p></td><td class="cl-6b8824cf"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.884</span></p></td><td class="cl-6b8824cf"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.884</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="4"class="cl-6b8824d5"><p class="cl-6b873ab5"><span class="cl-6b8713af">identified</span></p></td><td class="cl-6b8824d3"><p class="cl-6b873ab5"><span class="cl-6b8713af">Mean</span></p></td><td class="cl-6b8824d6"><p class="cl-6b873ab5"><span class="cl-6b8713af">3.064</span></p></td><td class="cl-6b8824d4"><p class="cl-6b873ab5"><span class="cl-6b8713af">3.355</span></p></td><td class="cl-6b8824d4"><p class="cl-6b873ab5"><span class="cl-6b8713af">3.354</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdd8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Std. dev.</span></p></td><td class="cl-6b87fdd7"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.131</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.190</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.107</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdda"><p class="cl-6b873ab5"><span class="cl-6b8713af">Min</span></p></td><td class="cl-6b8824ce"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.941</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.941</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">0.941</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b8824d0"><p class="cl-6b873ab5"><span class="cl-6b8713af">Max</span></p></td><td class="cl-6b8824d1"><p class="cl-6b873ab5"><span class="cl-6b8713af">6.587</span></p></td><td class="cl-6b8824cf"><p class="cl-6b873ab5"><span class="cl-6b8713af">6.587</span></p></td><td class="cl-6b8824cf"><p class="cl-6b873ab5"><span class="cl-6b8713af">6.587</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="4"class="cl-6b8849eb"><p class="cl-6b873ab5"><span class="cl-6b8713af">integrated</span></p></td><td class="cl-6b8824d8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Mean</span></p></td><td class="cl-6b8849ea"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.162</span></p></td><td class="cl-6b8824d7"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.613</span></p></td><td class="cl-6b8824d7"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.737</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdd8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Std. dev.</span></p></td><td class="cl-6b87fdd7"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.701</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.704</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.619</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdda"><p class="cl-6b873ab5"><span class="cl-6b8713af">Min</span></p></td><td class="cl-6b8824ce"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.246</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.592</span></p></td><td class="cl-6b87fddc"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.246</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b8824d0"><p class="cl-6b873ab5"><span class="cl-6b8713af">Max</span></p></td><td class="cl-6b8824d1"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.722</span></p></td><td class="cl-6b8824cf"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.722</span></p></td><td class="cl-6b8824cf"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.722</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="4"class="cl-6b8849ee"><p class="cl-6b873ab5"><span class="cl-6b8713af">intrinsic</span></p></td><td class="cl-6b8849ed"><p class="cl-6b873ab5"><span class="cl-6b8713af">Mean</span></p></td><td class="cl-6b8849ef"><p class="cl-6b873ab5"><span class="cl-6b8713af">4.623</span></p></td><td class="cl-6b8849ec"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.025</span></p></td><td class="cl-6b8849ec"><p class="cl-6b873ab5"><span class="cl-6b8713af">5.066</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b87fdd8"><p class="cl-6b873ab5"><span class="cl-6b8713af">Std. dev.</span></p></td><td class="cl-6b87fdd7"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.762</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.770</span></p></td><td class="cl-6b87fdd6"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.678</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b8849f1"><p class="cl-6b873ab5"><span class="cl-6b8713af">Min</span></p></td><td class="cl-6b8849f3"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.272</span></p></td><td class="cl-6b8849f0"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.272</span></p></td><td class="cl-6b8849f0"><p class="cl-6b873ab5"><span class="cl-6b8713af">1.272</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6b8872da"><p class="cl-6b873ab5"><span class="cl-6b8713af">Max</span></p></td><td class="cl-6b8872dc"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.906</span></p></td><td class="cl-6b8849f4"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.906</span></p></td><td class="cl-6b8849f4"><p class="cl-6b873ab5"><span class="cl-6b8713af">8.582</span></p></td></tr></tbody></table></div></template>
<div id="5ebd4924-6c0f-4d85-a7a5-b317b2b242e6"></div>
<script>
var dest = document.getElementById("5ebd4924-6c0f-4d85-a7a5-b317b2b242e6");
var template = document.getElementById("72d6d466-5b5c-4946-8e0a-d07bfc458b15");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p>And let’s see how many respondents we have in each wave (<strong>note-to-self</strong>: integrate in previous table…).</p>
<pre class="r"><code>knitr::kable(table(sms_long_nm$Timepoint), &quot;html&quot;, caption=&quot;Number of respondents in each wave&quot;, col.names = c(&quot;Wave&quot;, &quot;N&quot;), align = &#39;l&#39; ) %&gt;% 
  kableExtra::kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Number of respondents in each wave
</caption>
<thead>
<tr>
<th style="text-align:left;">
Wave
</th>
<th style="text-align:left;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
621
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
486
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
506
</td>
</tr>
</tbody>
</table>
<p>At face value, respondents seem to be pretty high in all types of motivation (e.g., compared with the sample of <a href="https://www.sciencedirect.com/science/article/pii/S1469029219303851">Emm-Collison and colleagues</a> - though these were sum scores).</p>
<p><br></p>
<hr />
</div>
</div>
<div id="lpa" class="section level1">
<h1>LPA</h1>
<div id="step-1" class="section level2">
<h2>Step 1</h2>
<div id="section" class="section level3 tabset tabset-fade">
<h3></h3>
<p>As a first step for the LPA, we carefully select a measurement model that accurately captures the construct of motivational profile. We will fit a series of measurement models for each wave to determine which model provides the best fit at each wave (following recommendations of <a href="https://srcd.onlinelibrary.wiley.com/doi/full/10.1111/j.1467-8624.2007.01097.x?casa_token=0wyzjh9Ozk0AAAAA:iasgTYid_gJ5kGH42Jyys61DsBhEDl0zxVrukoJdaeX2e2MGOlm1nfyooEUc1v5SaB3lFYyX1wqVLGNOvQ">Nylund et al. (2007)</a> and similar to the article by <a href="https://www.tandfonline.com/doi/pdf/10.1080/10413200.2014.993485?casa_token=CsBgfG9lbtgAAAAA:CMEXxc96xNC-rF6Sowi7X2X0qvXlxI9MuODWtQ1Db92UyZUeLZcWJem1jhhympbi8dBboyrA282A5Ns">Martinent &amp; Decret (2015)</a>).</p>
<p><br></p>
<div id="wave-1" class="section level4">
<h4>Wave 1</h4>
<p>We start by subsetting the data for the respective waves, and standardizing the indicators to z-scores, meaning that resulting profile means reflect standard deviation (SD) units above or below the sample mean (which is set to 0).</p>
<pre class="r"><code>sms_w1 &lt;- sms_long_nm[sms_long_nm$Timepoint==1, ] %&gt;%
  select(-Timepoint, -id) %&gt;% # subset W1
  select(25:30) %&gt;% # subset weighted factor scores
  mutate_all(list(scale)) # standardize indicators</code></pre>
<p>We then compute the model-based clustering, and ask for a summary.</p>
<pre class="r"><code>library(mclust)
mc &lt;- Mclust(sms_w1)
summary(mc)                 </code></pre>
<pre><code>## ---------------------------------------------------- 
## Gaussian finite mixture model fitted by EM algorithm 
## ---------------------------------------------------- 
## 
## Mclust EEV (ellipsoidal, equal volume and shape) model with 9 components: 
## 
##  log-likelihood   n  df       BIC       ICL
##       -3502.994 621 203 -8311.547 -8564.225
## 
## Clustering table:
##   1   2   3   4   5   6   7   8   9 
## 195  52  47  19  29  71  71  87  50</code></pre>
<p>For this wave, Mclust selected a model with 9 (!) profiles; the optimal selected model is EEV, i.e., the profiles are ellipsoidal with equal volume, shape and varying orientation (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5096736/">this article</a>). However, note that VEV, 9 is only slightly behind, and that for all solutions with fewer clusters, the VEV model fitted better.</p>
<p>Now we will access to the results and visualize the model. To visualize, we will use a new package (<em>factoextra</em>), to create nicer plots based on ggplot2.</p>
<pre class="r"><code>library(factoextra)
# BIC values used for choosing the number of clusters
fviz_mclust(mc, &quot;BIC&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="wave-2" class="section level4">
<h4>Wave 2</h4>
<p>We start by subsetting the data for the respective waves, and standardizing the indicators to z-scores, meaning that resulting profile means reflect standard deviation (SD) units above or below the sample mean (which is set to 0).</p>
<pre class="r"><code>sms_w2 &lt;- sms_long_nm[sms_long_nm$Timepoint==2, ] %&gt;%
  select(-Timepoint, -id) %&gt;% # subset W2
  select(25:30) %&gt;% # subset weighted factor scores
  mutate_all(list(scale)) # standardize indicators</code></pre>
<p>We then compute the model-based clustering, and ask for a summary.</p>
<pre class="r"><code>library(mclust)
mc &lt;- Mclust(sms_w2)
summary(mc)                 </code></pre>
<pre><code>## ---------------------------------------------------- 
## Gaussian finite mixture model fitted by EM algorithm 
## ---------------------------------------------------- 
## 
## Mclust VEV (ellipsoidal, equal shape) model with 7 components: 
## 
##  log-likelihood   n  df       BIC       ICL
##       -2750.539 486 165 -6521.803 -6588.722
## 
## Clustering table:
##   1   2   3   4   5   6   7 
##  56 124  59  22 152  45  28</code></pre>
<p>For this wave, Mclust selected a model with 7 (!) profiles; the optimal selected model is VEV, i.e., the profiles are ellipsoidal with equal shape (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5096736/">this article</a>).</p>
<p>Now we will access to the results and visualize the model. To visualize, we will use a new package (<em>factoextra</em>), to create nicer plots based on ggplot2.</p>
<pre class="r"><code>library(factoextra)
# BIC values used for choosing the number of clusters
fviz_mclust(mc, &quot;BIC&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="wave-3" class="section level4">
<h4>Wave 3</h4>
<p>We start by subsetting the data for the respective waves, and standardizing the indicators to z-scores, meaning that resulting profile means reflect standard deviation (SD) units above or below the sample mean (which is set to 0).</p>
<pre class="r"><code>sms_w3 &lt;- sms_long_nm[sms_long_nm$Timepoint==3, ] %&gt;%
  select(-Timepoint, -id) %&gt;% # subset W1
  select(25:30) %&gt;% # subset weighted factor scores
  mutate_all(list(scale)) # standardize indicators</code></pre>
<p>We then compute the model-based clustering, and ask for a summary.</p>
<pre class="r"><code>library(mclust)
mc &lt;- Mclust(sms_w3)
summary(mc)                 </code></pre>
<pre><code>## ---------------------------------------------------- 
## Gaussian finite mixture model fitted by EM algorithm 
## ---------------------------------------------------- 
## 
## Mclust VEV (ellipsoidal, equal shape) model with 9 components: 
## 
##  log-likelihood   n  df       BIC       ICL
##       -2838.908 506 211 -6991.614 -7076.572
## 
## Clustering table:
##   1   2   3   4   5   6   7   8   9 
##  34  58  43  22  60  34  36 172  47</code></pre>
<p>For this wave, Mclust selected a model with 9 (!) profiles; the optimal selected model is VEV, i.e., the profiles are ellipsoidal with equal shape (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5096736/">this article</a>).</p>
<pre class="r"><code>library(factoextra)
# BIC values used for choosing the number of clusters
fviz_mclust(mc, &quot;BIC&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="section-1" class="section level3 tabset tabset-fade">
<h3></h3>
<p>We will examine a sequence of models, with an increasing number of profiles from 2 to …, to ascertain whether more complex (i.e. more profiles) or parsimonious (i.e. fewer profiles) models provided the best description of the data. We will use the VEV model (varying volume, equal shape, varying orientation).</p>
<p>We will plot the profile means, the clustering and the clustering uncertainty. If the data contain more than two variables (which is the case in our data), the <em>fviz_mclust()</em>-function will use PCA to reduce the dimensionality of the data. The first two principal components are used to produce a scatter plot of the data. If we want to plot the data using only two variables (e.g., <em>external regulation</em> and <em>intrinsic motivation</em>), we can specify that in the function using the argument <em>choose.vars = c(“external”, “intrinsic”)</em>. Note that, in the uncertainty plot, larger symbols indicate the more uncertain observations.</p>
<p><br></p>
<div id="wave-1-1" class="section level4">
<h4>Wave 1</h4>
<div id="section-2" class="section level5 tabset tabset-fade">
<h5></h5>
<div id="profiles" class="section level6">
<h6>2 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w1) 
m2 &lt;- Mclust(sms_w1, modelNames = &quot;VEV&quot;, G = 2, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m2$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m2, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-44-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m2, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-44-3.png" width="672" /></p>
</div>
<div id="profiles-1" class="section level6">
<h6>3 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w1) 
m3 &lt;- Mclust(sms_w1, modelNames = &quot;VEV&quot;, G = 3, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m3$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m3, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m3, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-45-3.png" width="672" /></p>
</div>
<div id="profiles-2" class="section level6">
<h6>4 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w1) 
m4 &lt;- Mclust(sms_w1, modelNames = &quot;VEV&quot;, G = 4, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m4$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m4, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-46-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m4, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-46-3.png" width="672" /></p>
</div>
<div id="profiles-3" class="section level6">
<h6>5 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w1) 
m5 &lt;- Mclust(sms_w1, modelNames = &quot;VEV&quot;, G = 5, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m5$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m5, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-47-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m5, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-47-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="wave-2-1" class="section level4">
<h4>Wave 2</h4>
<div id="section-3" class="section level5 tabset tabset-fade">
<h5></h5>
<div id="profiles-4" class="section level6">
<h6>2 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w2) 
m2 &lt;- Mclust(sms_w2, modelNames = &quot;VEV&quot;, G = 2, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m2$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m2, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-48-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m2, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-48-3.png" width="672" /></p>
</div>
<div id="profiles-5" class="section level6">
<h6>3 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w2) 
m3 &lt;- Mclust(sms_w2, modelNames = &quot;VEV&quot;, G = 3, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m3$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m3, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m3, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-49-3.png" width="672" /></p>
</div>
<div id="profiles-6" class="section level6">
<h6>4 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w2) 
m4 &lt;- Mclust(sms_w2, modelNames = &quot;VEV&quot;, G = 4, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m4$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m4, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-50-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m4, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-50-3.png" width="672" /></p>
</div>
<div id="profiles-7" class="section level6">
<h6>5 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w2) 
m5 &lt;- Mclust(sms_w2, modelNames = &quot;VEV&quot;, G = 5, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m5$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m5, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-51-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m5, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-51-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="wave-3-1" class="section level4">
<h4>Wave 3</h4>
<div id="section-4" class="section level5 tabset tabset-fade">
<h5></h5>
<div id="profiles-8" class="section level6">
<h6>2 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w3) 
m2 &lt;- Mclust(sms_w3, modelNames = &quot;VEV&quot;, G = 2, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m2$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m2, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-52-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m2, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-52-3.png" width="672" /></p>
</div>
<div id="profiles-9" class="section level6">
<h6>3 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w3) 
m3 &lt;- Mclust(sms_w3, modelNames = &quot;VEV&quot;, G = 3, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m3$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m3, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m3, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-53-3.png" width="672" /></p>
</div>
<div id="profiles-10" class="section level6">
<h6>4 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w3) 
m4 &lt;- Mclust(sms_w3, modelNames = &quot;VEV&quot;, G = 4, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m4$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m4, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-54-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m4, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-54-3.png" width="672" /></p>
</div>
<div id="profiles-11" class="section level6">
<h6>5 profiles</h6>
<pre class="r fold-hide"><code>library(mclust)

BIC &lt;- mclustBIC(sms_w3) 
m5 &lt;- Mclust(sms_w3, modelNames = &quot;VEV&quot;, G = 5, x = BIC)

# Extract mean weighted factor scores
library(reshape2)
means &lt;- data.frame(m5$parameters$mean,
                    stringsAsFactors = F) %&gt;%
  rownames_to_column() %&gt;%
  rename(Motivation = rowname) %&gt;%
  melt(id.vars = &quot;Motivation&quot;, variable.name = &quot;Profile&quot;, value.name = &quot;Mean&quot;) %&gt;%
  mutate(Mean = round(Mean, 2))

# Plot showing the standardized means
means %&gt;%
  ggplot(aes(Motivation, Mean, group = Profile, color = Profile)) +
  geom_line() +
  geom_point() +
  scale_x_discrete(limits = c(&quot;amotivation&quot;, &quot;external&quot;, &quot;introjected&quot;, &quot;identified&quot;, &quot;integrated&quot;, &quot;intrinsic&quot;)) +
  labs(x = NULL, y = &quot;Standardized mean weighted factor-scores&quot;) +
  scale_colour_manual(values=c(&quot;#56B4E9&quot;, &quot;#000000&quot;, &quot;#E69F00&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = 0, linetype=&quot;dashed&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;top&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<pre class="r fold-hide"><code>library(factoextra)

# Plot showing the clustering
fviz_mclust(m5, &quot;classification&quot;, geom = &quot;point&quot;,
            pointsize = 1.5, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
<pre class="r fold-hide"><code># Plot showing the clustering uncertainty
fviz_mclust(m5, &quot;uncertainty&quot;, palette = &quot;jco&quot;)</code></pre>
<p><img src="lpta_files/figure-html/unnamed-chunk-55-3.png" width="672" /></p>
</div>
</div>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkxhdGVudCBQcm9maWxlIFRyYW5zaXRpb24gQW5hbHlzaXMiDQpvdXRwdXQ6DQogIGh0bWxfZG9jdW1lbnQ6DQogICAgdG9jOiB0cnVlDQogICAgdG9jX2Zsb2F0OiB0cnVlDQogICAgY29sbGFwc2VkOiBmYWxzZQ0KICAgIG51bWJlcl9zZWN0aW9uczogZmFsc2UNCiAgICB0b2NfZGVwdGg6IDMNCiAgICBjb2RlX2ZvbGRpbmc6IHNob3cNCiAgICBjb2RlX2Rvd25sb2FkOiB5ZXMNCi0tLQ0KDQpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0NCmtuaXRyOjpvcHRzX2NodW5rJHNldChtZXNzYWdlPUZBTFNFLHdhcm5pbmc9RkFMU0UsIGNhY2hlPVRSVUUpDQpgYGANCg0KDQo8YnI+DQoNCipMYXN0IGVkaXRlZDogSmFudWFyeSAyNSwgMjAyMSoNCg0KPGJyPg0KDQpJbiB0aGUgZm9sbG93aW5nLCB3ZSB3aWxsIGV4cGxvcmUgbW90aXZhdGlvbmFsIHByb2ZpbGVzIGluIHRoZSBjb250ZXh0IG9mIGxvbmdpdHVkaW5hbCBkYXRhLCB1c2luZyBTRFQgYXMgYSB0aGVvcmV0aWNhbCBmcmFtZXdvcmsuIFdlIHdpbGwgZXhwbG9yZSBtb3ZlbWVudCBiZXR3ZWVuIG1vdGl2YXRpb25hbCBwcm9maWxlcyBvdmVyIHRpbWUuDQoNCjxicj4NCg0KIyMgQXBwcm9hY2gNCg0KRmlyc3QsIHdlIG9idGFpbiB3ZWlnaHRlZCBmYWN0b3Itc2NvcmVzIGZvciBlYWNoIFNNUy1zdWJzY2FsZSB3aXRoIENGQSB1c2luZyBNTEUsIGFzIGlucHV0IGZvciBvdXIgc3Vic2VxdWVudCBMUEEuIFRoZW4sIHdlIHVzZSBhIHRocmVlLXN0ZXAgYXBwcm9hY2ggKHNlZSBbdGhpcyBhcnRpY2xlXShodHRwczovL3d3dy50YW5kZm9ubGluZS5jb20vZG9pL3BkZi8xMC4xMDgwLzEwNzA1NTExLjIwMTQuOTE1MTgxKTsgb3IgdGhlIHBhcGVyIGJ5IFtFbW0tQ29sbGlzb24gYW5kIGNvbGxlYWd1ZXNdKGh0dHBzOi8vd3d3LnNjaWVuY2VkaXJlY3QuY29tL3NjaWVuY2UvYXJ0aWNsZS9waWkvUzE0NjkwMjkyMTkzMDM4NTEpIHdobyB1c2VkIHRoZSBzYW1lIHByb2NlZHVyZSkuDQoNCg0KLS0tDQoNCiMgUHJlbGltaW5hcnkgc3RlcHMNCg0KIyMgMS4gRGF0YQ0KDQpMZXQncyBnZXQgb3VyICdjbGVhbmVkJyBTTVMtZGF0YSwgZm9yIGVhY2ggd2F2ZS4NCg0KYGBge3IsIHdhcm5pbmc9RkFMU0UsIG1lc3NhZ2U9RkFMU0V9DQpsaWJyYXJ5KHNqbGFiZWxsZWQpDQpsaWJyYXJ5KGRwbHlyKQ0KbGlicmFyeSh0aWR5dmVyc2UpDQpsaWJyYXJ5KGNhcmVsZXNzKQ0KbGlicmFyeShwc3ljaCkNCg0KbG9hZCgiZGF0YV9hYnNfcHVibGljX3YyLlJEYXRhIikgIyBsb2FkIGRhdGENCmRhdGFfYWJzX3B1YmxpYyA8LSB1bmxhYmVsKGRhdGFfYWJzX3B1YmxpYywgdmVyYm9zZT1GKSAjIHVubGFiZWwNCg0KZGF0YV9hYnNfcHVibGljJGlkIDwtIDE6bnJvdyhkYXRhX2Fic19wdWJsaWMpICMgYWRkIGlkZW50aWZpZXIgZm9yIHN1YnNlcXVlbnQgTFBUQQ0KDQojIHN1YnNldCBzbXMgZGF0YSBpbiBlYWNoIHdhdmUNCnNtc193MSA8LSBkYXRhX2Fic19wdWJsaWMgJT4lIHNlbGVjdChXMV9NMV8xLCBXMV9NMV8yLCBXMV9NMV8zLCBXMV9NMV80LCBXMV9NMV81LCBXMV9NMV82LCBXMV9NMV83LCBXMV9NMV84LCBXMV9NMl8xLCBXMV9NMl8yLCBXMV9NMl8zLCBXMV9NMl80LCBXMV9NMl81LCBXMV9NMl82LCBXMV9NMl83LCBXMV9NMl84LCBXMV9NM18xLCBXMV9NM18yLCBXMV9NM18zLCBXMV9NM180LCBXMV9NM181LCBXMV9NM182LCBXMV9NM183LCBXMV9NM184LCBpZCkNCg0Kc21zX3cyIDwtIGRhdGFfYWJzX3B1YmxpYyAlPiUgc2VsZWN0KFcyX00xXzEsIFcyX00xXzIsIFcyX00xXzMsIFcyX00xXzQsIFcyX00xXzUsIFcyX00xXzYsIFcyX00xXzcsIFcyX00xXzgsIFcyX00yXzEsIFcyX00yXzIsIFcyX00yXzMsIFcyX00yXzQsIFcyX00yXzUsIFcyX00yXzYsIFcyX00yXzcsIFcyX00yXzgsIFcyX00zXzEsIFcyX00zXzIsIFcyX00zXzMsIFcyX00zXzQsIFcyX00zXzUsIFcyX00zXzYsIFcyX00zXzcsIFcyX00zXzgsIGlkKSANCg0Kc21zX3czIDwtIGRhdGFfYWJzX3B1YmxpYyAlPiUgc2VsZWN0KFczX00xXzEsIFczX00xXzIsIFczX00xXzMsIFczX00xXzQsIFczX00xXzUsIFczX00xXzYsIFczX00xXzcsIFczX00xXzgsIFczX00yXzEsIFczX00yXzIsIFczX00yXzMsIFczX00yXzQsIFczX00yXzUsIFczX00yXzYsIFczX00yXzcsIFczX00yXzgsIFczX00zXzEsIFczX00zXzIsIFczX00zXzMsIFczX00zXzQsIFczX00zXzUsIFczX00zXzYsIFczX00zXzcsIFczX00zXzgsIGlkKQ0KDQojIG1ha2UgYSAnc3RyaW5nJyB2YXJpYWJsZSANCnNtc193MSA8LSBzbXNfdzEgJT4lDQogIG11dGF0ZShzdHJpbmdfdzEgPSBsb25nc3RyaW5nKC4pKSAlPiUNCiAgbXV0YXRlKG1kX3cxID0gb3V0bGllciguLCBwbG90ID0gRkFMU0UpKQ0KDQpzbXNfdzIgPC0gc21zX3cyICU+JQ0KICBtdXRhdGUoc3RyaW5nX3cyID0gbG9uZ3N0cmluZyguKSkgJT4lDQogIG11dGF0ZShtZF93MiA9IG91dGxpZXIoLiwgcGxvdCA9IEZBTFNFKSkgDQoNCnNtc193MyA8LSBzbXNfdzMgJT4lDQogIG11dGF0ZShzdHJpbmdfdzMgPSBsb25nc3RyaW5nKC4pKSAlPiUNCiAgbXV0YXRlKG1kX3czID0gb3V0bGllciguLCBwbG90ID0gRkFMU0UpKSANCg0KIyBjYXAgc3RyaW5nIHJlc3BvbmRpbmcgYW5kIHVzZSBNRA0KY3V0b2ZmX3cxIDwtIChxY2hpc3EocCA9IDEgLSAuMDAxLCBkZiA9IChuY29sKHNtc193MSkgLSAxKSkpDQpzbXNfdzEgPC0gc21zX3cxICU+JQ0KICBmaWx0ZXIoc3RyaW5nX3cxIDw9IDEwLA0KICAgICAgICAgbWRfdzEgPCBjdXRvZmZfdzEpICU+JQ0KICBzZWxlY3QoLXN0cmluZ193MSwgLW1kX3cxKQ0KDQogIGN1dG9mZl93MiA8LSAocWNoaXNxKHAgPSAxIC0gLjAwMSwgZGYgPSAobmNvbChzbXNfdzIpIC0gMSkpKQ0Kc21zX3cyIDwtIHNtc193MiAlPiUNCiAgZmlsdGVyKHN0cmluZ193MiA8PSAxMCwNCiAgICAgICAgIG1kX3cyIDwgY3V0b2ZmX3cyKSAlPiUNCiAgc2VsZWN0KC1zdHJpbmdfdzIsIC1tZF93MikNCg0KY3V0b2ZmX3czIDwtIChxY2hpc3EocCA9IDEgLSAuMDAxLCBkZiA9IChuY29sKHNtc193MykgLSAxKSkpDQpzbXNfdzMgPC0gc21zX3czICU+JQ0KICBmaWx0ZXIoc3RyaW5nX3czIDw9IDEwLA0KICAgICAgICAgbWRfdzMgPCBjdXRvZmZfdzMpICU+JQ0KICBzZWxlY3QoLXN0cmluZ193MywgLW1kX3czKQ0KYGBgDQoNCk5leHQsIHdlIGFyZSBnb2luZyB0byBtYWtlIGEgbG9uZyBmaWxlIG9mIHRoZSBTTVMgZGF0YS4NCg0KYGBge3J9DQojIGZpcnN0LCBtYWtlIGEgd2lkZSBmb3JtYXQNCnNtc193aWRlIDwtIG1lcmdlKHNtc193MSwgc21zX3cyLCBieSA9ICJpZCIpICMgZmlyc3Qgd2F2ZSAxIGFuZCAyDQpzbXNfd2lkZSA8LSBtZXJnZShzbXNfd2lkZSwgc21zX3czLCBieSA9ICJpZCIpICMgYWRkIHdhdmUgMw0KDQojIHRoZW4gdHJhbnNmb3JtIGludG8gbG9uZyBzaGFwZQ0KbGlicmFyeShyZXNoYXBlMikNCnNtc19sb25nIDwtIHJlc2hhcGUoc21zX3dpZGUsDQogICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9ICJsb25nIiwNCiAgICAgICAgICAgICAgICAgICAgdmFyeWluZyA9IGMobGlzdChuYW1lcyhzbXNfd2lkZSlbYygyLCAyNiwgNTApXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYygzLCAyNywgNTEpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYyg0LCAyOCwgNTIpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYyg1LCAyOSwgNTMpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYyg2LCAzMCwgNTQpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYyg3LCAzMSwgNTUpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYyg4LCAzMiwgNTYpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYyg5LCAzMywgNTcpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYygxMCwgMzQsIDU4KV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QobmFtZXMoc21zX3dpZGUpW2MoMTEsIDM1LCA1OSldKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0KG5hbWVzKHNtc193aWRlKVtjKDEyLCAzNiwgNjApXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYygxMywgMzcsIDYxKV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QobmFtZXMoc21zX3dpZGUpW2MoMTQsIDM4LCA2MildKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0KG5hbWVzKHNtc193aWRlKVtjKDE1LCAzOSwgNjMpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYygxNiwgNDAsIDY0KV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QobmFtZXMoc21zX3dpZGUpW2MoMTcsIDQxLCA2NSldKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0KG5hbWVzKHNtc193aWRlKVtjKDE4LCA0MiwgNjYpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYygxOSwgNDMsIDY3KV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QobmFtZXMoc21zX3dpZGUpW2MoMjAsIDQ0LCA2OCldKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0KG5hbWVzKHNtc193aWRlKVtjKDIxLCA0NSwgNjkpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYygyMiwgNDYsIDcwKV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QobmFtZXMoc21zX3dpZGUpW2MoMjMsIDQ3LCA3MSldKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0KG5hbWVzKHNtc193aWRlKVtjKDI0LCA0OCwgNzIpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdChuYW1lcyhzbXNfd2lkZSlbYygyNSwgNDksIDczKV0pKSwNCiAgICAgICAgICAgICAgICAgICAgdi5uYW1lcyA9IGMoIk0xXzEiLCAiTTFfMiIsICJNMV8zIiwiTTFfNCIsICJNMV81IiwgIk0xXzYiLCAiTTFfNyIsICJNMV84IiwgIk0yXzEiLCAiTTJfMiIsICJNMl8zIiwiTTJfNCIsICJNMl81IiwgIk0yXzYiLCAiTTJfNyIsICJNMl84IiwgIk0zXzEiLCAiTTNfMiIsICJNM18zIiwiTTNfNCIsICJNM181IiwgIk0zXzYiLCAiTTNfNyIsICJNM184IiksDQogICAgICAgICAgICAgICAgICAgIGlkdmFyID0gImlkIiwNCiAgICAgICAgICAgICAgICAgICAgdGltZXZhciA9ICJUaW1lcG9pbnQiLA0KICAgICAgICAgICAgICAgICAgICB0aW1lcyA9IDE6MykNCiMgUmVvcmRlcg0Kc21zX2xvbmcgIDwtIHNtc19sb25nIFsob3JkZXIoc21zX2xvbmckaWQpKSwgXQ0KIyBmaXgoc21zX2xvbmcpIHRvIGNoZWNrIGRhdGEgc3RydWN0dXJlDQoNCnNtc19sb25nX25tIDwtIHNtc19sb25nICU+JQ0KICBuYS5vbWl0KCkgIyBsaXN0d2lzZSBkZWxldGlvbg0KYGBgDQoNCjxicj4NCg0KLS0tLQ0KDQojIyAyLiBDRkENCg0KRmlyc3QsIGNvbmZpcm1hdG9yeSBmYWN0b3IgYW5hbHlzaXMgdXNpbmcgbWF4aW11bSBsaWtlbGlob29kIGVzdGltYXRpb24gd2FzIGNvbmR1Y3RlZCB0byBvYnRhaW4gd2VpZ2h0ZWQgZmFjdG9yIHNjb3JlcyBmb3IgZWFjaCBTTVMgc3Vic2NhbGUuIFdlIGZpcnN0IGNvbmR1Y3QgQ0ZBIG9uIHRoZSBzdGFja2VkIGRhdGEgKGhlbmNlIGFzc3VtaW5nIG9ic2VydmF0aW9ucyB0byBiZSBpbmRlcGVuZGVudCBvZiBlYWNoIG90aGVyKS4gV2Ugd2lsbCBhc3Nlc3MgbW9kZWwgZml0IHVzaW5nIG11bHRpcGxlIGluZGljZXMuIEFmdGVyd2FyZHMsIHdlIHdpbGwgYXNzZXNzIGxvbmdpdHVkaW5hbCBpbnZhcmlhbmNlIG9mIHRoZSBtZWFzdXJlbWVudCBtb2RlbCB2aWEgYSBzZXJpZXMgb2YgaW5jcmVhc2luZ2x5IGNvbnN0cmFpbmluZyBtb2RlbHMsIGluZGljYXRpbmcgaW52YXJpYW5jZSBieSBhIGNoYW5nZSBvZiBDRkkgb2Yg4omkMC4wMS4NCg0KIyMjIExhdmFhbg0KDQpUZWxsIExhdmFhbiB0aGUgY29uZmlybWF0b3J5IHN0cnVjdHVyZS4NCg0KYGBge3J9DQpsaWJyYXJ5KGxhdmFhbikNCg0KbW90aXZhdGlvbl9tb2RlbCA8LSAiDQphbW90aXZhdGlvbiA9fiBNMV81ICsgTTJfNCArIE0zXzEgKyBNM182DQpleHRlcm5hbCAgICA9fiBNMV80ICsgTTJfMyArIE0zXzMgKyBNM184DQppbnRyb2plY3RlZCA9fiBNMV83ICsgTTJfMiArIE0yXzggKyBNM183DQppZGVudGlmaWVkICA9fiBNMV8zICsgTTFfOCArIE0yXzcgKyBNM180DQppbnRlZ3JhdGVkICA9fiBNMV8yICsgTTJfMSArIE0yXzUgKyBNM181DQppbnRyaW5zaWMgICA9fiBNMV8xICsgTTFfNiArIE0yXzYgKyBNM18yDQoiDQpgYGANCg0KTm93IGxldCdzIGluc3BlY3QgdGhlIG1vZGVsLiBXZSB3aWxsIGdldCB0aGUgZml0IG9mIHRoZSBtb2RlbCwgdGhlIChzdGFuZGFyZGl6ZWQpIGZhY3RvciBsb2FkaW5ncywgaXRlbSBhdmVyYWdlcyAoaW50ZXJjZXB0cyksIGVycm9yIHZhcmlhbmNlcywgYW5kIFItc3F1YXJlIHNjb3Jlcy4gV2Ugd2lsbCBhbHNvIG1ha2UgYSB0YWJsZSBvZiB0aGUgdmFyaW91cyBmaXQgaW5kaWNlcy4gDQogDQpgYGB7cn0NCiMgZXhhbWluZSBvdmVyYWxsIGZpdA0Kb3ZlcmFsbC5maXQgPC0gY2ZhKG1vZGVsID0gbW90aXZhdGlvbl9tb2RlbCwgZGF0YSA9IHNtc19sb25nX25tLA0KICAgICAgICAgICBtZWFuc3RydWN0dXJlID0gVFJVRSwgICMgZ2l2ZXMgdXMgdGhlIG1lYW5zDQogICAgICAgICAgIHN0ZC5sdiA9IFRSVUUpIA0KDQpzdW1tYXJ5KG92ZXJhbGwuZml0LCBzdGFuZGFyZGl6ZWQgPSBUUlVFLCByc3F1YXJlID0gVFJVRSwgZml0Lm1lYXN1cmUgPSBUUlVFKQ0KDQojIG1ha2UgdGFibGUgb2YgZml0IGluZGljZXMNCnRhYmxlX2ZpdCA8LSBtYXRyaXgoTkEsIG5yb3cgPSAxMSwgbmNvbCA9IDYpDQpjb2xuYW1lcyh0YWJsZV9maXQpIDwtIGMoIk1vZGVsIiwgIlgyIiwgImRmIiwgIkNGSSIsICJSTVNFQSIsICJTUk1SIikNCnRhYmxlX2ZpdFsxLCBdIDwtIGMoIk92ZXJhbGwgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhvdmVyYWxsLmZpdCwgYygiY2hpc3EiLCAiZGYiLCAiY2ZpIiwgInJtc2VhIiwgInNybXIiKSksMykpDQoNCmBgYA0KDQo8YnI+DQoNClRvIGNoZWNrIHRoZSBjb25maXJtYXRvcnkgc3RydWN0dXJlIG9mIG91ciBtb2RlbCwgd2Ugd2lsbCBhbHNvIGNyZWF0ZSBhIHBpY3R1cmUgb2YgdGhlIHN0YW5kYXJkaXplZCBzb2x1dGlvbiAocXVpY2sgYW5kIGRpcnR5OyBpdCBjYW4gYmUgZWRpdGVkLi4uKS4gVGhlIHRyaWFuZ2xlcyBkZXBpY3QgdGhlIChzdGFuZGFyZGl6ZWQpIGludGVyY2VwdHMsIHRoZSBhcnJvd3MgZGVwaWMgdGhlIHZhcmlhbmNlIChpLmUuIHRoZSBsb29wcykgYW5kIChzdGFuZGFyZGl6ZWQpIGZhY3RvciBsb2FkaW5ncy4gDQoNCmBgYHtyfQ0KbGlicmFyeShzZW1QbG90KQ0Kc2VtUGF0aHMob3ZlcmFsbC5maXQsIHdoYXRMYWJlbHMgPSAic3RkIiwgbGF5b3V0ID0gInRyZWUiKQ0KYGBgDQoNCiMjIyBMb25naXR1ZGluYWwgaW52YXJpYW5jZSB7LnRhYnNldCAudGFic2V0LWZhZGV9DQoNClNpbmNlIHdlIGFyZSBkZWFsaW5nIHdpdGggcGFuZWwgZGF0YSwgYW5kIHdlIHdhbnQgdG8gZXhwbG9yZSBtb3ZlbWVudCBvdmVyIHRpbWUgaW4gbW90aXZhdGlvbnMsIHdlIHNob3VsZCBpbnZlc3RpZ2F0ZSB0byB3aGF0IGV4dGVudCBvdXIgQ0ZBIHNvbHV0aW9uIGlzIGludmFyaWFudCBvdmVyIHRpbWUgKGJlY2F1c2Ugd2UgZG9uJ3Qgd2FudCB0byBjb21wYXJlIGFwcGxlcyB3aXRoIG9yYW5nZXMpLg0KV2Ugd2lsbCBjb21wYXJlIHRoZSBTTVMgZGF0YSBvZiBXMS1XMyBhbmQgY29tcGFyZSB0aGVtIGluIENGQSBmb3IgY29uZmlndXJhbCwgbWV0cmljLCBzY2FsYXIsIGFuZCBzdHJpY3QgcmVzaWR1YWwgaW52YXJpYW5jZSAoc2VlIGUuZy4sIFtDaGV1bmcgJiBSZW5zdm9sZCAyMDAyXShodHRwczovL3d3dy50YW5kZm9ubGluZS5jb20vZG9pL3BkZi8xMC4xMjA3L1MxNTMyODAwN1NFTTA5MDJfNT9jYXNhX3Rva2VuPXNjeVZQWlJrbmNRQUFBQUE6UEREYXdYeEMwQk12THUta2pjdnRhRmNIc2Vabk8zcmt3WDRuSkd0ZDhPckstbnVUcTRCMU1rNTcxYWpwamFxM0pRaGFzVkhueVh0b2ZkZykpLg0KDQpXZSB3aWxsIHVzZSBhIG5ldyBwYWNrYWdlIGZvciB0aGlzLiBBcHBhcmVudGx5LCB0aGlzIHBhY2thZ2Ugb25seSBhbGxvd3MgZm9yIG11bHRpLWdyb3VwIGVxdWl2YWxlbmNlIHRlc3RpbmcgZm9yIHR3byBncm91cHMgKGluIExhdmFhbiBtdWx0aXBsZSBncm91cHMgY2FuIGJlIGNvbXBhcmVkKTsgdGhlcmVmb3JlLCBJIHdpbGwgcnVuIHRoZSBzYW1lIHByb2NlZHVyZSBmb3IgZWFjaCBwYWlyIChpLmUuLCBXMSB2cy4gVzIsIFcyIHZzLiBXMywgYW5kIFcxIHZzLiBXMykuDQoNCkZpcnN0LCB3ZSB3aWxsIHN1YnNldCBkYXRhZnJhbWVzIHRoYXQgb25seSBpbmNsdWRlIHR3byBncm91cHMgKGkuZS4gd2F2ZXMpIGZvciBjb21wYXJpc29uLCBmb3Igc3Vic2VxdWVudCBlcXVpdmFsZW5jZSB0ZXN0cy4gDQpgYGB7cn0NClcxXzIgPC0gaWZlbHNlKHNtc19sb25nX25tJFRpbWVwb2ludCA9PSAxLCAwLCBpZmVsc2Uoc21zX2xvbmdfbm0kVGltZXBvaW50ID09IDIsIDEsIE5BKSkNCnNtczEyIDwtIHNtc19sb25nX25tWyFpcy5uYShXMV8yKSwgXSAjIGNvbXBhcmUgdzEgYW5kIHcyDQoNClcyXzMgPC0gaWZlbHNlKHNtc19sb25nX25tJFRpbWVwb2ludCA9PSAyLCAwLCBpZmVsc2Uoc21zX2xvbmdfbm0kVGltZXBvaW50ID09IDMsIDEsIE5BKSkNCnNtczIzIDwtIHNtc19sb25nX25tWyFpcy5uYShXMl8zKSwgXSAjIGNvbXBhcmUgdzIgYW5kIHczDQoNClcxXzMgPC0gaWZlbHNlKHNtc19sb25nX25tJFRpbWVwb2ludCA9PSAxLCAwLCBpZmVsc2Uoc21zX2xvbmdfbm0kVGltZXBvaW50ID09IDMsIDEsIE5BKSkNCnNtczEzIDwtIHNtc19sb25nX25tWyFpcy5uYShXMV8zKSwgXSAjIGNvbXBhcmUgdzEgYW5kIHczDQpgYGANCg0KPGJyPg0KDQojIyMjIENvbXBhcmluZyBXYXZlIDEgYW5kIFdhdmUgMiANCg0KYGBge3J9DQpsaWJyYXJ5KGVxdWFsdGVzdE1JKSAjaW5zdGFsbCBwYWNrYWdlDQoNCiMgZXN0aW1hdGUgdGhlIG11bHRpLWdyb3VwIG1vZGVsDQpNRy5tb2RlbCA8LSBlcU1JLm1haW4obW9kZWwgPSBtb3RpdmF0aW9uX21vZGVsLCANCiAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gc21zMTIsIA0KICAgICAgICAgICAgICAgICAgICAgIGdyb3VwID0gIlRpbWVwb2ludCIsICNjb21wYXJpbmcgd2F2ZSAxIGFuZCB3YXZlIDINCiAgICAgICAgICAgICAgICAgICAgICBtZWFuc3RydWN0dXJlID0gVFJVRSwgI2luY2x1ZGUgdGhlIG1lYW5zDQogICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gImJvdGgiLCAjbWVhbnMsIGNvdmFyaWFuY2UsIGJvdGgNCiAgICAgICAgICAgICAgICAgICAgICBlcXVpdmFsZW5jZS50ZXN0ID0gRkFMU0UsIA0KICAgICAgICAgICAgICAgICAgICAgIGFkalJNU0VBID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uID0gVFJVRSwgI3Rlc3QgZXF1YWxpdHkgb2YgbGF0ZW50IGZhY3RvciBtZWFucyAoZXZlbiB3aGVuIGVxdWFsaXR5IG9mIGludGVyY2VwdHMgZG9lcyBub3QgaG9sZCkNCiAgICAgICAgICAgICAgICAgICAgICBib290c3RyYXAgPSBGQUxTRSwNCiAgICAgICAgICAgICAgICAgICAgICBxdWlldCA9IFRSVUUpDQpgYGANCg0KTm93IHdlIHdpbGwgc3VtbWFyaXplIHRoZSByZXN1bHRzIG9mIHRoZSBtdWx0aS1ncm91cCBtb2RlbCwgYW5kIGFkZCB0aGVtIHRvIG91ciBwcmV2aW91c2x5IG1hZGUga2FibGUtdGFibGUuDQoNCmBgYHtyfQ0KdGFibGVfZml0WzIsIF0gPC0gYygiVzEgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LmNvbmZpZ3VyYWwuZzEsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKSAjIGdyb3VwIDE6IFdhdmUgMQ0KdGFibGVfZml0WzMsIF0gPC0gYygiVzIgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LmNvbmZpZ3VyYWwuZzIsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKSAjIGdyb3VwIDI6IFdhdmUgMg0KDQpgYGANCg0KQW5kIHRvIHRlc3QgZm9yIGNvbmZpZ3VyYWwgaW52YXJpYW5jZSAtIGlzIHRoZSAncGljdHVyZScvc3RydWN0dXJlIG9mIHRoZSBtb2RlbCB0aGUgc2FtZSBmb3IgYm90aCBncm91cHMgKGkuZS4gd2F2ZXMpLCB3ZSBzdGFjayB0aGUgZ3JvdXBzIHRvZ2V0aGVyLg0KDQpgYGB7cn0NCmxpYnJhcnkoa25pdHIpDQpsaWJyYXJ5KGthYmxlRXh0cmEpDQpsaWJyYXJ5KGRwbHlyKQ0KbGlicmFyeSh0aWR5cikNCg0KdGFibGVfZml0WzQsIF0gPC0gYygiQ29uZmlndXJhbCBNb2RlbCIsIHJvdW5kKGZpdG1lYXN1cmVzKE1HLm1vZGVsJGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQuY29tYmluZS5ncm91cHMsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKQ0KDQppbnB1dCA8LSB0YWJsZV9maXRbMTo0LCBdIA0Ka25pdHI6OmthYmxlKGlucHV0LCBkaWdpdHM9MiwgImh0bWwiLCBjYXB0aW9uPSIiKSAlPiUgDQogIGthYmxlRXh0cmE6OmthYmxlX3N0eWxpbmcoYm9vdHN0cmFwX29wdGlvbnMgPSBjKCJzdHJpcGVkIiwgImhvdmVyIikpDQpgYGANCg0KVGhpcyBpcyB0aGUgbW9kZWwgYWdhaW5zdCB3aGljaCB3ZSB3aWxsIHRlc3QgdGhlIG5leHQgbW9kZWwuIFNvLCB3ZSB3aWxsIGNvbmR1Y3QgYSBzZXF1ZW50aWFsIHRlc3RpbmcgYW5hbHlzaXMuIE5leHQsIHdlIHdpbGwgYXNzZXNzIG1ldHJpYyBpbnZhcmlhbmNlLCBieSBjb25zdHJhaW5pbmcgdGhlIGZhY3RvciBsb2FkaW5ncyB0byBiZSBlcXVhbCBhY3Jvc3MgdGhlIHdhdmVzLiBJbiB0aGUgY29uZmlndXJhbCBtb2RlbCwgZmFjdG9yIGxvYWRpbmdzIHdlcmUgImZyZWVseSIgZXN0aW1hdGVkIGluIGJvdGggd2F2ZXM7IG5vdywgb25seSAxIGxvYWRpbmcgZ2V0cyBlc3RpbWF0ZWQgZm9yIGJvdGggZ3JvdXBzLiBMZXQncyBzZWUgd2hhdCBoYXBwZW5zIHRvIHRoZSBtb2RlbC4gDQoNCmBgYHtyfQ0KdGFibGVfZml0WzUsIF0gPC0gYygiTWV0cmljIE1vZGVsIiwgcm91bmQoZml0bWVhc3VyZXMoTUcubW9kZWwkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5tZXRyaWMsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKQ0KDQppbnB1dCA8LSB0YWJsZV9maXRbMTo1LCBdIA0Ka25pdHI6OmthYmxlKGlucHV0LCBkaWdpdHM9MiwgImh0bWwiLCBjYXB0aW9uPSIiKSAlPiUgDQogIGthYmxlRXh0cmE6OmthYmxlX3N0eWxpbmcoYm9vdHN0cmFwX29wdGlvbnMgPSBjKCJzdHJpcGVkIiwgImhvdmVyIikpDQpgYGANCg0KVGhlIG1ldHJpYyBtb2RlbCBzZWVtcyB0byBiZSBpbnZhcmlhbnQgaW4gY29tcGFyaXNvbiB0byB0aGUgY29uZmlndXJhbCBtb2RlbDogdGhlIENGSSBkaWZmZXJlbmNlIGlzIHNtYWxsZXIgdGhhbiAuMDEsIGhlbmNlIGFzc3VtaW5nIGludmFyaWFuY2UgKHNhbWUgaG9sZHMgZm9yIFJNU0VBL1NSTVIpLiBDb25jbHVzaW9uOiB0aGUgbWV0cmljIG1vZGVsIGhvbGRzOiB0aGUgbG9hZGluZ3MgYXJlIGVxdWFsIChvciBjbG9zZSBlbm91Z2gpLiANCg0KPGJyPg0KDQpXZSBoYXZlIGNvbnN0cmFpbmVkIG91ciBtb2RlbCB0byBjb250YWluIHRoZSBzYW1lIHN0cnVjdHVyZSwgdGhlIHNhbWUgbG9hZGluZ3M7IG5vdyBsZXQncyB0ZXN0IGZvciBzY2FsYXIgaW52YXJpYW5jZSwgdG8gc2VlIGlmIHRoZSBpbnRlcmNlcHRzIGFyZSB0aGUgc2FtZSBhY3Jvc3Mgd2F2ZXMuIA0KDQpgYGB7cn0NCnRhYmxlX2ZpdFs2LCBdIDwtIGMoIlNjYWxhciBNb2RlbCIsIHJvdW5kKGZpdG1lYXN1cmVzKE1HLm1vZGVsJGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQuc2NhbGFyLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6NiwgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCg0KVGhlIGludGVyY2VwdHMgYXJlIGVxdWFsIG9uIHRoZSBzY2FsZSBiZXR3ZWVuIHRoZSB3YXZlcy4gDQoNCjxicj4NCg0KTGFzdCwgd2UgY29uc3RyYWluIHRoZSBtb2RlbCB0byB0aGUgc3RyaWN0IG1vZGVsLCB0byBjaGVjayBmb3Igc3RyaWN0IHJlc2lkdWFsIGludmFyaWFuY2UuIEl0IHdpbGwgaW5mb3JtIHdoZXRoZXIgdGhlIHZhcmlhbmNlIGFyb3VuZCBpdGVtcyBpcyB0aGUgc2FtZSBhY3Jvc3MgdGltZS4NCg0KYGBge3J9DQp0YWJsZV9maXRbNywgXSA8LSBjKCJTdHJpY3QgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LnN0cmljdC5yZXNpZHVhbHMsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKQ0KDQppbnB1dCA8LSB0YWJsZV9maXRbMTo3LCBdIA0Ka25pdHI6OmthYmxlKGlucHV0LCBkaWdpdHM9MiwgImh0bWwiLCBjYXB0aW9uPSIiKSAlPiUgDQogIGthYmxlRXh0cmE6OmthYmxlX3N0eWxpbmcoYm9vdHN0cmFwX29wdGlvbnMgPSBjKCJzdHJpcGVkIiwgImhvdmVyIikpDQpgYGANCg0KRnJvbSBoZXJlIGl0IGdvZXMgZG93bndhcmRzLi4uIENGSSBkcm9wcGVkIG1vcmUgdGhhbiAwLjAxLCBzdWdnZXN0aW5nIHRoYXQgdGhlIHJlc2lkdWFscyB2YXJ5IGJldHdlZW4gdGhlIHdhdmVzLiBXZSBjb3VsZCBlc3RpbWF0ZSBwYXJ0aWFsIGludmFyaWFuY2UsIHRvIGludmVzdGlnYXRlIHdoZXJlIHRoZSBwcm9ibGVtIGlzIGFuZCBzdWJzZXF1ZW50bHkgdXBkYXRlIHRoZSBtb2RlbCB0byBmaXggaXQuIFdlIGFyZSBnb2luZyB0byBkbyBzbyBieSBmcmVlaW5nIHRoZSB2YXJpYW5jZXMgb2YgaXRlbSByZXNpZHVhbHMsIG9uZSBhdCBhIHRpbWUsIHRvIGZpZ3VyZSBvdXQgd2hpY2ggZXF1YWxpdHkgY29uc3RhaW50KHMpIGlzL2FyZSBjYXVzaW5nIHRoZSBwcm9ibGVtLiBXZSB3aWxsIHVzZSB0aGUgZm9sbG93aW5nIGxvb3AgZm9yIHRoaXMuIA0KDQpgYGB7cn0NCiMgd3JpdGUgb3V0IHBhcnRpYWwgY29kZXMNCnBhcnRpYWxfc3ludGF4IDwtIHBhc3RlKGNvbG5hbWVzKHNtczEyKVszOjI2XSwgI2FsbCBzbXMgY29sdW1ucw0KICAgICAgICAgICAgICAgICAgICAgICAgIn5+IiwgI3Jlc2lkdWFscw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sbmFtZXMoc21zMTIpWzM6MjZdKSAjYWxsIGNvbHVtbnMgYWdhaW4NCg0KQ0ZJX2xpc3QgPC0gMTpsZW5ndGgocGFydGlhbF9zeW50YXgpDQpuYW1lcyhDRklfbGlzdCkgPC0gcGFydGlhbF9zeW50YXggDQoNCmZvciAoaSBpbiAxOmxlbmd0aChwYXJ0aWFsX3N5bnRheCkpew0KICANCiAgdGVtcCA8LSBjZmEobW9kZWwgPSBtb3RpdmF0aW9uX21vZGVsLA0KICAgICAgICAgICAgICBkYXRhID0gc21zMTIsDQogICAgICAgICAgICAgIG1lYW5zdHJ1Y3R1cmUgPSBUUlVFLA0KICAgICAgICAgICAgICBncm91cCA9ICJUaW1lcG9pbnQiLA0KICAgICAgICAgICAgICBncm91cC5lcXVhbCA9IGMoImxvYWRpbmdzIiwgImludGVyY2VwdHMiLCAicmVzaWR1YWxzIiksDQogICAgICAgICAgICAgIGdyb3VwLnBhcnRpYWwgPSBwYXJ0aWFsX3N5bnRheFtpXSkNCiAgDQogIENGSV9saXN0W2ldIDwtIGZpdG1lYXN1cmVzKHRlbXAsICJjZmkiKQ0KfQ0KDQoNCiMgbm93IGZpZ3VyZSBvdXQgd2hpY2ggcGFyYW1ldGVycyB0byAiZnJlZSINCm9wdGlvbnMoc2NpcGVuID0gOTk5KQ0Kc29ydChDRklfbGlzdCAtIGZpdG1lYXN1cmVzKE1HLm1vZGVsJGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQuc3RyaWN0LnJlc2lkdWFscywgImNmaSIsIGRlY3JlYXNpbmcgPSBUKSkNCmBgYA0KDQpMZXQncyBmcmVlIHVwIHRob3NlIHBhcmFtZXRlcnMuIFN0YXJ0aW5nIHdpdGggdGhlIG9uZSB0aGF0IGluY3JlYXNlcyBDRkkgdG8gdGhlIGdyZWF0ZXN0IGV4dGVudC4gV2Ugd2lsbCByZS1ydW4gdGhlIHdob2xlIG1vZGVsIGZvciB0aGlzDQoNCmBgYHtyfQ0KTUcubW9kZWxfMiA8LSBlcU1JLm1haW4obW9kZWwgPSBtb3RpdmF0aW9uX21vZGVsLCANCiAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gc21zMTIsIA0KICAgICAgICAgICAgICAgICAgICAgIGdyb3VwID0gIlRpbWVwb2ludCIsICNjb21wYXJpbmcgd2F2ZSAxIGFuZCB3YXZlIDINCiAgICAgICAgICAgICAgICAgICAgICBtZWFuc3RydWN0dXJlID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICBncm91cC5wYXJ0aWFsID0gYygiTTFfNn5+TTFfNiIpLCAjZnJlZSB0aGlzIHBhcmFtZXRlcg0KICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9ICJib3RoIiwgI21lYW4sIGNvdmFyaWFuY2UsIGJvdGgNCiAgICAgICAgICAgICAgICAgICAgICBlcXVpdmFsZW5jZS50ZXN0ID0gRkFMU0UsIA0KICAgICAgICAgICAgICAgICAgICAgIGFkalJNU0VBID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uID0gVFJVRSwgDQogICAgICAgICAgICAgICAgICAgICAgYm9vdHN0cmFwID0gRkFMU0UsDQogICAgICAgICAgICAgICAgICAgICAgcXVpZXQgPSBUUlVFKQ0KDQojIGNoZWNrIHN1bW1hcnkgdG8gc2VlIGlmIHRoZSBlcXVhbGl0eSBjb25zdHJhaW50IGlzIGdvbmUuDQojIHN1bW1hcnkoTUcubW9kZWxfMiRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LnN0cmljdC5yZXNpZHVhbHMsDQojICAgICAgICBzdGFuZGFyZGl6ZWQgPSBUUlVFLCByc3F1YXJlID0gVFJVRSwgZml0Lm1lYXN1cmUgPSBUUlVFKQ0KDQoNCnRhYmxlX2ZpdFs4LCBdIDwtIGMoIlN0cmljdCBNb2RlbCBNMV82Iiwgcm91bmQoZml0bWVhc3VyZXMoTUcubW9kZWxfMiRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LnN0cmljdC5yZXNpZHVhbHMsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKQ0KDQppbnB1dCA8LSB0YWJsZV9maXRbMTo4LCBdIA0Ka25pdHI6OmthYmxlKGlucHV0LCBkaWdpdHM9MiwgImh0bWwiLCBjYXB0aW9uPSIiKSAlPiUgDQogIGthYmxlRXh0cmE6OmthYmxlX3N0eWxpbmcoYm9vdHN0cmFwX29wdGlvbnMgPSBjKCJzdHJpcGVkIiwgImhvdmVyIikpDQpgYGANCg0KQ0ZJIGltcHJvdmVkLCBidXQgdGhlIGRpZmZlcmVuY2Ugd2l0aCB0aGUgYmFzZWxpbmUgc2NhbGFyIG1vZGVsIGlzIHN0aWxsIGdyZWF0ZXIgdGhhbiAuMDEuIFRodXMsIHdlIHN0aWxsIG5lZWQgdG8gZnJlZSAoYXQgbGVhc3QpIG9uZSBtb3JlLCB0byBhY2hpZXZlICJwYXJ0aWFsIiBpbnZhcmlhbmNlLiANCg0KYGBge3J9DQpNRy5tb2RlbF8zIDwtIGVxTUkubWFpbihtb2RlbCA9IG1vdGl2YXRpb25fbW9kZWwsIA0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHNtczEyLCANCiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwID0gIlRpbWVwb2ludCIsICNjb21wYXJpbmcgd2F2ZSAxIGFuZCB3YXZlIDINCiAgICAgICAgICAgICAgICAgICAgICAgIG1lYW5zdHJ1Y3R1cmUgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGFydGlhbCA9IGMoIk0xXzZ+fk0xXzYiLCAiTTFfN35+TTFfNyIpLCAjZnJlZSB0aGVzZSBwYXJhbWV0ZXJzDQogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSAiYm90aCIsICNtZWFuLCBjb3ZhcmlhbmNlLCBib3RoDQogICAgICAgICAgICAgICAgICAgICAgICBlcXVpdmFsZW5jZS50ZXN0ID0gRkFMU0UsIA0KICAgICAgICAgICAgICAgICAgICAgICAgYWRqUk1TRUEgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbiA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgYm9vdHN0cmFwID0gRkFMU0UsDQogICAgICAgICAgICAgICAgICAgICAgICBxdWlldCA9IFRSVUUpDQoNCnRhYmxlX2ZpdFs5LCBdIDwtIGMoIlN0cmljdCBNb2RlbCBNMV82ICsgTTFfNyIsIHJvdW5kKGZpdG1lYXN1cmVzKE1HLm1vZGVsXzMkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5zdHJpY3QucmVzaWR1YWxzLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6OSwgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCg0KIyMjIyBDb21wYXJpbmcgV2F2ZSAyIGFuZCBXYXZlIDMNCg0KYGBge3J9DQpsaWJyYXJ5KGVxdWFsdGVzdE1JKSAjaW5zdGFsbCBwYWNrYWdlDQoNCiMgZXN0aW1hdGUgdGhlIG11bHRpLWdyb3VwIG1vZGVsDQpNRy5tb2RlbCA8LSBlcU1JLm1haW4obW9kZWwgPSBtb3RpdmF0aW9uX21vZGVsLCANCiAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gc21zMjMsIA0KICAgICAgICAgICAgICAgICAgICAgIGdyb3VwID0gIlRpbWVwb2ludCIsICNjb21wYXJpbmcgd2F2ZSAyIGFuZCB3YXZlIDMNCiAgICAgICAgICAgICAgICAgICAgICBtZWFuc3RydWN0dXJlID0gVFJVRSwgI2luY2x1ZGUgdGhlIG1lYW5zDQogICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gImJvdGgiLCAjbWVhbnMsIGNvdmFyaWFuY2UsIGJvdGgNCiAgICAgICAgICAgICAgICAgICAgICBlcXVpdmFsZW5jZS50ZXN0ID0gRkFMU0UsIA0KICAgICAgICAgICAgICAgICAgICAgIGFkalJNU0VBID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0aW9uID0gVFJVRSwgI3Rlc3QgZXF1YWxpdHkgb2YgbGF0ZW50IGZhY3RvciBtZWFucyAoZXZlbiB3aGVuIGVxdWFsaXR5IG9mIGludGVyY2VwdHMgZG9lcyBub3QgaG9sZCkNCiAgICAgICAgICAgICAgICAgICAgICBib290c3RyYXAgPSBGQUxTRSwNCiAgICAgICAgICAgICAgICAgICAgICBxdWlldCA9IFRSVUUpDQpgYGANCg0KTm93IHdlIHdpbGwgc3VtbWFyaXplIHRoZSByZXN1bHRzIG9mIHRoZSBtdWx0aS1ncm91cCBtb2RlbCwgYW5kIGFkZCB0aGVtIHRvIG91ciBwcmV2aW91c2x5IG1hZGUga2FibGUtdGFibGUuDQoNCmBgYHtyfQ0KdGFibGVfZml0WzIsIF0gPC0gYygiVzIgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LmNvbmZpZ3VyYWwuZzEsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKSAjIGdyb3VwIDE6IFdhdmUgMg0KdGFibGVfZml0WzMsIF0gPC0gYygiVzMgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LmNvbmZpZ3VyYWwuZzIsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKSAjIGdyb3VwIDI6IFdhdmUgMw0KDQpgYGANCg0KQW5kIHRvIHRlc3QgZm9yIGNvbmZpZ3VyYWwgaW52YXJpYW5jZSAtIGlzIHRoZSAncGljdHVyZScvc3RydWN0dXJlIG9mIHRoZSBtb2RlbCB0aGUgc2FtZSBmb3IgYm90aCBncm91cHMgKGkuZS4gd2F2ZXMpLCB3ZSBzdGFjayB0aGUgZ3JvdXBzIHRvZ2V0aGVyLg0KDQpgYGB7cn0NCmxpYnJhcnkoa25pdHIpDQpsaWJyYXJ5KGthYmxlRXh0cmEpDQpsaWJyYXJ5KGRwbHlyKQ0KbGlicmFyeSh0aWR5cikNCg0KdGFibGVfZml0WzQsIF0gPC0gYygiQ29uZmlndXJhbCBNb2RlbCIsIHJvdW5kKGZpdG1lYXN1cmVzKE1HLm1vZGVsJGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQuY29tYmluZS5ncm91cHMsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKQ0KDQppbnB1dCA8LSB0YWJsZV9maXRbMTo0LCBdIA0Ka25pdHI6OmthYmxlKGlucHV0LCBkaWdpdHM9MiwgImh0bWwiLCBjYXB0aW9uPSIiKSAlPiUgDQogIGthYmxlRXh0cmE6OmthYmxlX3N0eWxpbmcoYm9vdHN0cmFwX29wdGlvbnMgPSBjKCJzdHJpcGVkIiwgImhvdmVyIikpDQpgYGANCg0KVGhpcyBpcyB0aGUgbW9kZWwgYWdhaW5zdCB3aGljaCB3ZSB3aWxsIHRlc3QgdGhlIG5leHQgbW9kZWwuIFNvLCB3ZSB3aWxsIGNvbmR1Y3QgYSBzZXF1ZW50aWFsIHRlc3RpbmcgYW5hbHlzaXMuIE5leHQsIHdlIHdpbGwgYXNzZXNzIG1ldHJpYyBpbnZhcmlhbmNlLCBieSBjb25zdHJhaW5pbmcgdGhlIGZhY3RvciBsb2FkaW5ncyB0byBiZSBlcXVhbCBhY3Jvc3MgdGhlIHdhdmVzLiBJbiB0aGUgY29uZmlndXJhbCBtb2RlbCwgZmFjdG9yIGxvYWRpbmdzIHdlcmUgImZyZWVseSIgZXN0aW1hdGVkIGluIGJvdGggd2F2ZXM7IG5vdywgb25seSAxIGxvYWRpbmcgZ2V0cyBlc3RpbWF0ZWQgZm9yIGJvdGggZ3JvdXBzLiBMZXQncyBzZWUgd2hhdCBoYXBwZW5zIHRvIHRoZSBtb2RlbC4gDQoNCmBgYHtyfQ0KdGFibGVfZml0WzUsIF0gPC0gYygiTWV0cmljIE1vZGVsIiwgcm91bmQoZml0bWVhc3VyZXMoTUcubW9kZWwkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5tZXRyaWMsIGMoImNoaXNxIiwgImRmIiwgImNmaSIsICJybXNlYSIsICJzcm1yIikpLDMpKQ0KDQppbnB1dCA8LSB0YWJsZV9maXRbMTo1LCBdIA0Ka25pdHI6OmthYmxlKGlucHV0LCBkaWdpdHM9MiwgImh0bWwiLCBjYXB0aW9uPSIiKSAlPiUgDQogIGthYmxlRXh0cmE6OmthYmxlX3N0eWxpbmcoYm9vdHN0cmFwX29wdGlvbnMgPSBjKCJzdHJpcGVkIiwgImhvdmVyIikpDQpgYGANCg0KVGhlIG1ldHJpYyBtb2RlbCBzZWVtcyB0byBiZSBpbnZhcmlhbnQgaW4gY29tcGFyaXNvbiB0byB0aGUgY29uZmlndXJhbCBtb2RlbDogdGhlIENGSSBkaWZmZXJlbmNlIGlzIHNtYWxsZXIgdGhhbiAuMDEsIGhlbmNlIGFzc3VtaW5nIGludmFyaWFuY2UgKHNhbWUgaG9sZHMgZm9yIFJNU0VBL1NSTVIpLiBDb25jbHVzaW9uOiB0aGUgbWV0cmljIG1vZGVsIGhvbGRzOiB0aGUgbG9hZGluZ3MgYXJlIGVxdWFsIChvciBjbG9zZSBlbm91Z2gpLiANCg0KPGJyPg0KDQpXZSBoYXZlIGNvbnN0cmFpbmVkIG91ciBtb2RlbCB0byBjb250YWluIHRoZSBzYW1lIHN0cnVjdHVyZSwgdGhlIHNhbWUgbG9hZGluZ3M7IG5vdyBsZXQncyB0ZXN0IGZvciBzY2FsYXIgaW52YXJpYW5jZSwgdG8gc2VlIGlmIHRoZSBpbnRlcmNlcHRzIGFyZSB0aGUgc2FtZSBhY3Jvc3Mgd2F2ZXMuIA0KDQpgYGB7cn0NCnRhYmxlX2ZpdFs2LCBdIDwtIGMoIlNjYWxhciBNb2RlbCIsIHJvdW5kKGZpdG1lYXN1cmVzKE1HLm1vZGVsJGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQuc2NhbGFyLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6NiwgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNClRoZSBpbnRlcmNlcHRzIGFyZSBlcXVhbCBvbiB0aGUgc2NhbGUgYmV0d2VlbiB0aGUgd2F2ZXMuIA0KDQo8YnI+DQoNCkxhc3QsIHdlIGNvbnN0cmFpbiB0aGUgbW9kZWwgdG8gdGhlIHN0cmljdCBtb2RlbCwgdG8gY2hlY2sgZm9yIHN0cmljdCByZXNpZHVhbCBpbnZhcmlhbmNlLiBJdCB3aWxsIGluZm9ybSB3aGV0aGVyIHRoZSB2YXJpYW5jZSBhcm91bmQgaXRlbXMgaXMgdGhlIHNhbWUgYWNyb3NzIHRpbWUuDQoNCmBgYHtyfQ0KdGFibGVfZml0WzcsIF0gPC0gYygiU3RyaWN0IE1vZGVsIiwgcm91bmQoZml0bWVhc3VyZXMoTUcubW9kZWwkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5zdHJpY3QucmVzaWR1YWxzLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6NywgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCiMjIyMgQ29tcGFyaW5nIFdhdmUgMSBhbmQgV2F2ZSAzDQoNCmBgYHtyfQ0KbGlicmFyeShlcXVhbHRlc3RNSSkgI2luc3RhbGwgcGFja2FnZQ0KDQojIGVzdGltYXRlIHRoZSBtdWx0aS1ncm91cCBtb2RlbA0KTUcubW9kZWwgPC0gZXFNSS5tYWluKG1vZGVsID0gbW90aXZhdGlvbl9tb2RlbCwgDQogICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHNtczEzLCANCiAgICAgICAgICAgICAgICAgICAgICBncm91cCA9ICJUaW1lcG9pbnQiLCAjY29tcGFyaW5nIHdhdmUgMSBhbmQgd2F2ZSAzDQogICAgICAgICAgICAgICAgICAgICAgbWVhbnN0cnVjdHVyZSA9IFRSVUUsICNpbmNsdWRlIHRoZSBtZWFucw0KICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9ICJib3RoIiwgI21lYW5zLCBjb3ZhcmlhbmNlLCBib3RoDQogICAgICAgICAgICAgICAgICAgICAgZXF1aXZhbGVuY2UudGVzdCA9IEZBTFNFLCANCiAgICAgICAgICAgICAgICAgICAgICBhZGpSTVNFQSA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbiA9IFRSVUUsICN0ZXN0IGVxdWFsaXR5IG9mIGxhdGVudCBmYWN0b3IgbWVhbnMgKGV2ZW4gd2hlbiBlcXVhbGl0eSBvZiBpbnRlcmNlcHRzIGRvZXMgbm90IGhvbGQpDQogICAgICAgICAgICAgICAgICAgICAgYm9vdHN0cmFwID0gRkFMU0UsDQogICAgICAgICAgICAgICAgICAgICAgcXVpZXQgPSBUUlVFKQ0KYGBgDQoNCk5vdyB3ZSB3aWxsIHN1bW1hcml6ZSB0aGUgcmVzdWx0cyBvZiB0aGUgbXVsdGktZ3JvdXAgbW9kZWwsIGFuZCBhZGQgdGhlbSB0byBvdXIgcHJldmlvdXNseSBtYWRlIGthYmxlLXRhYmxlLg0KDQpgYGB7cn0NCnRhYmxlX2ZpdFsyLCBdIDwtIGMoIlcxIE1vZGVsIiwgcm91bmQoZml0bWVhc3VyZXMoTUcubW9kZWwkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5jb25maWd1cmFsLmcxLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkgIyBncm91cCAxOiBXYXZlIDENCnRhYmxlX2ZpdFszLCBdIDwtIGMoIlczIE1vZGVsIiwgcm91bmQoZml0bWVhc3VyZXMoTUcubW9kZWwkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5jb25maWd1cmFsLmcyLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkgIyBncm91cCAyOiBXYXZlIDMNCg0KYGBgDQoNCkFuZCB0byB0ZXN0IGZvciBjb25maWd1cmFsIGludmFyaWFuY2UgLSBpcyB0aGUgJ3BpY3R1cmUnL3N0cnVjdHVyZSBvZiB0aGUgbW9kZWwgdGhlIHNhbWUgZm9yIGJvdGggZ3JvdXBzIChpLmUuIHdhdmVzKSwgd2Ugc3RhY2sgdGhlIGdyb3VwcyB0b2dldGhlci4NCg0KYGBge3J9DQpsaWJyYXJ5KGtuaXRyKQ0KbGlicmFyeShrYWJsZUV4dHJhKQ0KbGlicmFyeShkcGx5cikNCmxpYnJhcnkodGlkeXIpDQoNCnRhYmxlX2ZpdFs0LCBdIDwtIGMoIkNvbmZpZ3VyYWwgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LmNvbWJpbmUuZ3JvdXBzLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6NCwgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNClRoaXMgaXMgdGhlIG1vZGVsIGFnYWluc3Qgd2hpY2ggd2Ugd2lsbCB0ZXN0IHRoZSBuZXh0IG1vZGVsLiBTbywgd2Ugd2lsbCBjb25kdWN0IGEgc2VxdWVudGlhbCB0ZXN0aW5nIGFuYWx5c2lzLiBOZXh0LCB3ZSB3aWxsIGFzc2VzcyBtZXRyaWMgaW52YXJpYW5jZSwgYnkgY29uc3RyYWluaW5nIHRoZSBmYWN0b3IgbG9hZGluZ3MgdG8gYmUgZXF1YWwgYWNyb3NzIHRoZSB3YXZlcy4gSW4gdGhlIGNvbmZpZ3VyYWwgbW9kZWwsIGZhY3RvciBsb2FkaW5ncyB3ZXJlICJmcmVlbHkiIGVzdGltYXRlZCBpbiBib3RoIHdhdmVzOyBub3csIG9ubHkgMSBsb2FkaW5nIGdldHMgZXN0aW1hdGVkIGZvciBib3RoIGdyb3Vwcy4gTGV0J3Mgc2VlIHdoYXQgaGFwcGVucyB0byB0aGUgbW9kZWwuIA0KDQpgYGB7cn0NCnRhYmxlX2ZpdFs1LCBdIDwtIGMoIk1ldHJpYyBNb2RlbCIsIHJvdW5kKGZpdG1lYXN1cmVzKE1HLm1vZGVsJGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQubWV0cmljLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6NSwgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNClRoZSBtZXRyaWMgbW9kZWwgc2VlbXMgdG8gYmUgaW52YXJpYW50IGluIGNvbXBhcmlzb24gdG8gdGhlIGNvbmZpZ3VyYWwgbW9kZWw6IHRoZSBDRkkgZGlmZmVyZW5jZSBpcyBzbWFsbGVyIHRoYW4gLjAxLCBoZW5jZSBhc3N1bWluZyBpbnZhcmlhbmNlIChzYW1lIGhvbGRzIGZvciBSTVNFQS9TUk1SKS4gQ29uY2x1c2lvbjogdGhlIG1ldHJpYyBtb2RlbCBob2xkczogdGhlIGxvYWRpbmdzIGFyZSBlcXVhbCAob3IgY2xvc2UgZW5vdWdoKS4gDQoNCjxicj4NCg0KV2UgaGF2ZSBjb25zdHJhaW5lZCBvdXIgbW9kZWwgdG8gY29udGFpbiB0aGUgc2FtZSBzdHJ1Y3R1cmUsIHRoZSBzYW1lIGxvYWRpbmdzOyBub3cgbGV0J3MgdGVzdCBmb3Igc2NhbGFyIGludmFyaWFuY2UsIHRvIHNlZSBpZiB0aGUgaW50ZXJjZXB0cyBhcmUgdGhlIHNhbWUgYWNyb3NzIHdhdmVzLiANCg0KYGBge3J9DQp0YWJsZV9maXRbNiwgXSA8LSBjKCJTY2FsYXIgTW9kZWwiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LnNjYWxhciwgYygiY2hpc3EiLCAiZGYiLCAiY2ZpIiwgInJtc2VhIiwgInNybXIiKSksMykpDQoNCmlucHV0IDwtIHRhYmxlX2ZpdFsxOjYsIF0gDQprbml0cjo6a2FibGUoaW5wdXQsIGRpZ2l0cz0yLCAiaHRtbCIsIGNhcHRpb249IiIpICU+JSANCiAga2FibGVFeHRyYTo6a2FibGVfc3R5bGluZyhib290c3RyYXBfb3B0aW9ucyA9IGMoInN0cmlwZWQiLCAiaG92ZXIiKSkNCmBgYA0KDQoNClRoZSBpbnRlcmNlcHRzIGFyZSBlcXVhbCBvbiB0aGUgc2NhbGUgYmV0d2VlbiB0aGUgd2F2ZXMuIA0KDQo8YnI+DQoNCkxhc3QsIHdlIGNvbnN0cmFpbiB0aGUgbW9kZWwgdG8gdGhlIHN0cmljdCBtb2RlbCwgdG8gY2hlY2sgZm9yIHN0cmljdCByZXNpZHVhbCBpbnZhcmlhbmNlLiBJdCB3aWxsIGluZm9ybSB3aGV0aGVyIHRoZSB2YXJpYW5jZSBhcm91bmQgaXRlbXMgaXMgdGhlIHNhbWUgYWNyb3NzIHRpbWUuDQoNCmBgYHtyfQ0KdGFibGVfZml0WzcsIF0gPC0gYygiU3RyaWN0IE1vZGVsIiwgcm91bmQoZml0bWVhc3VyZXMoTUcubW9kZWwkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5zdHJpY3QucmVzaWR1YWxzLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6NywgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCkZyb20gaGVyZSBpdCBnb2VzIGRvd253YXJkcy4uLiBDRkkgZHJvcHBlZCBtb3JlIHRoYW4gMC4wMSwgc3VnZ2VzdGluZyB0aGF0IHRoZSByZXNpZHVhbHMgdmFyeSBiZXR3ZWVuIHRoZSB3YXZlcy4gV2UgY291bGQgZXN0aW1hdGUgcGFydGlhbCBpbnZhcmlhbmNlLCB0byBpbnZlc3RpZ2F0ZSB3aGVyZSB0aGUgcHJvYmxlbSBpcyBhbmQgc3Vic2VxdWVudGx5IHVwZGF0ZSB0aGUgbW9kZWwgdG8gZml4IGl0LiBXZSBhcmUgZ29pbmcgdG8gZG8gc28gYnkgZnJlZWluZyB0aGUgdmFyaWFuY2VzIG9mIGl0ZW0gcmVzaWR1YWxzLCBvbmUgYXQgYSB0aW1lLCB0byBmaWd1cmUgb3V0IHdoaWNoIGVxdWFsaXR5IGNvbnN0YWludChzKSBpcy9hcmUgY2F1c2luZyB0aGUgcHJvYmxlbS4gV2Ugd2lsbCB1c2UgdGhlIGZvbGxvd2luZyBsb29wIGZvciB0aGlzLiANCg0KYGBge3J9DQojIHdyaXRlIG91dCBwYXJ0aWFsIGNvZGVzDQpwYXJ0aWFsX3N5bnRheCA8LSBwYXN0ZShjb2xuYW1lcyhzbXMxMilbMzoyNl0sICNhbGwgc21zIGNvbHVtbnMNCiAgICAgICAgICAgICAgICAgICAgICAgICJ+fiIsICNyZXNpZHVhbHMNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG5hbWVzKHNtczEyKVszOjI2XSkgI2FsbCBjb2x1bW5zIGFnYWluDQoNCkNGSV9saXN0IDwtIDE6bGVuZ3RoKHBhcnRpYWxfc3ludGF4KQ0KbmFtZXMoQ0ZJX2xpc3QpIDwtIHBhcnRpYWxfc3ludGF4IA0KDQpmb3IgKGkgaW4gMTpsZW5ndGgocGFydGlhbF9zeW50YXgpKXsNCiAgDQogIHRlbXAgPC0gY2ZhKG1vZGVsID0gbW90aXZhdGlvbl9tb2RlbCwNCiAgICAgICAgICAgICAgZGF0YSA9IHNtczEzLA0KICAgICAgICAgICAgICBtZWFuc3RydWN0dXJlID0gVFJVRSwNCiAgICAgICAgICAgICAgZ3JvdXAgPSAiVGltZXBvaW50IiwNCiAgICAgICAgICAgICAgZ3JvdXAuZXF1YWwgPSBjKCJsb2FkaW5ncyIsICJpbnRlcmNlcHRzIiwgInJlc2lkdWFscyIpLA0KICAgICAgICAgICAgICBncm91cC5wYXJ0aWFsID0gcGFydGlhbF9zeW50YXhbaV0pDQogIA0KICBDRklfbGlzdFtpXSA8LSBmaXRtZWFzdXJlcyh0ZW1wLCAiY2ZpIikNCn0NCg0KDQojIG5vdyBmaWd1cmUgb3V0IHdoaWNoIHBhcmFtZXRlcnMgdG8gImZyZWUiDQpvcHRpb25zKHNjaXBlbiA9IDk5OSkNCnNvcnQoQ0ZJX2xpc3QgLSBmaXRtZWFzdXJlcyhNRy5tb2RlbCRjb252ZW50aW9uLnNlbSRMYXZhYW5PdXQkZml0LnN0cmljdC5yZXNpZHVhbHMsICJjZmkiLCBkZWNyZWFzaW5nID0gVCkpDQpgYGANCg0KTGV0J3MgZnJlZSB1cCB0aG9zZSBwYXJhbWV0ZXJzLiBTdGFydGluZyB3aXRoIHRoZSBvbmUgdGhhdCBpbmNyZWFzZXMgQ0ZJIHRvIHRoZSBncmVhdGVzdCBleHRlbnQuIFdlIHdpbGwgcmUtcnVuIHRoZSB3aG9sZSBtb2RlbCBmb3IgdGhpcw0KDQpgYGB7cn0NCk1HLm1vZGVsXzIgPC0gZXFNSS5tYWluKG1vZGVsID0gbW90aXZhdGlvbl9tb2RlbCwgDQogICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHNtczEzLCANCiAgICAgICAgICAgICAgICAgICAgICBncm91cCA9ICJUaW1lcG9pbnQiLCAjY29tcGFyaW5nIHdhdmUgMSBhbmQgd2F2ZSAzDQogICAgICAgICAgICAgICAgICAgICAgbWVhbnN0cnVjdHVyZSA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgZ3JvdXAucGFydGlhbCA9IGMoIk0xXzd+fk0xXzciKSwgI2ZyZWUgdGhpcyBwYXJhbWV0ZXINCiAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSAiYm90aCIsICNtZWFuLCBjb3ZhcmlhbmNlLCBib3RoDQogICAgICAgICAgICAgICAgICAgICAgZXF1aXZhbGVuY2UudGVzdCA9IEZBTFNFLCANCiAgICAgICAgICAgICAgICAgICAgICBhZGpSTVNFQSA9IFRSVUUsDQogICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbiA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgIGJvb3RzdHJhcCA9IEZBTFNFLA0KICAgICAgICAgICAgICAgICAgICAgIHF1aWV0ID0gVFJVRSkNCg0KIyBjaGVjayBzdW1tYXJ5IHRvIHNlZSBpZiB0aGUgZXF1YWxpdHkgY29uc3RyYWludCBpcyBnb25lLg0KIyBzdW1tYXJ5KE1HLm1vZGVsXzIkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5zdHJpY3QucmVzaWR1YWxzLA0KIyAgICAgICAgc3RhbmRhcmRpemVkID0gVFJVRSwgcnNxdWFyZSA9IFRSVUUsIGZpdC5tZWFzdXJlID0gVFJVRSkNCg0KDQp0YWJsZV9maXRbOCwgXSA8LSBjKCJTdHJpY3QgTW9kZWwgTTFfNyIsIHJvdW5kKGZpdG1lYXN1cmVzKE1HLm1vZGVsXzIkY29udmVudGlvbi5zZW0kTGF2YWFuT3V0JGZpdC5zdHJpY3QucmVzaWR1YWxzLCBjKCJjaGlzcSIsICJkZiIsICJjZmkiLCAicm1zZWEiLCAic3JtciIpKSwzKSkNCg0KaW5wdXQgPC0gdGFibGVfZml0WzE6OCwgXSANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCkNGSSBpbXByb3ZlZCwgYnV0IHRoZSBkaWZmZXJlbmNlIHdpdGggdGhlIGJhc2VsaW5lIHNjYWxhciBtb2RlbCBpcyBzdGlsbCBncmVhdGVyIHRoYW4gLjAxLiBUaHVzLCB3ZSBzdGlsbCBuZWVkIHRvIGZyZWUgKGF0IGxlYXN0KSBvbmUgbW9yZSwgdG8gYWNoaWV2ZSAicGFydGlhbCIgaW52YXJpYW5jZS4gDQoNCmBgYHtyfQ0KTUcubW9kZWxfMyA8LSBlcU1JLm1haW4obW9kZWwgPSBtb3RpdmF0aW9uX21vZGVsLCANCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbXMxMywgDQogICAgICAgICAgICAgICAgICAgICAgICBncm91cCA9ICJUaW1lcG9pbnQiLCAjY29tcGFyaW5nIHdhdmUgMSBhbmQgd2F2ZSAzDQogICAgICAgICAgICAgICAgICAgICAgICBtZWFuc3RydWN0dXJlID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhcnRpYWwgPSBjKCJNMV83fn5NMV83IiwgIk0zXzV+fk0zXzUiKSwgI2ZyZWUgdGhlc2UgcGFyYW1ldGVycw0KICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gImJvdGgiLCAjbWVhbiwgY292YXJpYW5jZSwgYm90aA0KICAgICAgICAgICAgICAgICAgICAgICAgZXF1aXZhbGVuY2UudGVzdCA9IEZBTFNFLCANCiAgICAgICAgICAgICAgICAgICAgICAgIGFkalJNU0VBID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3Rpb24gPSBUUlVFLCANCiAgICAgICAgICAgICAgICAgICAgICAgIGJvb3RzdHJhcCA9IEZBTFNFLA0KICAgICAgICAgICAgICAgICAgICAgICAgcXVpZXQgPSBUUlVFKQ0KDQp0YWJsZV9maXRbOSwgXSA8LSBjKCJTdHJpY3QgTW9kZWwgTTFfNyArIE0zXzUiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbF8zJGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQuc3RyaWN0LnJlc2lkdWFscywgYygiY2hpc3EiLCAiZGYiLCAiY2ZpIiwgInJtc2VhIiwgInNybXIiKSksMykpDQoNCmlucHV0IDwtIHRhYmxlX2ZpdCANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCkRpdHRvDQoNCmBgYHtyfQ0KTUcubW9kZWxfNCA8LSBlcU1JLm1haW4obW9kZWwgPSBtb3RpdmF0aW9uX21vZGVsLCANCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBzbXMxMywgDQogICAgICAgICAgICAgICAgICAgICAgICBncm91cCA9ICJUaW1lcG9pbnQiLCAjY29tcGFyaW5nIHdhdmUgMSBhbmQgd2F2ZSAzDQogICAgICAgICAgICAgICAgICAgICAgICBtZWFuc3RydWN0dXJlID0gVFJVRSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLnBhcnRpYWwgPSBjKCJNMV83fn5NMV83IiwgIk0zXzV+fk0zXzUiLCAiTTFfNX5+TTFfNSIpLCAjZnJlZSB0aGVzZSBwYXJhbWV0ZXJzDQogICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSAiYm90aCIsICNtZWFuLCBjb3ZhcmlhbmNlLCBib3RoDQogICAgICAgICAgICAgICAgICAgICAgICBlcXVpdmFsZW5jZS50ZXN0ID0gRkFMU0UsIA0KICAgICAgICAgICAgICAgICAgICAgICAgYWRqUk1TRUEgPSBUUlVFLA0KICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdGlvbiA9IFRSVUUsIA0KICAgICAgICAgICAgICAgICAgICAgICAgYm9vdHN0cmFwID0gRkFMU0UsDQogICAgICAgICAgICAgICAgICAgICAgICBxdWlldCA9IFRSVUUpDQoNCnRhYmxlX2ZpdFs5LCBdIDwtIGMoIlN0cmljdCBNb2RlbCBNMV83ICsgTTNfNSArIE0xXzUiLCByb3VuZChmaXRtZWFzdXJlcyhNRy5tb2RlbF80JGNvbnZlbnRpb24uc2VtJExhdmFhbk91dCRmaXQuc3RyaWN0LnJlc2lkdWFscywgYygiY2hpc3EiLCAiZGYiLCAiY2ZpIiwgInJtc2VhIiwgInNybXIiKSksMykpDQoNCmlucHV0IDwtIHRhYmxlX2ZpdCANCmtuaXRyOjprYWJsZShpbnB1dCwgZGlnaXRzPTIsICJodG1sIiwgY2FwdGlvbj0iIikgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCg0KDQo8YnI+DQoNCiMjIyBDb25jbHVzaW9uDQoNCldlIGNhbiBjb25jbHVkZSB0aGF0IHRoZSBTTVMgaXMgbW9zdGx5IGludmFyaWFudCAtIHRoZSBzdHJ1Y3R1cmUsIGZhY3RvciBsb2FkaW5ncywgaW50ZXJjZXB0cywgYW5kIG1vc3Qgb2YgdGhlIGVycm9yIHZhcmlhbmNlcyB3ZXJlIGVxdWFsIGFjcm9zcyB0aW1lLg0KDQo8YnI+DQoNCiMjIyBXZWlnaHRlZCBmYWN0b3Itc2NvcmVzDQpOb3cgd2UgdXNlIHRoZSBpbnZhcmlhbnQgbWVhc3VyZW1lbnQgbW9kZWwgdG8gZ2VuZXJhdGUgKHdlaWdodGVkKSBmYWN0b3Igc2NvcmVzIGFzIGlucHV0IHZhcmlhYmxlcyBmb3IgdGhlIHN1YnNlcXVlbnQgTFBBLiBXZWlnaHRlZCBmYWN0b3Igc2NvcmVzIGFyZSBjb21wdXRlZCBieSBtdWx0aXBseWluZyB0aGUgZmFjdG9yIGxvYWRpbmcgb2YgZWFjaCBpdGVtIHRvIHRoZSBzY2FsZWQgc2NvcmUgZm9yIGVhY2ggaXRlbSBiZWZvcmUgc3VtbWluZyAoc2VlIFtEaVN0ZWZhbm8gZXQgYWwuICgyMDA5KV0oaHR0cHM6Ly9zY2hvbGFyd29ya3MudW1hc3MuZWR1L2NnaS92aWV3Y29udGVudC5jZ2k/YXJ0aWNsZT0xMjI2JmNvbnRleHQ9cGFyZSkpLiANCg0KV2Ugd2lsbCBmaXJzdCBmaXQgdGhlIENGQSwgZml4aW5nIHRoZSBsb2FkaW5nIG9mIHRoZSBmaXJzdCB2YXJpYWJsZSBvZiBlYWNoIHZhcmlhYmxlIHRvIDEuIFRoZW4gd2Ugd2lsbCBleHRyYWN0IHRoZSBsb2FkaW5ncywgYW5kIGNhbGN1bGF0ZSB0aGUgd2VpZ2h0ZWQgc3VtIHNjb3Jlcy4gDQoNCioqTm90ZSoqOiB3ZSBub3cgYXNzdW1lZCBzdHJpY3QgbWVhc3VyZW1lbnQgaW52YXJpYW5jZSAoaW5zdGVhZCBvZiBzdHJvbmcpLCBzbyB3ZSBtYXkgd2FudCB0byBmcmVlIHNvbWUgcGFyYW1ldGVycy4uLg0KDQpgYGB7cn0NCmZpdCA8LSBjZmEobW9kZWwgPSBtb3RpdmF0aW9uX21vZGVsLCBkYXRhID0gc21zX2xvbmdfbm0sDQogICAgICAgICAgIHN0ZC5sdiA9IEZBTFNFKSAjIGRlZmF1bHQ6IG5vdCBzdGFuZGFyZGl6ZWQgYnV0IGZpeGluZyB0aGUgZmlyc3QgbG9hZGluZyBvbiBlYWNoIGxhdGVudCB2YXJpYWJsZSB0byAxLg0KIA0KbG9hZGluZyA8LSBwYXJhbWV0ZXJFc3RpbWF0ZXMoZml0KSRlc3RbMToyNF0gIyBleHRyYWN0IGZhY3RvciBsb2FkaW5ncw0KDQojIGNhbGN1bGF0ZSB3ZWlnaHRlZCBzdW0gc2NvcmVzDQpzbXNfbG9uZ19ubSRhbW90aXZhdGlvbiA8LSByb3dNZWFucyhjYmluZCgoc21zX2xvbmdfbm0kTTFfNSpsb2FkaW5nWzFdKSwgKHNtc19sb25nX25tJE0yXzQqbG9hZGluZ1syXSksIChzbXNfbG9uZ19ubSRNM18xKmxvYWRpbmdbM10pLCAoc21zX2xvbmdfbm0kTTNfNipsb2FkaW5nWzRdKSkpDQoNCnNtc19sb25nX25tJGV4dGVybmFsIDwtIHJvd01lYW5zKGNiaW5kKChzbXNfbG9uZ19ubSRNMV80KmxvYWRpbmdbNV0pLCAoc21zX2xvbmdfbm0kTTJfMypsb2FkaW5nWzZdKSwgKHNtc19sb25nX25tJE0zXzMqbG9hZGluZ1s3XSksICAgKHNtc19sb25nX25tJE0zXzgqbG9hZGluZ1s4XSkpKQ0KDQpzbXNfbG9uZ19ubSRpbnRyb2plY3RlZCA8LSByb3dNZWFucyhjYmluZCgoc21zX2xvbmdfbm0kTTFfNypsb2FkaW5nWzldKSwgKHNtc19sb25nX25tJE0yXzIqbG9hZGluZ1sxMF0pLCAoc21zX2xvbmdfbm0kTTJfOCpsb2FkaW5nWzExXSksIChzbXNfbG9uZ19ubSRNM183KmxvYWRpbmdbMTJdKSkpDQoNCnNtc19sb25nX25tJGlkZW50aWZpZWQgPC0gcm93TWVhbnMoY2JpbmQoKHNtc19sb25nX25tJE0xXzMqbG9hZGluZ1sxM10pLCAoc21zX2xvbmdfbm0kTTFfOCpsb2FkaW5nWzE0XSksIChzbXNfbG9uZ19ubSRNMl83KmxvYWRpbmdbMTVdKSwgKHNtc19sb25nX25tJE0zXzQqbG9hZGluZ1sxNl0pKSkNCg0Kc21zX2xvbmdfbm0kaW50ZWdyYXRlZCA8LSByb3dNZWFucyhjYmluZCgoc21zX2xvbmdfbm0kTTFfMipsb2FkaW5nWzE3XSksIChzbXNfbG9uZ19ubSRNMl8xKmxvYWRpbmdbMThdKSwgKHNtc19sb25nX25tJE0yXzUqbG9hZGluZ1sxOV0pLCAoc21zX2xvbmdfbm0kTTNfNSpsb2FkaW5nWzIwXSkpKQ0KDQpzbXNfbG9uZ19ubSRpbnRyaW5zaWMgPC0gcm93TWVhbnMoY2JpbmQoKHNtc19sb25nX25tJE0xXzEqbG9hZGluZ1syMV0pLCAoc21zX2xvbmdfbm0kTTFfNipsb2FkaW5nWzIyXSksIChzbXNfbG9uZ19ubSRNMl82KmxvYWRpbmdbMjNdKSwgKHNtc19sb25nX25tJE0zXzIqbG9hZGluZ1syNF0pKSkNCmBgYA0KDQo8YnI+DQoNCi0tLS0NCg0KIyMgMy4gRGVzY3JpcHRpdmVzDQoNCkxldCdzIGRlc2NyaWJlIG91ciB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzIG92ZXIgdGltZS4gDQoNCmBgYHtyfQ0KbGlicmFyeShjcm9zc3RhYmxlKQ0KDQppbnB1dCA8LSBzbXNfbG9uZ19ubSAlPiUgI2dldCBmYWN0b3Igc2NvcmVzIGFuZCB0aW1lcG9pbnQgYXMgZ3JvdXBpbmcgdmFyaWFibGUNCiAgc2VsZWN0KDI3OjMyLCAyKQ0KDQpjcm9zc3RhYmxlKGlucHV0LCBieT1UaW1lcG9pbnQsDQogICAgICAgICAgIGZ1bnM9YygiTWVhbiIgPSBtZWFuLCAiU3RkLiBkZXYuIiA9IHNkLCAiTWluIiA9IG1pbiwgIk1heCIgPSBtYXgpLCBmdW5zX2FyZz1saXN0KGRpZ2l0cz0zKSkgJT4lDQogIGFzX2ZsZXh0YWJsZShieV9oZWFkZXIgPSAiV2F2ZSIpDQpgYGANCg0KQW5kIGxldCdzIHNlZSBob3cgbWFueSByZXNwb25kZW50cyB3ZSBoYXZlIGluIGVhY2ggd2F2ZSAoKipub3RlLXRvLXNlbGYqKjogaW50ZWdyYXRlIGluIHByZXZpb3VzIHRhYmxlLi4uKS4NCg0KYGBge3J9DQprbml0cjo6a2FibGUodGFibGUoc21zX2xvbmdfbm0kVGltZXBvaW50KSwgImh0bWwiLCBjYXB0aW9uPSJOdW1iZXIgb2YgcmVzcG9uZGVudHMgaW4gZWFjaCB3YXZlIiwgY29sLm5hbWVzID0gYygiV2F2ZSIsICJOIiksIGFsaWduID0gJ2wnICkgJT4lIA0KICBrYWJsZUV4dHJhOjprYWJsZV9zdHlsaW5nKGJvb3RzdHJhcF9vcHRpb25zID0gYygic3RyaXBlZCIsICJob3ZlciIpKQ0KYGBgDQoNCkF0IGZhY2UgdmFsdWUsIHJlc3BvbmRlbnRzIHNlZW0gdG8gYmUgcHJldHR5IGhpZ2ggaW4gYWxsIHR5cGVzIG9mIG1vdGl2YXRpb24gKGUuZy4sIGNvbXBhcmVkIHdpdGggdGhlIHNhbXBsZSBvZiBbRW1tLUNvbGxpc29uIGFuZCBjb2xsZWFndWVzXShodHRwczovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MxNDY5MDI5MjE5MzAzODUxKSAtIHRob3VnaCB0aGVzZSB3ZXJlIHN1bSBzY29yZXMpLg0KDQoNCjxicj4NCg0KLS0tLQ0KDQojIExQQSAgDQoNCiMjIFN0ZXAgMSANCg0KIyMjIHsudGFic2V0IC50YWJzZXQtZmFkZX0NCg0KQXMgYSBmaXJzdCBzdGVwIGZvciB0aGUgTFBBLCB3ZSBjYXJlZnVsbHkgc2VsZWN0IGEgbWVhc3VyZW1lbnQgbW9kZWwgdGhhdCBhY2N1cmF0ZWx5IGNhcHR1cmVzIHRoZSBjb25zdHJ1Y3Qgb2YgbW90aXZhdGlvbmFsIHByb2ZpbGUuIFdlIHdpbGwgZml0IGEgc2VyaWVzIG9mIG1lYXN1cmVtZW50IG1vZGVscyBmb3IgZWFjaCB3YXZlIHRvIGRldGVybWluZSB3aGljaCBtb2RlbCBwcm92aWRlcyB0aGUgYmVzdCBmaXQgYXQgZWFjaCB3YXZlIChmb2xsb3dpbmcgcmVjb21tZW5kYXRpb25zIG9mIFtOeWx1bmQgZXQgYWwuICgyMDA3KV0oaHR0cHM6Ly9zcmNkLm9ubGluZWxpYnJhcnkud2lsZXkuY29tL2RvaS9mdWxsLzEwLjExMTEvai4xNDY3LTg2MjQuMjAwNy4wMTA5Ny54P2Nhc2FfdG9rZW49MHd5empoOU96azBBQUFBQTppYXNnVFlpZF9nSjVrR0g0Mkp5eXM2MURzQmhFRGwwenhWcnVrb0pkYWVYMmUyTUdPbG0xbmZ5b29FVWMxdjVTYUIzbEZZeVgxd3FWTEdOT3ZRKSBhbmQgc2ltaWxhciB0byB0aGUgYXJ0aWNsZSBieSBbTWFydGluZW50ICYgRGVjcmV0ICgyMDE1KV0oaHR0cHM6Ly93d3cudGFuZGZvbmxpbmUuY29tL2RvaS9wZGYvMTAuMTA4MC8xMDQxMzIwMC4yMDE0Ljk5MzQ4NT9jYXNhX3Rva2VuPUNzQmdmRzlsYnRnQUFBQUE6Q01FWHhjOTZ4TkMtckY2U293aTdYMlgwcXZYbHhJOU11T0RXdFExRGI5MlV5WlVlTFpjV0plbTFqaGh5bXBiaThkQmJveXJBMjgyQTVOcykpLg0KDQo8YnI+DQoNCiMjIyMgV2F2ZSAxDQoNCldlIHN0YXJ0IGJ5IHN1YnNldHRpbmcgdGhlIGRhdGEgZm9yIHRoZSByZXNwZWN0aXZlIHdhdmVzLCBhbmQgc3RhbmRhcmRpemluZyB0aGUgaW5kaWNhdG9ycyB0byB6LXNjb3JlcywgbWVhbmluZyB0aGF0IHJlc3VsdGluZyBwcm9maWxlIG1lYW5zIHJlZmxlY3Qgc3RhbmRhcmQgZGV2aWF0aW9uIChTRCkgdW5pdHMgYWJvdmUgb3IgYmVsb3cgdGhlIHNhbXBsZSBtZWFuICh3aGljaCBpcyBzZXQgdG8gMCkuDQoNCmBgYHtyfQ0Kc21zX3cxIDwtIHNtc19sb25nX25tW3Ntc19sb25nX25tJFRpbWVwb2ludD09MSwgXSAlPiUNCiAgc2VsZWN0KC1UaW1lcG9pbnQsIC1pZCkgJT4lICMgc3Vic2V0IFcxDQogIHNlbGVjdCgyNTozMCkgJT4lICMgc3Vic2V0IHdlaWdodGVkIGZhY3RvciBzY29yZXMNCiAgbXV0YXRlX2FsbChsaXN0KHNjYWxlKSkgIyBzdGFuZGFyZGl6ZSBpbmRpY2F0b3JzDQpgYGANCg0KV2UgdGhlbiBjb21wdXRlIHRoZSBtb2RlbC1iYXNlZCBjbHVzdGVyaW5nLCBhbmQgYXNrIGZvciBhIHN1bW1hcnkuDQpgYGB7cn0NCmxpYnJhcnkobWNsdXN0KQ0KbWMgPC0gTWNsdXN0KHNtc193MSkNCnN1bW1hcnkobWMpICAgICAgICAgICAgICAgICANCmBgYA0KDQpGb3IgdGhpcyB3YXZlLCBNY2x1c3Qgc2VsZWN0ZWQgYSBtb2RlbCB3aXRoIDkgKCEpIHByb2ZpbGVzOyB0aGUgb3B0aW1hbCBzZWxlY3RlZCBtb2RlbCBpcyBFRVYsIGkuZS4sIHRoZSBwcm9maWxlcyBhcmUgZWxsaXBzb2lkYWwgd2l0aCBlcXVhbCB2b2x1bWUsIHNoYXBlIGFuZCB2YXJ5aW5nIG9yaWVudGF0aW9uIChzZWUgW3RoaXMgYXJ0aWNsZV0oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNTA5NjczNi8pKS4gSG93ZXZlciwgbm90ZSB0aGF0IFZFViwgOSBpcyBvbmx5IHNsaWdodGx5IGJlaGluZCwgYW5kIHRoYXQgZm9yIGFsbCBzb2x1dGlvbnMgd2l0aCBmZXdlciBjbHVzdGVycywgdGhlIFZFViBtb2RlbCBmaXR0ZWQgYmV0dGVyLg0KDQpOb3cgd2Ugd2lsbCBhY2Nlc3MgdG8gdGhlIHJlc3VsdHMgYW5kIHZpc3VhbGl6ZSB0aGUgbW9kZWwuIFRvIHZpc3VhbGl6ZSwgd2Ugd2lsbCB1c2UgYSBuZXcgcGFja2FnZSAoKmZhY3RvZXh0cmEqKSwgdG8gY3JlYXRlIG5pY2VyIHBsb3RzIGJhc2VkIG9uIGdncGxvdDIuDQoNCmBgYHtyfQ0KbGlicmFyeShmYWN0b2V4dHJhKQ0KIyBCSUMgdmFsdWVzIHVzZWQgZm9yIGNob29zaW5nIHRoZSBudW1iZXIgb2YgY2x1c3RlcnMNCmZ2aXpfbWNsdXN0KG1jLCAiQklDIiwgcGFsZXR0ZSA9ICJqY28iKQ0KYGBgDQoNCiMjIyMgV2F2ZSAyDQoNCldlIHN0YXJ0IGJ5IHN1YnNldHRpbmcgdGhlIGRhdGEgZm9yIHRoZSByZXNwZWN0aXZlIHdhdmVzLCBhbmQgc3RhbmRhcmRpemluZyB0aGUgaW5kaWNhdG9ycyB0byB6LXNjb3JlcywgbWVhbmluZyB0aGF0IHJlc3VsdGluZyBwcm9maWxlIG1lYW5zIHJlZmxlY3Qgc3RhbmRhcmQgZGV2aWF0aW9uIChTRCkgdW5pdHMgYWJvdmUgb3IgYmVsb3cgdGhlIHNhbXBsZSBtZWFuICh3aGljaCBpcyBzZXQgdG8gMCkuDQoNCmBgYHtyfQ0Kc21zX3cyIDwtIHNtc19sb25nX25tW3Ntc19sb25nX25tJFRpbWVwb2ludD09MiwgXSAlPiUNCiAgc2VsZWN0KC1UaW1lcG9pbnQsIC1pZCkgJT4lICMgc3Vic2V0IFcyDQogIHNlbGVjdCgyNTozMCkgJT4lICMgc3Vic2V0IHdlaWdodGVkIGZhY3RvciBzY29yZXMNCiAgbXV0YXRlX2FsbChsaXN0KHNjYWxlKSkgIyBzdGFuZGFyZGl6ZSBpbmRpY2F0b3JzDQpgYGANCg0KV2UgdGhlbiBjb21wdXRlIHRoZSBtb2RlbC1iYXNlZCBjbHVzdGVyaW5nLCBhbmQgYXNrIGZvciBhIHN1bW1hcnkuDQpgYGB7cn0NCmxpYnJhcnkobWNsdXN0KQ0KbWMgPC0gTWNsdXN0KHNtc193MikNCnN1bW1hcnkobWMpICAgICAgICAgICAgICAgICANCmBgYA0KDQpGb3IgdGhpcyB3YXZlLCBNY2x1c3Qgc2VsZWN0ZWQgYSBtb2RlbCB3aXRoIDcgKCEpIHByb2ZpbGVzOyB0aGUgb3B0aW1hbCBzZWxlY3RlZCBtb2RlbCBpcyBWRVYsIGkuZS4sIHRoZSBwcm9maWxlcyBhcmUgZWxsaXBzb2lkYWwgd2l0aCBlcXVhbCBzaGFwZSAoc2VlIFt0aGlzIGFydGljbGVdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzUwOTY3MzYvKSkuIA0KDQpOb3cgd2Ugd2lsbCBhY2Nlc3MgdG8gdGhlIHJlc3VsdHMgYW5kIHZpc3VhbGl6ZSB0aGUgbW9kZWwuIFRvIHZpc3VhbGl6ZSwgd2Ugd2lsbCB1c2UgYSBuZXcgcGFja2FnZSAoKmZhY3RvZXh0cmEqKSwgdG8gY3JlYXRlIG5pY2VyIHBsb3RzIGJhc2VkIG9uIGdncGxvdDIuDQoNCmBgYHtyfQ0KbGlicmFyeShmYWN0b2V4dHJhKQ0KIyBCSUMgdmFsdWVzIHVzZWQgZm9yIGNob29zaW5nIHRoZSBudW1iZXIgb2YgY2x1c3RlcnMNCmZ2aXpfbWNsdXN0KG1jLCAiQklDIiwgcGFsZXR0ZSA9ICJqY28iKQ0KYGBgDQoNCiMjIyMgV2F2ZSAzDQoNCldlIHN0YXJ0IGJ5IHN1YnNldHRpbmcgdGhlIGRhdGEgZm9yIHRoZSByZXNwZWN0aXZlIHdhdmVzLCBhbmQgc3RhbmRhcmRpemluZyB0aGUgaW5kaWNhdG9ycyB0byB6LXNjb3JlcywgbWVhbmluZyB0aGF0IHJlc3VsdGluZyBwcm9maWxlIG1lYW5zIHJlZmxlY3Qgc3RhbmRhcmQgZGV2aWF0aW9uIChTRCkgdW5pdHMgYWJvdmUgb3IgYmVsb3cgdGhlIHNhbXBsZSBtZWFuICh3aGljaCBpcyBzZXQgdG8gMCkuDQoNCmBgYHtyfQ0Kc21zX3czIDwtIHNtc19sb25nX25tW3Ntc19sb25nX25tJFRpbWVwb2ludD09MywgXSAlPiUNCiAgc2VsZWN0KC1UaW1lcG9pbnQsIC1pZCkgJT4lICMgc3Vic2V0IFcxDQogIHNlbGVjdCgyNTozMCkgJT4lICMgc3Vic2V0IHdlaWdodGVkIGZhY3RvciBzY29yZXMNCiAgbXV0YXRlX2FsbChsaXN0KHNjYWxlKSkgIyBzdGFuZGFyZGl6ZSBpbmRpY2F0b3JzDQpgYGANCg0KV2UgdGhlbiBjb21wdXRlIHRoZSBtb2RlbC1iYXNlZCBjbHVzdGVyaW5nLCBhbmQgYXNrIGZvciBhIHN1bW1hcnkuDQpgYGB7cn0NCmxpYnJhcnkobWNsdXN0KQ0KbWMgPC0gTWNsdXN0KHNtc193MykNCnN1bW1hcnkobWMpICAgICAgICAgICAgICAgICANCmBgYA0KDQpGb3IgdGhpcyB3YXZlLCBNY2x1c3Qgc2VsZWN0ZWQgYSBtb2RlbCB3aXRoIDkgKCEpIHByb2ZpbGVzOyB0aGUgb3B0aW1hbCBzZWxlY3RlZCBtb2RlbCBpcyBWRVYsIGkuZS4sIHRoZSBwcm9maWxlcyBhcmUgZWxsaXBzb2lkYWwgd2l0aCBlcXVhbCBzaGFwZSAoc2VlIFt0aGlzIGFydGljbGVdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzUwOTY3MzYvKSkuIA0KDQpgYGB7cn0NCmxpYnJhcnkoZmFjdG9leHRyYSkNCiMgQklDIHZhbHVlcyB1c2VkIGZvciBjaG9vc2luZyB0aGUgbnVtYmVyIG9mIGNsdXN0ZXJzDQpmdml6X21jbHVzdChtYywgIkJJQyIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0KDQojIyMgey50YWJzZXQgLnRhYnNldC1mYWRlfQ0KDQpXZSB3aWxsIGV4YW1pbmUgYSBzZXF1ZW5jZSBvZiBtb2RlbHMsIHdpdGggYW4gaW5jcmVhc2luZyBudW1iZXIgb2YgcHJvZmlsZXMgZnJvbSAyIHRvIC4uLiwgdG8gYXNjZXJ0YWluIHdoZXRoZXIgbW9yZSBjb21wbGV4IChpLmUuIG1vcmUgcHJvZmlsZXMpIG9yIHBhcnNpbW9uaW91cyAoaS5lLiBmZXdlciBwcm9maWxlcykgbW9kZWxzIHByb3ZpZGVkIHRoZSBiZXN0IGRlc2NyaXB0aW9uIG9mIHRoZSBkYXRhLiBXZSB3aWxsIHVzZSB0aGUgVkVWIG1vZGVsICh2YXJ5aW5nIHZvbHVtZSwgZXF1YWwgc2hhcGUsIHZhcnlpbmcgb3JpZW50YXRpb24pLg0KDQpXZSB3aWxsIHBsb3QgdGhlIHByb2ZpbGUgbWVhbnMsIHRoZSBjbHVzdGVyaW5nIGFuZCB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eS4gSWYgdGhlIGRhdGEgY29udGFpbiBtb3JlIHRoYW4gdHdvIHZhcmlhYmxlcyAod2hpY2ggaXMgdGhlIGNhc2UgaW4gb3VyIGRhdGEpLCB0aGUgKmZ2aXpfbWNsdXN0KCkqLWZ1bmN0aW9uIHdpbGwgdXNlIFBDQSB0byByZWR1Y2UgdGhlIGRpbWVuc2lvbmFsaXR5IG9mIHRoZSBkYXRhLiBUaGUgZmlyc3QgdHdvIHByaW5jaXBhbCBjb21wb25lbnRzIGFyZSB1c2VkIHRvIHByb2R1Y2UgYSBzY2F0dGVyIHBsb3Qgb2YgdGhlIGRhdGEuIElmIHdlIHdhbnQgdG8gcGxvdCB0aGUgZGF0YSB1c2luZyBvbmx5IHR3byB2YXJpYWJsZXMgKGUuZy4sICpleHRlcm5hbCByZWd1bGF0aW9uKiBhbmQgKmludHJpbnNpYyBtb3RpdmF0aW9uKiksIHdlIGNhbiBzcGVjaWZ5IHRoYXQgaW4gdGhlIGZ1bmN0aW9uIHVzaW5nIHRoZSBhcmd1bWVudCAqY2hvb3NlLnZhcnMgPSBjKCJleHRlcm5hbCIsICJpbnRyaW5zaWMiKSouIE5vdGUgdGhhdCwgaW4gdGhlIHVuY2VydGFpbnR5IHBsb3QsIGxhcmdlciBzeW1ib2xzIGluZGljYXRlIHRoZSBtb3JlIHVuY2VydGFpbiBvYnNlcnZhdGlvbnMuDQoNCjxicj4NCg0KIyMjIyBXYXZlIDENCg0KIyMjIyMgey50YWJzZXQgLnRhYnNldC1mYWRlfQ0KDQojIyMjIyMgMiBwcm9maWxlcw0KDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJ30NCmxpYnJhcnkobWNsdXN0KQ0KDQpCSUMgPC0gbWNsdXN0QklDKHNtc193MSkgDQptMiA8LSBNY2x1c3Qoc21zX3cxLCBtb2RlbE5hbWVzID0gIlZFViIsIEcgPSAyLCB4ID0gQklDKQ0KDQojIEV4dHJhY3QgbWVhbiB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzDQpsaWJyYXJ5KHJlc2hhcGUyKQ0KbWVhbnMgPC0gZGF0YS5mcmFtZShtMiRwYXJhbWV0ZXJzJG1lYW4sDQogICAgICAgICAgICAgICAgICAgIHN0cmluZ3NBc0ZhY3RvcnMgPSBGKSAlPiUNCiAgcm93bmFtZXNfdG9fY29sdW1uKCkgJT4lDQogIHJlbmFtZShNb3RpdmF0aW9uID0gcm93bmFtZSkgJT4lDQogIG1lbHQoaWQudmFycyA9ICJNb3RpdmF0aW9uIiwgdmFyaWFibGUubmFtZSA9ICJQcm9maWxlIiwgdmFsdWUubmFtZSA9ICJNZWFuIikgJT4lDQogIG11dGF0ZShNZWFuID0gcm91bmQoTWVhbiwgMikpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBzdGFuZGFyZGl6ZWQgbWVhbnMNCm1lYW5zICU+JQ0KICBnZ3Bsb3QoYWVzKE1vdGl2YXRpb24sIE1lYW4sIGdyb3VwID0gUHJvZmlsZSwgY29sb3IgPSBQcm9maWxlKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoKSArDQogIHNjYWxlX3hfZGlzY3JldGUobGltaXRzID0gYygiYW1vdGl2YXRpb24iLCAiZXh0ZXJuYWwiLCAiaW50cm9qZWN0ZWQiLCAiaWRlbnRpZmllZCIsICJpbnRlZ3JhdGVkIiwgImludHJpbnNpYyIpKSArDQogIGxhYnMoeCA9IE5VTEwsIHkgPSAiU3RhbmRhcmRpemVkIG1lYW4gd2VpZ2h0ZWQgZmFjdG9yLXNjb3JlcyIpICsNCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiIzU2QjRFOSIsICIjMDAwMDAwIiwgIiNFNjlGMDAiLCAiIzAwOUU3MyIsICIjRjBFNDQyIikpICsNCiAgdGhlbWVfYncoYmFzZV9zaXplID0gMTQpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgbGluZXR5cGU9ImRhc2hlZCIpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCmxpYnJhcnkoZmFjdG9leHRyYSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcNCmZ2aXpfbWNsdXN0KG0yLCAiY2xhc3NpZmljYXRpb24iLCBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgIHBvaW50c2l6ZSA9IDEuNSwgcGFsZXR0ZSA9ICJqY28iKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eQ0KZnZpel9tY2x1c3QobTIsICJ1bmNlcnRhaW50eSIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0KDQojIyMjIyMgMyBwcm9maWxlcw0KDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJ30NCmxpYnJhcnkobWNsdXN0KQ0KDQpCSUMgPC0gbWNsdXN0QklDKHNtc193MSkgDQptMyA8LSBNY2x1c3Qoc21zX3cxLCBtb2RlbE5hbWVzID0gIlZFViIsIEcgPSAzLCB4ID0gQklDKQ0KDQojIEV4dHJhY3QgbWVhbiB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzDQpsaWJyYXJ5KHJlc2hhcGUyKQ0KbWVhbnMgPC0gZGF0YS5mcmFtZShtMyRwYXJhbWV0ZXJzJG1lYW4sDQogICAgICAgICAgICAgICAgICAgIHN0cmluZ3NBc0ZhY3RvcnMgPSBGKSAlPiUNCiAgcm93bmFtZXNfdG9fY29sdW1uKCkgJT4lDQogIHJlbmFtZShNb3RpdmF0aW9uID0gcm93bmFtZSkgJT4lDQogIG1lbHQoaWQudmFycyA9ICJNb3RpdmF0aW9uIiwgdmFyaWFibGUubmFtZSA9ICJQcm9maWxlIiwgdmFsdWUubmFtZSA9ICJNZWFuIikgJT4lDQogIG11dGF0ZShNZWFuID0gcm91bmQoTWVhbiwgMikpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBzdGFuZGFyZGl6ZWQgbWVhbnMNCm1lYW5zICU+JQ0KICBnZ3Bsb3QoYWVzKE1vdGl2YXRpb24sIE1lYW4sIGdyb3VwID0gUHJvZmlsZSwgY29sb3IgPSBQcm9maWxlKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoKSArDQogIHNjYWxlX3hfZGlzY3JldGUobGltaXRzID0gYygiYW1vdGl2YXRpb24iLCAiZXh0ZXJuYWwiLCAiaW50cm9qZWN0ZWQiLCAiaWRlbnRpZmllZCIsICJpbnRlZ3JhdGVkIiwgImludHJpbnNpYyIpKSArDQogIGxhYnMoeCA9IE5VTEwsIHkgPSAiU3RhbmRhcmRpemVkIG1lYW4gd2VpZ2h0ZWQgZmFjdG9yLXNjb3JlcyIpICsNCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiIzU2QjRFOSIsICIjMDAwMDAwIiwgIiNFNjlGMDAiLCAiIzAwOUU3MyIsICIjRjBFNDQyIikpICsNCiAgdGhlbWVfYncoYmFzZV9zaXplID0gMTQpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgbGluZXR5cGU9ImRhc2hlZCIpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCmxpYnJhcnkoZmFjdG9leHRyYSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcNCmZ2aXpfbWNsdXN0KG0zLCAiY2xhc3NpZmljYXRpb24iLCBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgIHBvaW50c2l6ZSA9IDEuNSwgcGFsZXR0ZSA9ICJqY28iKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eQ0KZnZpel9tY2x1c3QobTMsICJ1bmNlcnRhaW50eSIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0KDQojIyMjIyMgNCBwcm9maWxlcw0KDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJ30NCmxpYnJhcnkobWNsdXN0KQ0KDQpCSUMgPC0gbWNsdXN0QklDKHNtc193MSkgDQptNCA8LSBNY2x1c3Qoc21zX3cxLCBtb2RlbE5hbWVzID0gIlZFViIsIEcgPSA0LCB4ID0gQklDKQ0KDQojIEV4dHJhY3QgbWVhbiB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzDQpsaWJyYXJ5KHJlc2hhcGUyKQ0KbWVhbnMgPC0gZGF0YS5mcmFtZShtNCRwYXJhbWV0ZXJzJG1lYW4sDQogICAgICAgICAgICAgICAgICAgIHN0cmluZ3NBc0ZhY3RvcnMgPSBGKSAlPiUNCiAgcm93bmFtZXNfdG9fY29sdW1uKCkgJT4lDQogIHJlbmFtZShNb3RpdmF0aW9uID0gcm93bmFtZSkgJT4lDQogIG1lbHQoaWQudmFycyA9ICJNb3RpdmF0aW9uIiwgdmFyaWFibGUubmFtZSA9ICJQcm9maWxlIiwgdmFsdWUubmFtZSA9ICJNZWFuIikgJT4lDQogIG11dGF0ZShNZWFuID0gcm91bmQoTWVhbiwgMikpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBzdGFuZGFyZGl6ZWQgbWVhbnMNCm1lYW5zICU+JQ0KICBnZ3Bsb3QoYWVzKE1vdGl2YXRpb24sIE1lYW4sIGdyb3VwID0gUHJvZmlsZSwgY29sb3IgPSBQcm9maWxlKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoKSArDQogIHNjYWxlX3hfZGlzY3JldGUobGltaXRzID0gYygiYW1vdGl2YXRpb24iLCAiZXh0ZXJuYWwiLCAiaW50cm9qZWN0ZWQiLCAiaWRlbnRpZmllZCIsICJpbnRlZ3JhdGVkIiwgImludHJpbnNpYyIpKSArDQogIGxhYnMoeCA9IE5VTEwsIHkgPSAiU3RhbmRhcmRpemVkIG1lYW4gd2VpZ2h0ZWQgZmFjdG9yLXNjb3JlcyIpICsNCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiIzU2QjRFOSIsICIjMDAwMDAwIiwgIiNFNjlGMDAiLCAiIzAwOUU3MyIsICIjRjBFNDQyIikpICsNCiAgdGhlbWVfYncoYmFzZV9zaXplID0gMTQpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgbGluZXR5cGU9ImRhc2hlZCIpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCmxpYnJhcnkoZmFjdG9leHRyYSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcNCmZ2aXpfbWNsdXN0KG00LCAiY2xhc3NpZmljYXRpb24iLCBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgIHBvaW50c2l6ZSA9IDEuNSwgcGFsZXR0ZSA9ICJqY28iKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eQ0KZnZpel9tY2x1c3QobTQsICJ1bmNlcnRhaW50eSIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0KDQojIyMjIyMgNSBwcm9maWxlcw0KYGBge3IgY2xhc3Muc291cmNlID0gJ2ZvbGQtaGlkZSd9DQpsaWJyYXJ5KG1jbHVzdCkNCg0KQklDIDwtIG1jbHVzdEJJQyhzbXNfdzEpIA0KbTUgPC0gTWNsdXN0KHNtc193MSwgbW9kZWxOYW1lcyA9ICJWRVYiLCBHID0gNSwgeCA9IEJJQykNCg0KIyBFeHRyYWN0IG1lYW4gd2VpZ2h0ZWQgZmFjdG9yIHNjb3Jlcw0KbGlicmFyeShyZXNoYXBlMikNCm1lYW5zIDwtIGRhdGEuZnJhbWUobTUkcGFyYW1ldGVycyRtZWFuLA0KICAgICAgICAgICAgICAgICAgICBzdHJpbmdzQXNGYWN0b3JzID0gRikgJT4lDQogIHJvd25hbWVzX3RvX2NvbHVtbigpICU+JQ0KICByZW5hbWUoTW90aXZhdGlvbiA9IHJvd25hbWUpICU+JQ0KICBtZWx0KGlkLnZhcnMgPSAiTW90aXZhdGlvbiIsIHZhcmlhYmxlLm5hbWUgPSAiUHJvZmlsZSIsIHZhbHVlLm5hbWUgPSAiTWVhbiIpICU+JQ0KICBtdXRhdGUoTWVhbiA9IHJvdW5kKE1lYW4sIDIpKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgc3RhbmRhcmRpemVkIG1lYW5zDQptZWFucyAlPiUNCiAgZ2dwbG90KGFlcyhNb3RpdmF0aW9uLCBNZWFuLCBncm91cCA9IFByb2ZpbGUsIGNvbG9yID0gUHJvZmlsZSkpICsNCiAgZ2VvbV9saW5lKCkgKw0KICBnZW9tX3BvaW50KCkgKw0KICBzY2FsZV94X2Rpc2NyZXRlKGxpbWl0cyA9IGMoImFtb3RpdmF0aW9uIiwgImV4dGVybmFsIiwgImludHJvamVjdGVkIiwgImlkZW50aWZpZWQiLCAiaW50ZWdyYXRlZCIsICJpbnRyaW5zaWMiKSkgKw0KICBsYWJzKHggPSBOVUxMLCB5ID0gIlN0YW5kYXJkaXplZCBtZWFuIHdlaWdodGVkIGZhY3Rvci1zY29yZXMiKSArDQogIHNjYWxlX2NvbG91cl9tYW51YWwodmFsdWVzPWMoIiM1NkI0RTkiLCAiIzAwMDAwMCIsICIjRTY5RjAwIiwgIiMwMDlFNzMiLCAiI0YwRTQ0MiIpKSArDQogIHRoZW1lX2J3KGJhc2Vfc2l6ZSA9IDE0KSArDQogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAsIGxpbmV0eXBlPSJkYXNoZWQiKSArDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIGhqdXN0ID0gMSksIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQ0KDQpsaWJyYXJ5KGZhY3RvZXh0cmEpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBjbHVzdGVyaW5nDQpmdml6X21jbHVzdChtNSwgImNsYXNzaWZpY2F0aW9uIiwgZ2VvbSA9ICJwb2ludCIsDQogICAgICAgICAgICBwb2ludHNpemUgPSAxLjUsIHBhbGV0dGUgPSAiamNvIikNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcgdW5jZXJ0YWludHkNCmZ2aXpfbWNsdXN0KG01LCAidW5jZXJ0YWludHkiLCBwYWxldHRlID0gImpjbyIpDQpgYGANCg0KIyMjIyBXYXZlIDINCg0KIyMjIyMgey50YWJzZXQgLnRhYnNldC1mYWRlfQ0KDQojIyMjIyMgMiBwcm9maWxlcw0KDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJ30NCmxpYnJhcnkobWNsdXN0KQ0KDQpCSUMgPC0gbWNsdXN0QklDKHNtc193MikgDQptMiA8LSBNY2x1c3Qoc21zX3cyLCBtb2RlbE5hbWVzID0gIlZFViIsIEcgPSAyLCB4ID0gQklDKQ0KDQojIEV4dHJhY3QgbWVhbiB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzDQpsaWJyYXJ5KHJlc2hhcGUyKQ0KbWVhbnMgPC0gZGF0YS5mcmFtZShtMiRwYXJhbWV0ZXJzJG1lYW4sDQogICAgICAgICAgICAgICAgICAgIHN0cmluZ3NBc0ZhY3RvcnMgPSBGKSAlPiUNCiAgcm93bmFtZXNfdG9fY29sdW1uKCkgJT4lDQogIHJlbmFtZShNb3RpdmF0aW9uID0gcm93bmFtZSkgJT4lDQogIG1lbHQoaWQudmFycyA9ICJNb3RpdmF0aW9uIiwgdmFyaWFibGUubmFtZSA9ICJQcm9maWxlIiwgdmFsdWUubmFtZSA9ICJNZWFuIikgJT4lDQogIG11dGF0ZShNZWFuID0gcm91bmQoTWVhbiwgMikpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBzdGFuZGFyZGl6ZWQgbWVhbnMNCm1lYW5zICU+JQ0KICBnZ3Bsb3QoYWVzKE1vdGl2YXRpb24sIE1lYW4sIGdyb3VwID0gUHJvZmlsZSwgY29sb3IgPSBQcm9maWxlKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoKSArDQogIHNjYWxlX3hfZGlzY3JldGUobGltaXRzID0gYygiYW1vdGl2YXRpb24iLCAiZXh0ZXJuYWwiLCAiaW50cm9qZWN0ZWQiLCAiaWRlbnRpZmllZCIsICJpbnRlZ3JhdGVkIiwgImludHJpbnNpYyIpKSArDQogIGxhYnMoeCA9IE5VTEwsIHkgPSAiU3RhbmRhcmRpemVkIG1lYW4gd2VpZ2h0ZWQgZmFjdG9yLXNjb3JlcyIpICsNCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiIzU2QjRFOSIsICIjMDAwMDAwIiwgIiNFNjlGMDAiLCAiIzAwOUU3MyIsICIjRjBFNDQyIikpICsNCiAgdGhlbWVfYncoYmFzZV9zaXplID0gMTQpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgbGluZXR5cGU9ImRhc2hlZCIpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCmxpYnJhcnkoZmFjdG9leHRyYSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcNCmZ2aXpfbWNsdXN0KG0yLCAiY2xhc3NpZmljYXRpb24iLCBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgIHBvaW50c2l6ZSA9IDEuNSwgcGFsZXR0ZSA9ICJqY28iKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eQ0KZnZpel9tY2x1c3QobTIsICJ1bmNlcnRhaW50eSIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0KDQojIyMjIyMgMyBwcm9maWxlcw0KDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJ30NCmxpYnJhcnkobWNsdXN0KQ0KDQpCSUMgPC0gbWNsdXN0QklDKHNtc193MikgDQptMyA8LSBNY2x1c3Qoc21zX3cyLCBtb2RlbE5hbWVzID0gIlZFViIsIEcgPSAzLCB4ID0gQklDKQ0KDQojIEV4dHJhY3QgbWVhbiB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzDQpsaWJyYXJ5KHJlc2hhcGUyKQ0KbWVhbnMgPC0gZGF0YS5mcmFtZShtMyRwYXJhbWV0ZXJzJG1lYW4sDQogICAgICAgICAgICAgICAgICAgIHN0cmluZ3NBc0ZhY3RvcnMgPSBGKSAlPiUNCiAgcm93bmFtZXNfdG9fY29sdW1uKCkgJT4lDQogIHJlbmFtZShNb3RpdmF0aW9uID0gcm93bmFtZSkgJT4lDQogIG1lbHQoaWQudmFycyA9ICJNb3RpdmF0aW9uIiwgdmFyaWFibGUubmFtZSA9ICJQcm9maWxlIiwgdmFsdWUubmFtZSA9ICJNZWFuIikgJT4lDQogIG11dGF0ZShNZWFuID0gcm91bmQoTWVhbiwgMikpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBzdGFuZGFyZGl6ZWQgbWVhbnMNCm1lYW5zICU+JQ0KICBnZ3Bsb3QoYWVzKE1vdGl2YXRpb24sIE1lYW4sIGdyb3VwID0gUHJvZmlsZSwgY29sb3IgPSBQcm9maWxlKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoKSArDQogIHNjYWxlX3hfZGlzY3JldGUobGltaXRzID0gYygiYW1vdGl2YXRpb24iLCAiZXh0ZXJuYWwiLCAiaW50cm9qZWN0ZWQiLCAiaWRlbnRpZmllZCIsICJpbnRlZ3JhdGVkIiwgImludHJpbnNpYyIpKSArDQogIGxhYnMoeCA9IE5VTEwsIHkgPSAiU3RhbmRhcmRpemVkIG1lYW4gd2VpZ2h0ZWQgZmFjdG9yLXNjb3JlcyIpICsNCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiIzU2QjRFOSIsICIjMDAwMDAwIiwgIiNFNjlGMDAiLCAiIzAwOUU3MyIsICIjRjBFNDQyIikpICsNCiAgdGhlbWVfYncoYmFzZV9zaXplID0gMTQpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgbGluZXR5cGU9ImRhc2hlZCIpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCmxpYnJhcnkoZmFjdG9leHRyYSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcNCmZ2aXpfbWNsdXN0KG0zLCAiY2xhc3NpZmljYXRpb24iLCBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgIHBvaW50c2l6ZSA9IDEuNSwgcGFsZXR0ZSA9ICJqY28iKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eQ0KZnZpel9tY2x1c3QobTMsICJ1bmNlcnRhaW50eSIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0KDQojIyMjIyMgNCBwcm9maWxlcw0KDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJ30NCmxpYnJhcnkobWNsdXN0KQ0KDQpCSUMgPC0gbWNsdXN0QklDKHNtc193MikgDQptNCA8LSBNY2x1c3Qoc21zX3cyLCBtb2RlbE5hbWVzID0gIlZFViIsIEcgPSA0LCB4ID0gQklDKQ0KDQojIEV4dHJhY3QgbWVhbiB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzDQpsaWJyYXJ5KHJlc2hhcGUyKQ0KbWVhbnMgPC0gZGF0YS5mcmFtZShtNCRwYXJhbWV0ZXJzJG1lYW4sDQogICAgICAgICAgICAgICAgICAgIHN0cmluZ3NBc0ZhY3RvcnMgPSBGKSAlPiUNCiAgcm93bmFtZXNfdG9fY29sdW1uKCkgJT4lDQogIHJlbmFtZShNb3RpdmF0aW9uID0gcm93bmFtZSkgJT4lDQogIG1lbHQoaWQudmFycyA9ICJNb3RpdmF0aW9uIiwgdmFyaWFibGUubmFtZSA9ICJQcm9maWxlIiwgdmFsdWUubmFtZSA9ICJNZWFuIikgJT4lDQogIG11dGF0ZShNZWFuID0gcm91bmQoTWVhbiwgMikpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBzdGFuZGFyZGl6ZWQgbWVhbnMNCm1lYW5zICU+JQ0KICBnZ3Bsb3QoYWVzKE1vdGl2YXRpb24sIE1lYW4sIGdyb3VwID0gUHJvZmlsZSwgY29sb3IgPSBQcm9maWxlKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoKSArDQogIHNjYWxlX3hfZGlzY3JldGUobGltaXRzID0gYygiYW1vdGl2YXRpb24iLCAiZXh0ZXJuYWwiLCAiaW50cm9qZWN0ZWQiLCAiaWRlbnRpZmllZCIsICJpbnRlZ3JhdGVkIiwgImludHJpbnNpYyIpKSArDQogIGxhYnMoeCA9IE5VTEwsIHkgPSAiU3RhbmRhcmRpemVkIG1lYW4gd2VpZ2h0ZWQgZmFjdG9yLXNjb3JlcyIpICsNCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiIzU2QjRFOSIsICIjMDAwMDAwIiwgIiNFNjlGMDAiLCAiIzAwOUU3MyIsICIjRjBFNDQyIikpICsNCiAgdGhlbWVfYncoYmFzZV9zaXplID0gMTQpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgbGluZXR5cGU9ImRhc2hlZCIpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCmxpYnJhcnkoZmFjdG9leHRyYSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcNCmZ2aXpfbWNsdXN0KG00LCAiY2xhc3NpZmljYXRpb24iLCBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgIHBvaW50c2l6ZSA9IDEuNSwgcGFsZXR0ZSA9ICJqY28iKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eQ0KZnZpel9tY2x1c3QobTQsICJ1bmNlcnRhaW50eSIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0KDQojIyMjIyMgNSBwcm9maWxlcw0KYGBge3IgY2xhc3Muc291cmNlID0gJ2ZvbGQtaGlkZSd9DQpsaWJyYXJ5KG1jbHVzdCkNCg0KQklDIDwtIG1jbHVzdEJJQyhzbXNfdzIpIA0KbTUgPC0gTWNsdXN0KHNtc193MiwgbW9kZWxOYW1lcyA9ICJWRVYiLCBHID0gNSwgeCA9IEJJQykNCg0KIyBFeHRyYWN0IG1lYW4gd2VpZ2h0ZWQgZmFjdG9yIHNjb3Jlcw0KbGlicmFyeShyZXNoYXBlMikNCm1lYW5zIDwtIGRhdGEuZnJhbWUobTUkcGFyYW1ldGVycyRtZWFuLA0KICAgICAgICAgICAgICAgICAgICBzdHJpbmdzQXNGYWN0b3JzID0gRikgJT4lDQogIHJvd25hbWVzX3RvX2NvbHVtbigpICU+JQ0KICByZW5hbWUoTW90aXZhdGlvbiA9IHJvd25hbWUpICU+JQ0KICBtZWx0KGlkLnZhcnMgPSAiTW90aXZhdGlvbiIsIHZhcmlhYmxlLm5hbWUgPSAiUHJvZmlsZSIsIHZhbHVlLm5hbWUgPSAiTWVhbiIpICU+JQ0KICBtdXRhdGUoTWVhbiA9IHJvdW5kKE1lYW4sIDIpKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgc3RhbmRhcmRpemVkIG1lYW5zDQptZWFucyAlPiUNCiAgZ2dwbG90KGFlcyhNb3RpdmF0aW9uLCBNZWFuLCBncm91cCA9IFByb2ZpbGUsIGNvbG9yID0gUHJvZmlsZSkpICsNCiAgZ2VvbV9saW5lKCkgKw0KICBnZW9tX3BvaW50KCkgKw0KICBzY2FsZV94X2Rpc2NyZXRlKGxpbWl0cyA9IGMoImFtb3RpdmF0aW9uIiwgImV4dGVybmFsIiwgImludHJvamVjdGVkIiwgImlkZW50aWZpZWQiLCAiaW50ZWdyYXRlZCIsICJpbnRyaW5zaWMiKSkgKw0KICBsYWJzKHggPSBOVUxMLCB5ID0gIlN0YW5kYXJkaXplZCBtZWFuIHdlaWdodGVkIGZhY3Rvci1zY29yZXMiKSArDQogIHNjYWxlX2NvbG91cl9tYW51YWwodmFsdWVzPWMoIiM1NkI0RTkiLCAiIzAwMDAwMCIsICIjRTY5RjAwIiwgIiMwMDlFNzMiLCAiI0YwRTQ0MiIpKSArDQogIHRoZW1lX2J3KGJhc2Vfc2l6ZSA9IDE0KSArDQogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAsIGxpbmV0eXBlPSJkYXNoZWQiKSArDQogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KGFuZ2xlID0gNDUsIGhqdXN0ID0gMSksIGxlZ2VuZC5wb3NpdGlvbiA9ICJ0b3AiKQ0KDQpsaWJyYXJ5KGZhY3RvZXh0cmEpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBjbHVzdGVyaW5nDQpmdml6X21jbHVzdChtNSwgImNsYXNzaWZpY2F0aW9uIiwgZ2VvbSA9ICJwb2ludCIsDQogICAgICAgICAgICBwb2ludHNpemUgPSAxLjUsIHBhbGV0dGUgPSAiamNvIikNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcgdW5jZXJ0YWludHkNCmZ2aXpfbWNsdXN0KG01LCAidW5jZXJ0YWludHkiLCBwYWxldHRlID0gImpjbyIpDQpgYGANCg0KDQoNCg0KDQojIyMjIFdhdmUgMw0KDQojIyMjIyB7LnRhYnNldCAudGFic2V0LWZhZGV9DQoNCiMjIyMjIyAyIHByb2ZpbGVzDQoNCmBgYHtyIGNsYXNzLnNvdXJjZSA9ICdmb2xkLWhpZGUnfQ0KbGlicmFyeShtY2x1c3QpDQoNCkJJQyA8LSBtY2x1c3RCSUMoc21zX3czKSANCm0yIDwtIE1jbHVzdChzbXNfdzMsIG1vZGVsTmFtZXMgPSAiVkVWIiwgRyA9IDIsIHggPSBCSUMpDQoNCiMgRXh0cmFjdCBtZWFuIHdlaWdodGVkIGZhY3RvciBzY29yZXMNCmxpYnJhcnkocmVzaGFwZTIpDQptZWFucyA8LSBkYXRhLmZyYW1lKG0yJHBhcmFtZXRlcnMkbWVhbiwNCiAgICAgICAgICAgICAgICAgICAgc3RyaW5nc0FzRmFjdG9ycyA9IEYpICU+JQ0KICByb3duYW1lc190b19jb2x1bW4oKSAlPiUNCiAgcmVuYW1lKE1vdGl2YXRpb24gPSByb3duYW1lKSAlPiUNCiAgbWVsdChpZC52YXJzID0gIk1vdGl2YXRpb24iLCB2YXJpYWJsZS5uYW1lID0gIlByb2ZpbGUiLCB2YWx1ZS5uYW1lID0gIk1lYW4iKSAlPiUNCiAgbXV0YXRlKE1lYW4gPSByb3VuZChNZWFuLCAyKSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIHN0YW5kYXJkaXplZCBtZWFucw0KbWVhbnMgJT4lDQogIGdncGxvdChhZXMoTW90aXZhdGlvbiwgTWVhbiwgZ3JvdXAgPSBQcm9maWxlLCBjb2xvciA9IFByb2ZpbGUpKSArDQogIGdlb21fbGluZSgpICsNCiAgZ2VvbV9wb2ludCgpICsNCiAgc2NhbGVfeF9kaXNjcmV0ZShsaW1pdHMgPSBjKCJhbW90aXZhdGlvbiIsICJleHRlcm5hbCIsICJpbnRyb2plY3RlZCIsICJpZGVudGlmaWVkIiwgImludGVncmF0ZWQiLCAiaW50cmluc2ljIikpICsNCiAgbGFicyh4ID0gTlVMTCwgeSA9ICJTdGFuZGFyZGl6ZWQgbWVhbiB3ZWlnaHRlZCBmYWN0b3Itc2NvcmVzIikgKw0KICBzY2FsZV9jb2xvdXJfbWFudWFsKHZhbHVlcz1jKCIjNTZCNEU5IiwgIiMwMDAwMDAiLCAiI0U2OUYwMCIsICIjMDA5RTczIiwgIiNGMEU0NDIiKSkgKw0KICB0aGVtZV9idyhiYXNlX3NpemUgPSAxNCkgKw0KICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLCBsaW5ldHlwZT0iZGFzaGVkIikgKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCBoanVzdCA9IDEpLCBsZWdlbmQucG9zaXRpb24gPSAidG9wIikNCg0KbGlicmFyeShmYWN0b2V4dHJhKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZw0KZnZpel9tY2x1c3QobTIsICJjbGFzc2lmaWNhdGlvbiIsIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgcG9pbnRzaXplID0gMS41LCBwYWxldHRlID0gImpjbyIpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBjbHVzdGVyaW5nIHVuY2VydGFpbnR5DQpmdml6X21jbHVzdChtMiwgInVuY2VydGFpbnR5IiwgcGFsZXR0ZSA9ICJqY28iKQ0KYGBgDQoNCiMjIyMjIyAzIHByb2ZpbGVzDQoNCmBgYHtyIGNsYXNzLnNvdXJjZSA9ICdmb2xkLWhpZGUnfQ0KbGlicmFyeShtY2x1c3QpDQoNCkJJQyA8LSBtY2x1c3RCSUMoc21zX3czKSANCm0zIDwtIE1jbHVzdChzbXNfdzMsIG1vZGVsTmFtZXMgPSAiVkVWIiwgRyA9IDMsIHggPSBCSUMpDQoNCiMgRXh0cmFjdCBtZWFuIHdlaWdodGVkIGZhY3RvciBzY29yZXMNCmxpYnJhcnkocmVzaGFwZTIpDQptZWFucyA8LSBkYXRhLmZyYW1lKG0zJHBhcmFtZXRlcnMkbWVhbiwNCiAgICAgICAgICAgICAgICAgICAgc3RyaW5nc0FzRmFjdG9ycyA9IEYpICU+JQ0KICByb3duYW1lc190b19jb2x1bW4oKSAlPiUNCiAgcmVuYW1lKE1vdGl2YXRpb24gPSByb3duYW1lKSAlPiUNCiAgbWVsdChpZC52YXJzID0gIk1vdGl2YXRpb24iLCB2YXJpYWJsZS5uYW1lID0gIlByb2ZpbGUiLCB2YWx1ZS5uYW1lID0gIk1lYW4iKSAlPiUNCiAgbXV0YXRlKE1lYW4gPSByb3VuZChNZWFuLCAyKSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIHN0YW5kYXJkaXplZCBtZWFucw0KbWVhbnMgJT4lDQogIGdncGxvdChhZXMoTW90aXZhdGlvbiwgTWVhbiwgZ3JvdXAgPSBQcm9maWxlLCBjb2xvciA9IFByb2ZpbGUpKSArDQogIGdlb21fbGluZSgpICsNCiAgZ2VvbV9wb2ludCgpICsNCiAgc2NhbGVfeF9kaXNjcmV0ZShsaW1pdHMgPSBjKCJhbW90aXZhdGlvbiIsICJleHRlcm5hbCIsICJpbnRyb2plY3RlZCIsICJpZGVudGlmaWVkIiwgImludGVncmF0ZWQiLCAiaW50cmluc2ljIikpICsNCiAgbGFicyh4ID0gTlVMTCwgeSA9ICJTdGFuZGFyZGl6ZWQgbWVhbiB3ZWlnaHRlZCBmYWN0b3Itc2NvcmVzIikgKw0KICBzY2FsZV9jb2xvdXJfbWFudWFsKHZhbHVlcz1jKCIjNTZCNEU5IiwgIiMwMDAwMDAiLCAiI0U2OUYwMCIsICIjMDA5RTczIiwgIiNGMEU0NDIiKSkgKw0KICB0aGVtZV9idyhiYXNlX3NpemUgPSAxNCkgKw0KICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLCBsaW5ldHlwZT0iZGFzaGVkIikgKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCBoanVzdCA9IDEpLCBsZWdlbmQucG9zaXRpb24gPSAidG9wIikNCg0KbGlicmFyeShmYWN0b2V4dHJhKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZw0KZnZpel9tY2x1c3QobTMsICJjbGFzc2lmaWNhdGlvbiIsIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgcG9pbnRzaXplID0gMS41LCBwYWxldHRlID0gImpjbyIpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBjbHVzdGVyaW5nIHVuY2VydGFpbnR5DQpmdml6X21jbHVzdChtMywgInVuY2VydGFpbnR5IiwgcGFsZXR0ZSA9ICJqY28iKQ0KYGBgDQoNCiMjIyMjIyA0IHByb2ZpbGVzDQoNCmBgYHtyIGNsYXNzLnNvdXJjZSA9ICdmb2xkLWhpZGUnfQ0KbGlicmFyeShtY2x1c3QpDQoNCkJJQyA8LSBtY2x1c3RCSUMoc21zX3czKSANCm00IDwtIE1jbHVzdChzbXNfdzMsIG1vZGVsTmFtZXMgPSAiVkVWIiwgRyA9IDQsIHggPSBCSUMpDQoNCiMgRXh0cmFjdCBtZWFuIHdlaWdodGVkIGZhY3RvciBzY29yZXMNCmxpYnJhcnkocmVzaGFwZTIpDQptZWFucyA8LSBkYXRhLmZyYW1lKG00JHBhcmFtZXRlcnMkbWVhbiwNCiAgICAgICAgICAgICAgICAgICAgc3RyaW5nc0FzRmFjdG9ycyA9IEYpICU+JQ0KICByb3duYW1lc190b19jb2x1bW4oKSAlPiUNCiAgcmVuYW1lKE1vdGl2YXRpb24gPSByb3duYW1lKSAlPiUNCiAgbWVsdChpZC52YXJzID0gIk1vdGl2YXRpb24iLCB2YXJpYWJsZS5uYW1lID0gIlByb2ZpbGUiLCB2YWx1ZS5uYW1lID0gIk1lYW4iKSAlPiUNCiAgbXV0YXRlKE1lYW4gPSByb3VuZChNZWFuLCAyKSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIHN0YW5kYXJkaXplZCBtZWFucw0KbWVhbnMgJT4lDQogIGdncGxvdChhZXMoTW90aXZhdGlvbiwgTWVhbiwgZ3JvdXAgPSBQcm9maWxlLCBjb2xvciA9IFByb2ZpbGUpKSArDQogIGdlb21fbGluZSgpICsNCiAgZ2VvbV9wb2ludCgpICsNCiAgc2NhbGVfeF9kaXNjcmV0ZShsaW1pdHMgPSBjKCJhbW90aXZhdGlvbiIsICJleHRlcm5hbCIsICJpbnRyb2plY3RlZCIsICJpZGVudGlmaWVkIiwgImludGVncmF0ZWQiLCAiaW50cmluc2ljIikpICsNCiAgbGFicyh4ID0gTlVMTCwgeSA9ICJTdGFuZGFyZGl6ZWQgbWVhbiB3ZWlnaHRlZCBmYWN0b3Itc2NvcmVzIikgKw0KICBzY2FsZV9jb2xvdXJfbWFudWFsKHZhbHVlcz1jKCIjNTZCNEU5IiwgIiMwMDAwMDAiLCAiI0U2OUYwMCIsICIjMDA5RTczIiwgIiNGMEU0NDIiKSkgKw0KICB0aGVtZV9idyhiYXNlX3NpemUgPSAxNCkgKw0KICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLCBsaW5ldHlwZT0iZGFzaGVkIikgKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDQ1LCBoanVzdCA9IDEpLCBsZWdlbmQucG9zaXRpb24gPSAidG9wIikNCg0KbGlicmFyeShmYWN0b2V4dHJhKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZw0KZnZpel9tY2x1c3QobTQsICJjbGFzc2lmaWNhdGlvbiIsIGdlb20gPSAicG9pbnQiLA0KICAgICAgICAgICAgcG9pbnRzaXplID0gMS41LCBwYWxldHRlID0gImpjbyIpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBjbHVzdGVyaW5nIHVuY2VydGFpbnR5DQpmdml6X21jbHVzdChtNCwgInVuY2VydGFpbnR5IiwgcGFsZXR0ZSA9ICJqY28iKQ0KYGBgDQoNCiMjIyMjIyA1IHByb2ZpbGVzDQpgYGB7ciBjbGFzcy5zb3VyY2UgPSAnZm9sZC1oaWRlJ30NCmxpYnJhcnkobWNsdXN0KQ0KDQpCSUMgPC0gbWNsdXN0QklDKHNtc193MykgDQptNSA8LSBNY2x1c3Qoc21zX3czLCBtb2RlbE5hbWVzID0gIlZFViIsIEcgPSA1LCB4ID0gQklDKQ0KDQojIEV4dHJhY3QgbWVhbiB3ZWlnaHRlZCBmYWN0b3Igc2NvcmVzDQpsaWJyYXJ5KHJlc2hhcGUyKQ0KbWVhbnMgPC0gZGF0YS5mcmFtZShtNSRwYXJhbWV0ZXJzJG1lYW4sDQogICAgICAgICAgICAgICAgICAgIHN0cmluZ3NBc0ZhY3RvcnMgPSBGKSAlPiUNCiAgcm93bmFtZXNfdG9fY29sdW1uKCkgJT4lDQogIHJlbmFtZShNb3RpdmF0aW9uID0gcm93bmFtZSkgJT4lDQogIG1lbHQoaWQudmFycyA9ICJNb3RpdmF0aW9uIiwgdmFyaWFibGUubmFtZSA9ICJQcm9maWxlIiwgdmFsdWUubmFtZSA9ICJNZWFuIikgJT4lDQogIG11dGF0ZShNZWFuID0gcm91bmQoTWVhbiwgMikpDQoNCiMgUGxvdCBzaG93aW5nIHRoZSBzdGFuZGFyZGl6ZWQgbWVhbnMNCm1lYW5zICU+JQ0KICBnZ3Bsb3QoYWVzKE1vdGl2YXRpb24sIE1lYW4sIGdyb3VwID0gUHJvZmlsZSwgY29sb3IgPSBQcm9maWxlKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcG9pbnQoKSArDQogIHNjYWxlX3hfZGlzY3JldGUobGltaXRzID0gYygiYW1vdGl2YXRpb24iLCAiZXh0ZXJuYWwiLCAiaW50cm9qZWN0ZWQiLCAiaWRlbnRpZmllZCIsICJpbnRlZ3JhdGVkIiwgImludHJpbnNpYyIpKSArDQogIGxhYnMoeCA9IE5VTEwsIHkgPSAiU3RhbmRhcmRpemVkIG1lYW4gd2VpZ2h0ZWQgZmFjdG9yLXNjb3JlcyIpICsNCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9YygiIzU2QjRFOSIsICIjMDAwMDAwIiwgIiNFNjlGMDAiLCAiIzAwOUU3MyIsICIjRjBFNDQyIikpICsNCiAgdGhlbWVfYncoYmFzZV9zaXplID0gMTQpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgbGluZXR5cGU9ImRhc2hlZCIpICsNCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA0NSwgaGp1c3QgPSAxKSwgbGVnZW5kLnBvc2l0aW9uID0gInRvcCIpDQoNCmxpYnJhcnkoZmFjdG9leHRyYSkNCg0KIyBQbG90IHNob3dpbmcgdGhlIGNsdXN0ZXJpbmcNCmZ2aXpfbWNsdXN0KG01LCAiY2xhc3NpZmljYXRpb24iLCBnZW9tID0gInBvaW50IiwNCiAgICAgICAgICAgIHBvaW50c2l6ZSA9IDEuNSwgcGFsZXR0ZSA9ICJqY28iKQ0KDQojIFBsb3Qgc2hvd2luZyB0aGUgY2x1c3RlcmluZyB1bmNlcnRhaW50eQ0KZnZpel9tY2x1c3QobTUsICJ1bmNlcnRhaW50eSIsIHBhbGV0dGUgPSAiamNvIikNCmBgYA0K</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("lpta.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
